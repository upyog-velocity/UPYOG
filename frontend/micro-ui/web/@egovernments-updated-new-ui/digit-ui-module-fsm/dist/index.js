function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("@egovernments/digit-ui-react-components"),n=require("react"),i=e(n),l=require("react-i18next"),r=require("react-router-dom"),a=require("react-hook-form"),o=require("react-query"),u=e(require("react-time-picker"));function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var d,v,m=function(e){return"PROPERTYTYPE_MASTERS_"+e},f=function(e){if(e){var t=new Date(e),n=t.getMonth()+1,i=t.getDate();return t.getFullYear()+"-"+(n=(n>9?"":"0")+n)+"-"+(i>9?"":"0")+i}return null},p=[],E=function(e){var n=e.currentStep,r=void 0===n?1:n,a=e.flow,o=void 0===a?"":a,u=l.useTranslation().t,c=window.Digit.Utils.browser.isMobile();return function(e){switch(e){case"STAKEHOLDER":p=[];break;case"APPLY":p=["FSM_TIMELINE_PROPERTY_DETAILS","FSM_GENDER_DETAILS","FSM_PAYMENT_DETAILS","FSM_TIMELINE_SUMMARY"];break;case"PT_APPLY":p=["ES_NEW_APPLICATION_PROPERTY_DETAILS","PT_OWNERSHIP_INFO_SUB_HEADER","CE_DOCUMENT_DETAILS","PT_COMMON_SUMMARY"];break;default:p=["TL_COMMON_TR_DETAILS","TL_LOCATION_AND_OWNER_DETAILS","TL_DOCUMENT_DETAIL","TL_COMMON_SUMMARY"]}}(o),i.createElement("div",{className:"timeline-container",style:c?{}:{maxWidth:"960px",marginRight:"auto"}},p.map(function(e,n,l){return i.createElement("div",{className:"timeline-checkpoint",key:n},i.createElement("div",{className:"timeline-content"},i.createElement("span",{className:"circle "+(n<=r-1&&"active")},n<r-1?i.createElement(t.TickMark,null):n+1),i.createElement("span",{className:"secondary-color"},u(e))),n<l.length-1&&i.createElement("span",{className:"line "+(n<r-1&&"active")}))}))},_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=(function(e,t){(function(){var n="Expected a function",i="__lodash_placeholder__",l=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],r="[object Arguments]",a="[object Array]",o="[object Boolean]",u="[object Date]",c="[object Error]",s="[object Function]",d="[object GeneratorFunction]",v="[object Map]",m="[object Number]",f="[object Object]",p="[object RegExp]",E="[object Set]",S="[object String]",g="[object Symbol]",y="[object WeakMap]",h="[object ArrayBuffer]",T="[object DataView]",I="[object Float32Array]",D="[object Float64Array]",C="[object Int8Array]",N="[object Int16Array]",A="[object Int32Array]",O="[object Uint8Array]",L="[object Uint16Array]",R="[object Uint32Array]",M=/\b__p \+= '';/g,b=/\b(__p \+=) '' \+/g,P=/(__e\(.*?\)|\b__t\)) \+\n'';/g,F=/&(?:amp|lt|gt|quot|#39);/g,k=/[&<>"']/g,w=RegExp(F.source),x=RegExp(k.source),H=/<%-([\s\S]+?)%>/g,V=/<%([\s\S]+?)%>/g,U=/<%=([\s\S]+?)%>/g,B=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Y=/^\w*$/,G=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,z=/[\\^$.*+?()[\]{}|]/g,W=RegExp(z.source),j=/^\s+/,K=/\s/,X=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,q=/\{\n\/\* \[wrapped with (.+)\] \*/,Z=/,? & /,Q=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,$=/[()=,{}\[\]\/\s]/,J=/\\(\\)?/g,ee=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,te=/\w*$/,ne=/^[-+]0x[0-9a-f]+$/i,ie=/^0b[01]+$/i,le=/^\[object .+?Constructor\]$/,re=/^0o[0-7]+$/i,ae=/^(?:0|[1-9]\d*)$/,oe=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ue=/($^)/,ce=/['\n\r\u2028\u2029\\]/g,se="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",de="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ve="["+de+"]",me="["+se+"]",fe="\\d+",pe="[a-z\\xdf-\\xf6\\xf8-\\xff]",Ee="[^\\ud800-\\udfff"+de+fe+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",_e="\\ud83c[\\udffb-\\udfff]",Se="[^\\ud800-\\udfff]",ge="(?:\\ud83c[\\udde6-\\uddff]){2}",ye="[\\ud800-\\udbff][\\udc00-\\udfff]",he="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Te="(?:"+pe+"|"+Ee+")",Ie="(?:"+he+"|"+Ee+")",De="(?:"+me+"|"+_e+")?",Ce="[\\ufe0e\\ufe0f]?"+De+"(?:\\u200d(?:"+[Se,ge,ye].join("|")+")[\\ufe0e\\ufe0f]?"+De+")*",Ne="(?:"+["[\\u2700-\\u27bf]",ge,ye].join("|")+")"+Ce,Ae="(?:"+[Se+me+"?",me,ge,ye,"[\\ud800-\\udfff]"].join("|")+")",Oe=RegExp("['’]","g"),Le=RegExp(me,"g"),Re=RegExp(_e+"(?="+_e+")|"+Ae+Ce,"g"),Me=RegExp([he+"?"+pe+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[ve,he,"$"].join("|")+")",Ie+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[ve,he+Te,"$"].join("|")+")",he+"?"+Te+"+(?:['’](?:d|ll|m|re|s|t|ve))?",he+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",fe,Ne].join("|"),"g"),be=RegExp("[\\u200d\\ud800-\\udfff"+se+"\\ufe0e\\ufe0f]"),Pe=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Fe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ke=-1,we={};we[I]=we[D]=we[C]=we[N]=we[A]=we[O]=we["[object Uint8ClampedArray]"]=we[L]=we[R]=!0,we[r]=we[a]=we[h]=we[o]=we[T]=we[u]=we[c]=we[s]=we[v]=we[m]=we[f]=we[p]=we[E]=we[S]=we[y]=!1;var xe={};xe[r]=xe[a]=xe[h]=xe[T]=xe[o]=xe[u]=xe[I]=xe[D]=xe[C]=xe[N]=xe[A]=xe[v]=xe[m]=xe[f]=xe[p]=xe[E]=xe[S]=xe[g]=xe[O]=xe["[object Uint8ClampedArray]"]=xe[L]=xe[R]=!0,xe[c]=xe[s]=xe[y]=!1;var He={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,Ue=parseInt,Be="object"==typeof _&&_&&_.Object===Object&&_,Ye="object"==typeof self&&self&&self.Object===Object&&self,Ge=Be||Ye||Function("return this")(),ze=t&&!t.nodeType&&t,We=ze&&e&&!e.nodeType&&e,je=We&&We.exports===ze,Ke=je&&Be.process,Xe=function(){try{return We&&We.require&&We.require("util").types||Ke&&Ke.binding&&Ke.binding("util")}catch(e){}}(),qe=Xe&&Xe.isArrayBuffer,Ze=Xe&&Xe.isDate,Qe=Xe&&Xe.isMap,$e=Xe&&Xe.isRegExp,Je=Xe&&Xe.isSet,et=Xe&&Xe.isTypedArray;function tt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function nt(e,t,n,i){for(var l=-1,r=null==e?0:e.length;++l<r;){var a=e[l];t(i,a,n(a),e)}return i}function it(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););return e}function lt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function rt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function at(e,t){for(var n=-1,i=null==e?0:e.length,l=0,r=[];++n<i;){var a=e[n];t(a,n,e)&&(r[l++]=a)}return r}function ot(e,t){return!(null==e||!e.length)&&_t(e,t,0)>-1}function ut(e,t,n){for(var i=-1,l=null==e?0:e.length;++i<l;)if(n(t,e[i]))return!0;return!1}function ct(e,t){for(var n=-1,i=null==e?0:e.length,l=Array(i);++n<i;)l[n]=t(e[n],n,e);return l}function st(e,t){for(var n=-1,i=t.length,l=e.length;++n<i;)e[l+n]=t[n];return e}function dt(e,t,n,i){var l=-1,r=null==e?0:e.length;for(i&&r&&(n=e[++l]);++l<r;)n=t(n,e[l],l,e);return n}function vt(e,t,n,i){var l=null==e?0:e.length;for(i&&l&&(n=e[--l]);l--;)n=t(n,e[l],l,e);return n}function mt(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var ft=ht("length");function pt(e,t,n){var i;return n(e,function(e,n,l){if(t(e,n,l))return i=n,!1}),i}function Et(e,t,n,i){for(var l=e.length,r=n+(i?1:-1);i?r--:++r<l;)if(t(e[r],r,e))return r;return-1}function _t(e,t,n){return t==t?function(e,t,n){for(var i=n-1,l=e.length;++i<l;)if(e[i]===t)return i;return-1}(e,t,n):Et(e,gt,n)}function St(e,t,n,i){for(var l=n-1,r=e.length;++l<r;)if(i(e[l],t))return l;return-1}function gt(e){return e!=e}function yt(e,t){var n=null==e?0:e.length;return n?Dt(e,t)/n:NaN}function ht(e){return function(t){return null==t?void 0:t[e]}}function Tt(e){return function(t){return null==e?void 0:e[t]}}function It(e,t,n,i,l){return l(e,function(e,l,r){n=i?(i=!1,e):t(n,e,l,r)}),n}function Dt(e,t){for(var n,i=-1,l=e.length;++i<l;){var r=t(e[i]);void 0!==r&&(n=void 0===n?r:n+r)}return n}function Ct(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}function Nt(e){return e?e.slice(0,zt(e)+1).replace(j,""):e}function At(e){return function(t){return e(t)}}function Ot(e,t){return ct(t,function(t){return e[t]})}function Lt(e,t){return e.has(t)}function Rt(e,t){for(var n=-1,i=e.length;++n<i&&_t(t,e[n],0)>-1;);return n}function Mt(e,t){for(var n=e.length;n--&&_t(t,e[n],0)>-1;);return n}function bt(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}var Pt=Tt({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Ft=Tt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function kt(e){return"\\"+He[e]}function wt(e){return be.test(e)}function xt(e){var t=-1,n=Array(e.size);return e.forEach(function(e,i){n[++t]=[i,e]}),n}function Ht(e,t){return function(n){return e(t(n))}}function Vt(e,t){for(var n=-1,l=e.length,r=0,a=[];++n<l;){var o=e[n];o!==t&&o!==i||(e[n]=i,a[r++]=n)}return a}function Ut(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function Bt(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function Yt(e){return wt(e)?function(e){for(var t=Re.lastIndex=0;Re.test(e);)++t;return t}(e):ft(e)}function Gt(e){return wt(e)?function(e){return e.match(Re)||[]}(e):function(e){return e.split("")}(e)}function zt(e){for(var t=e.length;t--&&K.test(e.charAt(t)););return t}var Wt=Tt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),jt=function e(t){var _,K=(t=null==t?Ge:jt.defaults(Ge.Object(),t,jt.pick(Ge,Fe))).Array,se=t.Date,de=t.Error,ve=t.Function,me=t.Math,fe=t.Object,pe=t.RegExp,Ee=t.String,_e=t.TypeError,Se=K.prototype,ge=fe.prototype,ye=t["__core-js_shared__"],he=ve.prototype.toString,Te=ge.hasOwnProperty,Ie=0,De=(_=/[^.]+$/.exec(ye&&ye.keys&&ye.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",Ce=ge.toString,Ne=he.call(fe),Ae=Ge._,Re=pe("^"+he.call(Te).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),be=je?t.Buffer:void 0,He=t.Symbol,Be=t.Uint8Array,Ye=be?be.allocUnsafe:void 0,ze=Ht(fe.getPrototypeOf,fe),We=fe.create,Ke=ge.propertyIsEnumerable,Xe=Se.splice,ft=He?He.isConcatSpreadable:void 0,Tt=He?He.iterator:void 0,Kt=He?He.toStringTag:void 0,Xt=function(){try{var e=$l(fe,"defineProperty");return e({},"",{}),e}catch(e){}}(),qt=t.clearTimeout!==Ge.clearTimeout&&t.clearTimeout,Zt=se&&se.now!==Ge.Date.now&&se.now,Qt=t.setTimeout!==Ge.setTimeout&&t.setTimeout,$t=me.ceil,Jt=me.floor,en=fe.getOwnPropertySymbols,tn=be?be.isBuffer:void 0,nn=t.isFinite,ln=Se.join,rn=Ht(fe.keys,fe),an=me.max,on=me.min,un=se.now,cn=t.parseInt,sn=me.random,dn=Se.reverse,vn=$l(t,"DataView"),mn=$l(t,"Map"),fn=$l(t,"Promise"),pn=$l(t,"Set"),En=$l(t,"WeakMap"),_n=$l(fe,"create"),Sn=En&&new En,gn={},yn=Ar(vn),hn=Ar(mn),Tn=Ar(fn),In=Ar(pn),Dn=Ar(En),Cn=He?He.prototype:void 0,Nn=Cn?Cn.valueOf:void 0,An=Cn?Cn.toString:void 0;function On(e){if(za(e)&&!Pa(e)&&!(e instanceof bn)){if(e instanceof Mn)return e;if(Te.call(e,"__wrapped__"))return Or(e)}return new Mn(e)}var Ln=function(){function e(){}return function(t){if(!Ga(t))return{};if(We)return We(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Rn(){}function Mn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function bn(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Pn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Fn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function kn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function wn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new kn;++t<n;)this.add(e[t])}function xn(e){var t=this.__data__=new Fn(e);this.size=t.size}function Hn(e,t){var n=Pa(e),i=!n&&ba(e),l=!n&&!i&&xa(e),r=!n&&!i&&!l&&$a(e),a=n||i||l||r,o=a?Ct(e.length,Ee):[],u=o.length;for(var c in e)!t&&!Te.call(e,c)||a&&("length"==c||l&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||rr(c,u))||o.push(c);return o}function Vn(e){var t=e.length;return t?e[ki(0,t-1)]:void 0}function Un(e,t){return Tr(El(e),qn(t,0,e.length))}function Bn(e){return Tr(El(e))}function Yn(e,t,n){(void 0!==n&&!La(e[t],n)||void 0===n&&!(t in e))&&Kn(e,t,n)}function Gn(e,t,n){var i=e[t];Te.call(e,t)&&La(i,n)&&(void 0!==n||t in e)||Kn(e,t,n)}function zn(e,t){for(var n=e.length;n--;)if(La(e[n][0],t))return n;return-1}function Wn(e,t,n,i){return ei(e,function(e,l,r){t(i,e,n(e),r)}),i}function jn(e,t){return e&&_l(t,ho(t),e)}function Kn(e,t,n){"__proto__"==t&&Xt?Xt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Xn(e,t){for(var n=-1,i=t.length,l=K(i),r=null==e;++n<i;)l[n]=r?void 0:Eo(e,t[n]);return l}function qn(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function Zn(e,t,n,i,l,a){var c,_=1&t,y=2&t,M=4&t;if(n&&(c=l?n(e,i,l,a):n(e)),void 0!==c)return c;if(!Ga(e))return e;var b=Pa(e);if(b){if(c=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Te.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!_)return El(e,c)}else{var P=tr(e),F=P==s||P==d;if(xa(e))return sl(e,_);if(P==f||P==r||F&&!l){if(c=y||F?{}:ir(e),!_)return y?function(e,t){return _l(e,er(e),t)}(e,function(e,t){return e&&_l(t,To(t),e)}(c,e)):function(e,t){return _l(e,Jl(e),t)}(e,jn(c,e))}else{if(!xe[P])return l?e:{};c=function(e,t,n){var i=e.constructor;switch(t){case h:return dl(e);case o:case u:return new i(+e);case T:return function(e,t){var n=t?dl(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case I:case D:case C:case N:case A:case O:case"[object Uint8ClampedArray]":case L:case R:return vl(e,n);case v:return new i;case m:case S:return new i(e);case p:return function(e){var t=new e.constructor(e.source,te.exec(e));return t.lastIndex=e.lastIndex,t}(e);case E:return new i;case g:return Nn?fe(Nn.call(e)):{}}}(e,P,_)}}a||(a=new xn);var k=a.get(e);if(k)return k;a.set(e,c),qa(e)?e.forEach(function(i){c.add(Zn(i,t,n,i,e,a))}):Wa(e)&&e.forEach(function(i,l){c.set(l,Zn(i,t,n,l,e,a))});var w=b?void 0:(M?y?Wl:zl:y?To:ho)(e);return it(w||e,function(i,l){w&&(i=e[l=i]),Gn(c,l,Zn(i,t,n,l,e,a))}),c}function Qn(e,t,n){var i=n.length;if(null==e)return!i;for(e=fe(e);i--;){var l=n[i],r=e[l];if(void 0===r&&!(l in e)||!(0,t[l])(r))return!1}return!0}function $n(e,t,i){if("function"!=typeof e)throw new _e(n);return Sr(function(){e.apply(void 0,i)},t)}function Jn(e,t,n,i){var l=-1,r=ot,a=!0,o=e.length,u=[],c=t.length;if(!o)return u;n&&(t=ct(t,At(n))),i?(r=ut,a=!1):t.length>=200&&(r=Lt,a=!1,t=new wn(t));e:for(;++l<o;){var s=e[l],d=null==n?s:n(s);if(s=i||0!==s?s:0,a&&d==d){for(var v=c;v--;)if(t[v]===d)continue e;u.push(s)}else r(t,d,i)||u.push(s)}return u}On.templateSettings={escape:H,evaluate:V,interpolate:U,variable:"",imports:{_:On}},(On.prototype=Rn.prototype).constructor=On,(Mn.prototype=Ln(Rn.prototype)).constructor=Mn,(bn.prototype=Ln(Rn.prototype)).constructor=bn,Pn.prototype.clear=function(){this.__data__=_n?_n(null):{},this.size=0},Pn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Pn.prototype.get=function(e){var t=this.__data__;if(_n){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Te.call(t,e)?t[e]:void 0},Pn.prototype.has=function(e){var t=this.__data__;return _n?void 0!==t[e]:Te.call(t,e)},Pn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_n&&void 0===t?"__lodash_hash_undefined__":t,this},Fn.prototype.clear=function(){this.__data__=[],this.size=0},Fn.prototype.delete=function(e){var t=this.__data__,n=zn(t,e);return!(n<0||(n==t.length-1?t.pop():Xe.call(t,n,1),--this.size,0))},Fn.prototype.get=function(e){var t=this.__data__,n=zn(t,e);return n<0?void 0:t[n][1]},Fn.prototype.has=function(e){return zn(this.__data__,e)>-1},Fn.prototype.set=function(e,t){var n=this.__data__,i=zn(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this},kn.prototype.clear=function(){this.size=0,this.__data__={hash:new Pn,map:new(mn||Fn),string:new Pn}},kn.prototype.delete=function(e){var t=Zl(this,e).delete(e);return this.size-=t?1:0,t},kn.prototype.get=function(e){return Zl(this,e).get(e)},kn.prototype.has=function(e){return Zl(this,e).has(e)},kn.prototype.set=function(e,t){var n=Zl(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this},wn.prototype.add=wn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},wn.prototype.has=function(e){return this.__data__.has(e)},xn.prototype.clear=function(){this.__data__=new Fn,this.size=0},xn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},xn.prototype.get=function(e){return this.__data__.get(e)},xn.prototype.has=function(e){return this.__data__.has(e)},xn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Fn){var i=n.__data__;if(!mn||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new kn(i)}return n.set(e,t),this.size=n.size,this};var ei=yl(ui),ti=yl(ci,!0);function ni(e,t){var n=!0;return ei(e,function(e,i,l){return n=!!t(e,i,l)}),n}function ii(e,t,n){for(var i=-1,l=e.length;++i<l;){var r=e[i],a=t(r);if(null!=a&&(void 0===o?a==a&&!Qa(a):n(a,o)))var o=a,u=r}return u}function li(e,t){var n=[];return ei(e,function(e,i,l){t(e,i,l)&&n.push(e)}),n}function ri(e,t,n,i,l){var r=-1,a=e.length;for(n||(n=lr),l||(l=[]);++r<a;){var o=e[r];t>0&&n(o)?t>1?ri(o,t-1,n,i,l):st(l,o):i||(l[l.length]=o)}return l}var ai=hl(),oi=hl(!0);function ui(e,t){return e&&ai(e,t,ho)}function ci(e,t){return e&&oi(e,t,ho)}function si(e,t){return at(t,function(t){return Ua(e[t])})}function di(e,t){for(var n=0,i=(t=al(t,e)).length;null!=e&&n<i;)e=e[Nr(t[n++])];return n&&n==i?e:void 0}function vi(e,t,n){var i=t(e);return Pa(e)?i:st(i,n(e))}function mi(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Kt&&Kt in fe(e)?function(e){var t=Te.call(e,Kt),n=e[Kt];try{e[Kt]=void 0;var i=!0}catch(e){}var l=Ce.call(e);return i&&(t?e[Kt]=n:delete e[Kt]),l}(e):function(e){return Ce.call(e)}(e)}function fi(e,t){return e>t}function pi(e,t){return null!=e&&Te.call(e,t)}function Ei(e,t){return null!=e&&t in fe(e)}function _i(e,t,n){for(var i=n?ut:ot,l=e[0].length,r=e.length,a=r,o=K(r),u=Infinity,c=[];a--;){var s=e[a];a&&t&&(s=ct(s,At(t))),u=on(s.length,u),o[a]=!n&&(t||l>=120&&s.length>=120)?new wn(a&&s):void 0}s=e[0];var d=-1,v=o[0];e:for(;++d<l&&c.length<u;){var m=s[d],f=t?t(m):m;if(m=n||0!==m?m:0,!(v?Lt(v,f):i(c,f,n))){for(a=r;--a;){var p=o[a];if(!(p?Lt(p,f):i(e[a],f,n)))continue e}v&&v.push(f),c.push(m)}}return c}function Si(e,t,n){var i=null==(e=fr(e,t=al(t,e)))?e:e[Nr(Vr(t))];return null==i?void 0:tt(i,e,n)}function gi(e){return za(e)&&mi(e)==r}function yi(e,t,n,i,l){return e===t||(null==e||null==t||!za(e)&&!za(t)?e!=e&&t!=t:function(e,t,n,i,l,s){var d=Pa(e),_=Pa(t),y=d?a:tr(e),I=_?a:tr(t),D=(y=y==r?f:y)==f,C=(I=I==r?f:I)==f,N=y==I;if(N&&xa(e)){if(!xa(t))return!1;d=!0,D=!1}if(N&&!D)return s||(s=new xn),d||$a(e)?Yl(e,t,n,i,l,s):function(e,t,n,i,l,r,a){switch(n){case T:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case h:return!(e.byteLength!=t.byteLength||!r(new Be(e),new Be(t)));case o:case u:case m:return La(+e,+t);case c:return e.name==t.name&&e.message==t.message;case p:case S:return e==t+"";case v:var s=xt;case E:if(s||(s=Ut),e.size!=t.size&&!(1&i))return!1;var d=a.get(e);if(d)return d==t;i|=2,a.set(e,t);var f=Yl(s(e),s(t),i,l,r,a);return a.delete(e),f;case g:if(Nn)return Nn.call(e)==Nn.call(t)}return!1}(e,t,y,n,i,l,s);if(!(1&n)){var A=D&&Te.call(e,"__wrapped__"),O=C&&Te.call(t,"__wrapped__");if(A||O){var L=A?e.value():e,R=O?t.value():t;return s||(s=new xn),l(L,R,n,i,s)}}return!!N&&(s||(s=new xn),function(e,t,n,i,l,r){var a=1&n,o=zl(e),u=o.length;if(u!=zl(t).length&&!a)return!1;for(var c=u;c--;){var s=o[c];if(!(a?s in t:Te.call(t,s)))return!1}var d=r.get(e),v=r.get(t);if(d&&v)return d==t&&v==e;var m=!0;r.set(e,t),r.set(t,e);for(var f=a;++c<u;){var p=e[s=o[c]],E=t[s];if(i)var _=a?i(E,p,s,t,e,r):i(p,E,s,e,t,r);if(!(void 0===_?p===E||l(p,E,n,i,r):_)){m=!1;break}f||(f="constructor"==s)}if(m&&!f){var S=e.constructor,g=t.constructor;S==g||!("constructor"in e)||!("constructor"in t)||"function"==typeof S&&S instanceof S&&"function"==typeof g&&g instanceof g||(m=!1)}return r.delete(e),r.delete(t),m}(e,t,n,i,l,s))}(e,t,n,i,yi,l))}function hi(e,t,n,i){var l=n.length,r=l,a=!i;if(null==e)return!r;for(e=fe(e);l--;){var o=n[l];if(a&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++l<r;){var u=(o=n[l])[0],c=e[u],s=o[1];if(a&&o[2]){if(void 0===c&&!(u in e))return!1}else{var d=new xn;if(i)var v=i(c,s,u,e,t,d);if(!(void 0===v?yi(s,c,3,i,d):v))return!1}}return!0}function Ti(e){return!(!Ga(e)||(t=e,De&&De in t))&&(Ua(e)?Re:le).test(Ar(e));var t}function Ii(e){return"function"==typeof e?e:null==e?Ko:"object"==typeof e?Pa(e)?Oi(e[0],e[1]):Ai(e):nu(e)}function Di(e){if(!sr(e))return rn(e);var t=[];for(var n in fe(e))Te.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Ci(e,t){return e<t}function Ni(e,t){var n=-1,i=ka(e)?K(e.length):[];return ei(e,function(e,l,r){i[++n]=t(e,l,r)}),i}function Ai(e){var t=Ql(e);return 1==t.length&&t[0][2]?vr(t[0][0],t[0][1]):function(n){return n===e||hi(n,e,t)}}function Oi(e,t){return or(e)&&dr(t)?vr(Nr(e),t):function(n){var i=Eo(n,e);return void 0===i&&i===t?_o(n,e):yi(t,i,3)}}function Li(e,t,n,i,l){e!==t&&ai(t,function(r,a){if(l||(l=new xn),Ga(r))!function(e,t,n,i,l,r,a){var o=Er(e,n),u=Er(t,n),c=a.get(u);if(c)Yn(e,n,c);else{var s=r?r(o,u,n+"",e,t,a):void 0,d=void 0===s;if(d){var v=Pa(u),m=!v&&xa(u),f=!v&&!m&&$a(u);s=u,v||m||f?Pa(o)?s=o:wa(o)?s=El(o):m?(d=!1,s=sl(u,!0)):f?(d=!1,s=vl(u,!0)):s=[]:Ka(u)||ba(u)?(s=o,ba(o)?s=ao(o):Ga(o)&&!Ua(o)||(s=ir(u))):d=!1}d&&(a.set(u,s),l(s,u,i,r,a),a.delete(u)),Yn(e,n,s)}}(e,t,a,n,Li,i,l);else{var o=i?i(Er(e,a),r,a+"",e,t,l):void 0;void 0===o&&(o=r),Yn(e,a,o)}},To)}function Ri(e,t){var n=e.length;if(n)return rr(t+=t<0?n:0,n)?e[t]:void 0}function Mi(e,t,n){t=t.length?ct(t,function(e){return Pa(e)?function(t){return di(t,1===e.length?e[0]:e)}:e}):[Ko];var i=-1;return t=ct(t,At(ql())),function(e,t){var i=e.length;for(e.sort(function(e,t){return function(e,t,n){for(var i=-1,l=e.criteria,r=t.criteria,a=l.length,o=n.length;++i<a;){var u=ml(l[i],r[i]);if(u)return i>=o?u:u*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)});i--;)e[i]=e[i].value;return e}(Ni(e,function(e,n,l){return{criteria:ct(t,function(t){return t(e)}),index:++i,value:e}}))}function bi(e,t,n){for(var i=-1,l=t.length,r={};++i<l;){var a=t[i],o=di(e,a);n(o,a)&&Ui(r,al(a,e),o)}return r}function Pi(e,t,n,i){var l=i?St:_t,r=-1,a=t.length,o=e;for(e===t&&(t=El(t)),n&&(o=ct(e,At(n)));++r<a;)for(var u=0,c=t[r],s=n?n(c):c;(u=l(o,s,u,i))>-1;)o!==e&&Xe.call(o,u,1),Xe.call(e,u,1);return e}function Fi(e,t){for(var n=e?t.length:0,i=n-1;n--;){var l=t[n];if(n==i||l!==r){var r=l;rr(l)?Xe.call(e,l,1):$i(e,l)}}return e}function ki(e,t){return e+Jt(sn()*(t-e+1))}function wi(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Jt(t/2))&&(e+=e)}while(t);return n}function xi(e,t){return gr(mr(e,t,Ko),e+"")}function Hi(e){return Vn(Ro(e))}function Vi(e,t){var n=Ro(e);return Tr(n,qn(t,0,n.length))}function Ui(e,t,n,i){if(!Ga(e))return e;for(var l=-1,r=(t=al(t,e)).length,a=r-1,o=e;null!=o&&++l<r;){var u=Nr(t[l]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(l!=a){var s=o[u];void 0===(c=i?i(s,u,o):void 0)&&(c=Ga(s)?s:rr(t[l+1])?[]:{})}Gn(o,u,c),o=o[u]}return e}var Bi=Sn?function(e,t){return Sn.set(e,t),e}:Ko,Yi=Xt?function(e,t){return Xt(e,"toString",{configurable:!0,enumerable:!1,value:zo(t),writable:!0})}:Ko;function Gi(e){return Tr(Ro(e))}function zi(e,t,n){var i=-1,l=e.length;t<0&&(t=-t>l?0:l+t),(n=n>l?l:n)<0&&(n+=l),l=t>n?0:n-t>>>0,t>>>=0;for(var r=K(l);++i<l;)r[i]=e[i+t];return r}function Wi(e,t){var n;return ei(e,function(e,i,l){return!(n=t(e,i,l))}),!!n}function ji(e,t,n){var i=0,l=null==e?i:e.length;if("number"==typeof t&&t==t&&l<=2147483647){for(;i<l;){var r=i+l>>>1,a=e[r];null!==a&&!Qa(a)&&(n?a<=t:a<t)?i=r+1:l=r}return l}return Ki(e,t,Ko,n)}function Ki(e,t,n,i){var l=0,r=null==e?0:e.length;if(0===r)return 0;for(var a=(t=n(t))!=t,o=null===t,u=Qa(t),c=void 0===t;l<r;){var s=Jt((l+r)/2),d=n(e[s]),v=void 0!==d,m=null===d,f=d==d,p=Qa(d);if(a)var E=i||f;else E=c?f&&(i||v):o?f&&v&&(i||!m):u?f&&v&&!m&&(i||!p):!m&&!p&&(i?d<=t:d<t);E?l=s+1:r=s}return on(r,4294967294)}function Xi(e,t){for(var n=-1,i=e.length,l=0,r=[];++n<i;){var a=e[n],o=t?t(a):a;if(!n||!La(o,u)){var u=o;r[l++]=0===a?0:a}}return r}function qi(e){return"number"==typeof e?e:Qa(e)?NaN:+e}function Zi(e){if("string"==typeof e)return e;if(Pa(e))return ct(e,Zi)+"";if(Qa(e))return An?An.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Qi(e,t,n){var i=-1,l=ot,r=e.length,a=!0,o=[],u=o;if(n)a=!1,l=ut;else if(r>=200){var c=t?null:wl(e);if(c)return Ut(c);a=!1,l=Lt,u=new wn}else u=t?[]:o;e:for(;++i<r;){var s=e[i],d=t?t(s):s;if(s=n||0!==s?s:0,a&&d==d){for(var v=u.length;v--;)if(u[v]===d)continue e;t&&u.push(d),o.push(s)}else l(u,d,n)||(u!==o&&u.push(d),o.push(s))}return o}function $i(e,t){return null==(e=fr(e,t=al(t,e)))||delete e[Nr(Vr(t))]}function Ji(e,t,n,i){return Ui(e,t,n(di(e,t)),i)}function el(e,t,n,i){for(var l=e.length,r=i?l:-1;(i?r--:++r<l)&&t(e[r],r,e););return n?zi(e,i?0:r,i?r+1:l):zi(e,i?r+1:0,i?l:r)}function tl(e,t){var n=e;return n instanceof bn&&(n=n.value()),dt(t,function(e,t){return t.func.apply(t.thisArg,st([e],t.args))},n)}function nl(e,t,n){var i=e.length;if(i<2)return i?Qi(e[0]):[];for(var l=-1,r=K(i);++l<i;)for(var a=e[l],o=-1;++o<i;)o!=l&&(r[l]=Jn(r[l]||a,e[o],t,n));return Qi(ri(r,1),t,n)}function il(e,t,n){for(var i=-1,l=e.length,r=t.length,a={};++i<l;)n(a,e[i],i<r?t[i]:void 0);return a}function ll(e){return wa(e)?e:[]}function rl(e){return"function"==typeof e?e:Ko}function al(e,t){return Pa(e)?e:or(e,t)?[e]:Cr(oo(e))}var ol=xi;function ul(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:zi(e,t,n)}var cl=qt||function(e){return Ge.clearTimeout(e)};function sl(e,t){if(t)return e.slice();var n=e.length,i=Ye?Ye(n):new e.constructor(n);return e.copy(i),i}function dl(e){var t=new e.constructor(e.byteLength);return new Be(t).set(new Be(e)),t}function vl(e,t){var n=t?dl(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ml(e,t){if(e!==t){var n=void 0!==e,i=null===e,l=e==e,r=Qa(e),a=void 0!==t,o=null===t,u=t==t,c=Qa(t);if(!o&&!c&&!r&&e>t||r&&a&&u&&!o&&!c||i&&a&&u||!n&&u||!l)return 1;if(!i&&!r&&!c&&e<t||c&&n&&l&&!i&&!r||o&&n&&l||!a&&l||!u)return-1}return 0}function fl(e,t,n,i){for(var l=-1,r=e.length,a=n.length,o=-1,u=t.length,c=an(r-a,0),s=K(u+c),d=!i;++o<u;)s[o]=t[o];for(;++l<a;)(d||l<r)&&(s[n[l]]=e[l]);for(;c--;)s[o++]=e[l++];return s}function pl(e,t,n,i){for(var l=-1,r=e.length,a=-1,o=n.length,u=-1,c=t.length,s=an(r-o,0),d=K(s+c),v=!i;++l<s;)d[l]=e[l];for(var m=l;++u<c;)d[m+u]=t[u];for(;++a<o;)(v||l<r)&&(d[m+n[a]]=e[l++]);return d}function El(e,t){var n=-1,i=e.length;for(t||(t=K(i));++n<i;)t[n]=e[n];return t}function _l(e,t,n,i){var l=!n;n||(n={});for(var r=-1,a=t.length;++r<a;){var o=t[r],u=i?i(n[o],e[o],o,n,e):void 0;void 0===u&&(u=e[o]),l?Kn(n,o,u):Gn(n,o,u)}return n}function Sl(e,t){return function(n,i){var l=Pa(n)?nt:Wn,r=t?t():{};return l(n,e,ql(i,2),r)}}function gl(e){return xi(function(t,n){var i=-1,l=n.length,r=l>1?n[l-1]:void 0,a=l>2?n[2]:void 0;for(r=e.length>3&&"function"==typeof r?(l--,r):void 0,a&&ar(n[0],n[1],a)&&(r=l<3?void 0:r,l=1),t=fe(t);++i<l;){var o=n[i];o&&e(t,o,i,r)}return t})}function yl(e,t){return function(n,i){if(null==n)return n;if(!ka(n))return e(n,i);for(var l=n.length,r=t?l:-1,a=fe(n);(t?r--:++r<l)&&!1!==i(a[r],r,a););return n}}function hl(e){return function(t,n,i){for(var l=-1,r=fe(t),a=i(t),o=a.length;o--;){var u=a[e?o:++l];if(!1===n(r[u],u,r))break}return t}}function Tl(e){return function(t){var n=wt(t=oo(t))?Gt(t):void 0,i=n?n[0]:t.charAt(0),l=n?ul(n,1).join(""):t.slice(1);return i[e]()+l}}function Il(e){return function(t){return dt(Bo(Po(t).replace(Oe,"")),e,"")}}function Dl(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Ln(e.prototype),i=e.apply(n,t);return Ga(i)?i:n}}function Cl(e){return function(t,n,i){var l=fe(t);if(!ka(t)){var r=ql(n,3);t=ho(t),n=function(e){return r(l[e],e,l)}}var a=e(t,n,i);return a>-1?l[r?t[a]:a]:void 0}}function Nl(e){return Gl(function(t){var i=t.length,l=i,r=Mn.prototype.thru;for(e&&t.reverse();l--;){var a=t[l];if("function"!=typeof a)throw new _e(n);if(r&&!o&&"wrapper"==Kl(a))var o=new Mn([],!0)}for(l=o?l:i;++l<i;){var u=Kl(a=t[l]),c="wrapper"==u?jl(a):void 0;o=c&&ur(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?o[Kl(c[0])].apply(o,c[3]):1==a.length&&ur(a)?o[u]():o.thru(a)}return function(){var e=arguments,n=e[0];if(o&&1==e.length&&Pa(n))return o.plant(n).value();for(var l=0,r=i?t[l].apply(this,e):n;++l<i;)r=t[l].call(this,r);return r}})}function Al(e,t,n,i,l,r,a,o,u,c){var s=128&t,d=1&t,v=2&t,m=24&t,f=512&t,p=v?void 0:Dl(e);return function E(){for(var _=arguments.length,S=K(_),g=_;g--;)S[g]=arguments[g];if(m)var y=Xl(E),h=bt(S,y);if(i&&(S=fl(S,i,l,m)),r&&(S=pl(S,r,a,m)),_-=h,m&&_<c){var T=Vt(S,y);return Fl(e,t,Al,E.placeholder,n,S,T,o,u,c-_)}var I=d?n:this,D=v?I[e]:e;return _=S.length,o?S=pr(S,o):f&&_>1&&S.reverse(),s&&u<_&&(S.length=u),this&&this!==Ge&&this instanceof E&&(D=p||Dl(D)),D.apply(I,S)}}function Ol(e,t){return function(n,i){return function(e,t,n,i){return ui(e,function(e,l,r){t(i,n(e),l,r)}),i}(n,e,t(i),{})}}function Ll(e,t){return function(n,i){var l;if(void 0===n&&void 0===i)return t;if(void 0!==n&&(l=n),void 0!==i){if(void 0===l)return i;"string"==typeof n||"string"==typeof i?(n=Zi(n),i=Zi(i)):(n=qi(n),i=qi(i)),l=e(n,i)}return l}}function Rl(e){return Gl(function(t){return t=ct(t,At(ql())),xi(function(n){var i=this;return e(t,function(e){return tt(e,i,n)})})})}function Ml(e,t){var n=(t=void 0===t?" ":Zi(t)).length;if(n<2)return n?wi(t,e):t;var i=wi(t,$t(e/Yt(t)));return wt(t)?ul(Gt(i),0,e).join(""):i.slice(0,e)}function bl(e){return function(t,n,i){return i&&"number"!=typeof i&&ar(t,n,i)&&(n=i=void 0),t=no(t),void 0===n?(n=t,t=0):n=no(n),function(e,t,n,i){for(var l=-1,r=an($t((t-e)/(n||1)),0),a=K(r);r--;)a[i?r:++l]=e,e+=n;return a}(t,n,i=void 0===i?t<n?1:-1:no(i),e)}}function Pl(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ro(t),n=ro(n)),e(t,n)}}function Fl(e,t,n,i,l,r,a,o,u,c){var s=8&t;t|=s?32:64,4&(t&=~(s?64:32))||(t&=-4);var d=[e,t,l,s?r:void 0,s?a:void 0,s?void 0:r,s?void 0:a,o,u,c],v=n.apply(void 0,d);return ur(e)&&_r(v,d),v.placeholder=i,yr(v,e,t)}function kl(e){var t=me[e];return function(e,n){if(e=ro(e),(n=null==n?0:on(io(n),292))&&nn(e)){var i=(oo(e)+"e").split("e");return+((i=(oo(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var wl=pn&&1/Ut(new pn([,-0]))[1]==1/0?function(e){return new pn(e)}:$o;function xl(e){return function(t){var n=tr(t);return n==v?xt(t):n==E?Bt(t):function(e,t){return ct(t,function(t){return[t,e[t]]})}(t,e(t))}}function Hl(e,t,l,r,a,o,u,c){var s=2&t;if(!s&&"function"!=typeof e)throw new _e(n);var d=r?r.length:0;if(d||(t&=-97,r=a=void 0),u=void 0===u?u:an(io(u),0),c=void 0===c?c:io(c),d-=a?a.length:0,64&t){var v=r,m=a;r=a=void 0}var f=s?void 0:jl(e),p=[e,t,l,r,a,v,m,o,u,c];if(f&&function(e,t){var n=e[1],l=t[1],r=n|l;if(!(r<131||128==l&&8==n||128==l&&256==n&&e[7].length<=t[8]||384==l&&t[7].length<=t[8]&&8==n))return e;1&l&&(e[2]=t[2],r|=1&n?0:4);var a=t[3];if(a){var o=e[3];e[3]=o?fl(o,a,t[4]):a,e[4]=o?Vt(e[3],i):t[4]}(a=t[5])&&(e[5]=(o=e[5])?pl(o,a,t[6]):a,e[6]=o?Vt(e[5],i):t[6]),(a=t[7])&&(e[7]=a),128&l&&(e[8]=null==e[8]?t[8]:on(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(p,f),e=p[0],t=p[1],l=p[2],r=p[3],a=p[4],!(c=p[9]=void 0===p[9]?s?0:e.length:an(p[9]-d,0))&&24&t&&(t&=-25),t&&1!=t)E=8==t||16==t?function(e,t,n){var i=Dl(e);return function l(){for(var r=arguments.length,a=K(r),o=r,u=Xl(l);o--;)a[o]=arguments[o];var c=r<3&&a[0]!==u&&a[r-1]!==u?[]:Vt(a,u);if((r-=c.length)<n)return Fl(e,t,Al,l.placeholder,void 0,a,c,void 0,void 0,n-r);var s=this&&this!==Ge&&this instanceof l?i:e;return tt(s,this,a)}}(e,t,c):32!=t&&33!=t||a.length?Al.apply(void 0,p):function(e,t,n,i){var l=1&t,r=Dl(e);return function t(){for(var a=-1,o=arguments.length,u=-1,c=i.length,s=K(c+o),d=this&&this!==Ge&&this instanceof t?r:e;++u<c;)s[u]=i[u];for(;o--;)s[u++]=arguments[++a];return tt(d,l?n:this,s)}}(e,t,l,r);else var E=function(e,t,n){var i=1&t,l=Dl(e);return function t(){var r=this&&this!==Ge&&this instanceof t?l:e;return r.apply(i?n:this,arguments)}}(e,t,l);return yr((f?Bi:_r)(E,p),e,t)}function Vl(e,t,n,i){return void 0===e||La(e,ge[n])&&!Te.call(i,n)?t:e}function Ul(e,t,n,i,l,r){return Ga(e)&&Ga(t)&&(r.set(t,e),Li(e,t,void 0,Ul,r),r.delete(t)),e}function Bl(e){return Ka(e)?void 0:e}function Yl(e,t,n,i,l,r){var a=1&n,o=e.length,u=t.length;if(o!=u&&!(a&&u>o))return!1;var c=r.get(e),s=r.get(t);if(c&&s)return c==t&&s==e;var d=-1,v=!0,m=2&n?new wn:void 0;for(r.set(e,t),r.set(t,e);++d<o;){var f=e[d],p=t[d];if(i)var E=a?i(p,f,d,t,e,r):i(f,p,d,e,t,r);if(void 0!==E){if(E)continue;v=!1;break}if(m){if(!mt(t,function(e,t){if(!Lt(m,t)&&(f===e||l(f,e,n,i,r)))return m.push(t)})){v=!1;break}}else if(f!==p&&!l(f,p,n,i,r)){v=!1;break}}return r.delete(e),r.delete(t),v}function Gl(e){return gr(mr(e,void 0,Fr),e+"")}function zl(e){return vi(e,ho,Jl)}function Wl(e){return vi(e,To,er)}var jl=Sn?function(e){return Sn.get(e)}:$o;function Kl(e){for(var t=e.name+"",n=gn[t],i=Te.call(gn,t)?n.length:0;i--;){var l=n[i],r=l.func;if(null==r||r==e)return l.name}return t}function Xl(e){return(Te.call(On,"placeholder")?On:e).placeholder}function ql(){var e=On.iteratee||Xo;return e=e===Xo?Ii:e,arguments.length?e(arguments[0],arguments[1]):e}function Zl(e,t){var n,i,l=e.__data__;return("string"==(i=typeof(n=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?l["string"==typeof t?"string":"hash"]:l.map}function Ql(e){for(var t=ho(e),n=t.length;n--;){var i=t[n],l=e[i];t[n]=[i,l,dr(l)]}return t}function $l(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ti(n)?n:void 0}var Jl=en?function(e){return null==e?[]:(e=fe(e),at(en(e),function(t){return Ke.call(e,t)}))}:ru,er=en?function(e){for(var t=[];e;)st(t,Jl(e)),e=ze(e);return t}:ru,tr=mi;function nr(e,t,n){for(var i=-1,l=(t=al(t,e)).length,r=!1;++i<l;){var a=Nr(t[i]);if(!(r=null!=e&&n(e,a)))break;e=e[a]}return r||++i!=l?r:!!(l=null==e?0:e.length)&&Ya(l)&&rr(a,l)&&(Pa(e)||ba(e))}function ir(e){return"function"!=typeof e.constructor||sr(e)?{}:Ln(ze(e))}function lr(e){return Pa(e)||ba(e)||!!(ft&&e&&e[ft])}function rr(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ae.test(e))&&e>-1&&e%1==0&&e<t}function ar(e,t,n){if(!Ga(n))return!1;var i=typeof t;return!!("number"==i?ka(n)&&rr(t,n.length):"string"==i&&t in n)&&La(n[t],e)}function or(e,t){if(Pa(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Qa(e))||Y.test(e)||!B.test(e)||null!=t&&e in fe(t)}function ur(e){var t=Kl(e),n=On[t];if("function"!=typeof n||!(t in bn.prototype))return!1;if(e===n)return!0;var i=jl(n);return!!i&&e===i[0]}(vn&&tr(new vn(new ArrayBuffer(1)))!=T||mn&&tr(new mn)!=v||fn&&"[object Promise]"!=tr(fn.resolve())||pn&&tr(new pn)!=E||En&&tr(new En)!=y)&&(tr=function(e){var t=mi(e),n=t==f?e.constructor:void 0,i=n?Ar(n):"";if(i)switch(i){case yn:return T;case hn:return v;case Tn:return"[object Promise]";case In:return E;case Dn:return y}return t});var cr=ye?Ua:au;function sr(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ge)}function dr(e){return e==e&&!Ga(e)}function vr(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in fe(n))}}function mr(e,t,n){return t=an(void 0===t?e.length-1:t,0),function(){for(var i=arguments,l=-1,r=an(i.length-t,0),a=K(r);++l<r;)a[l]=i[t+l];l=-1;for(var o=K(t+1);++l<t;)o[l]=i[l];return o[t]=n(a),tt(e,this,o)}}function fr(e,t){return t.length<2?e:di(e,zi(t,0,-1))}function pr(e,t){for(var n=e.length,i=on(t.length,n),l=El(e);i--;){var r=t[i];e[i]=rr(r,n)?l[r]:void 0}return e}function Er(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var _r=hr(Bi),Sr=Qt||function(e,t){return Ge.setTimeout(e,t)},gr=hr(Yi);function yr(e,t,n){var i=t+"";return gr(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(X,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return it(l,function(n){var i="_."+n[0];t&n[1]&&!ot(e,i)&&e.push(i)}),e.sort()}(function(e){var t=e.match(q);return t?t[1].split(Z):[]}(i),n)))}function hr(e){var t=0,n=0;return function(){var i=un(),l=16-(i-n);if(n=i,l>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}function Tr(e,t){var n=-1,i=e.length,l=i-1;for(t=void 0===t?i:t;++n<t;){var r=ki(n,l),a=e[r];e[r]=e[n],e[n]=a}return e.length=t,e}var Ir,Dr,Cr=(Ir=Ia(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(G,function(e,n,i,l){t.push(i?l.replace(J,"$1"):n||e)}),t},function(e){return 500===Dr.size&&Dr.clear(),e}),Dr=Ir.cache,Ir);function Nr(e){if("string"==typeof e||Qa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Ar(e){if(null!=e){try{return he.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Or(e){if(e instanceof bn)return e.clone();var t=new Mn(e.__wrapped__,e.__chain__);return t.__actions__=El(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var Lr=xi(function(e,t){return wa(e)?Jn(e,ri(t,1,wa,!0)):[]}),Rr=xi(function(e,t){var n=Vr(t);return wa(n)&&(n=void 0),wa(e)?Jn(e,ri(t,1,wa,!0),ql(n,2)):[]}),Mr=xi(function(e,t){var n=Vr(t);return wa(n)&&(n=void 0),wa(e)?Jn(e,ri(t,1,wa,!0),void 0,n):[]});function br(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var l=null==n?0:io(n);return l<0&&(l=an(i+l,0)),Et(e,ql(t,3),l)}function Pr(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var l=i-1;return void 0!==n&&(l=io(n),l=n<0?an(i+l,0):on(l,i-1)),Et(e,ql(t,3),l,!0)}function Fr(e){return null!=e&&e.length?ri(e,1):[]}function kr(e){return e&&e.length?e[0]:void 0}var wr=xi(function(e){var t=ct(e,ll);return t.length&&t[0]===e[0]?_i(t):[]}),xr=xi(function(e){var t=Vr(e),n=ct(e,ll);return t===Vr(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?_i(n,ql(t,2)):[]}),Hr=xi(function(e){var t=Vr(e),n=ct(e,ll);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?_i(n,void 0,t):[]});function Vr(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var Ur=xi(Br);function Br(e,t){return e&&e.length&&t&&t.length?Pi(e,t):e}var Yr=Gl(function(e,t){var n=null==e?0:e.length,i=Xn(e,t);return Fi(e,ct(t,function(e){return rr(e,n)?+e:e}).sort(ml)),i});function Gr(e){return null==e?e:dn.call(e)}var zr=xi(function(e){return Qi(ri(e,1,wa,!0))}),Wr=xi(function(e){var t=Vr(e);return wa(t)&&(t=void 0),Qi(ri(e,1,wa,!0),ql(t,2))}),jr=xi(function(e){var t=Vr(e);return t="function"==typeof t?t:void 0,Qi(ri(e,1,wa,!0),void 0,t)});function Kr(e){if(!e||!e.length)return[];var t=0;return e=at(e,function(e){if(wa(e))return t=an(e.length,t),!0}),Ct(t,function(t){return ct(e,ht(t))})}function Xr(e,t){if(!e||!e.length)return[];var n=Kr(e);return null==t?n:ct(n,function(e){return tt(t,void 0,e)})}var qr=xi(function(e,t){return wa(e)?Jn(e,t):[]}),Zr=xi(function(e){return nl(at(e,wa))}),Qr=xi(function(e){var t=Vr(e);return wa(t)&&(t=void 0),nl(at(e,wa),ql(t,2))}),$r=xi(function(e){var t=Vr(e);return t="function"==typeof t?t:void 0,nl(at(e,wa),void 0,t)}),Jr=xi(Kr),ea=xi(function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Xr(e,n)});function ta(e){var t=On(e);return t.__chain__=!0,t}function na(e,t){return t(e)}var ia=Gl(function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,l=function(t){return Xn(t,e)};return!(t>1||this.__actions__.length)&&i instanceof bn&&rr(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:na,args:[l],thisArg:void 0}),new Mn(i,this.__chain__).thru(function(e){return t&&!e.length&&e.push(void 0),e})):this.thru(l)}),la=Sl(function(e,t,n){Te.call(e,n)?++e[n]:Kn(e,n,1)}),ra=Cl(br),aa=Cl(Pr);function oa(e,t){return(Pa(e)?it:ei)(e,ql(t,3))}function ua(e,t){return(Pa(e)?lt:ti)(e,ql(t,3))}var ca=Sl(function(e,t,n){Te.call(e,n)?e[n].push(t):Kn(e,n,[t])}),sa=xi(function(e,t,n){var i=-1,l="function"==typeof t,r=ka(e)?K(e.length):[];return ei(e,function(e){r[++i]=l?tt(t,e,n):Si(e,t,n)}),r}),da=Sl(function(e,t,n){Kn(e,n,t)});function va(e,t){return(Pa(e)?ct:Ni)(e,ql(t,3))}var ma=Sl(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),fa=xi(function(e,t){if(null==e)return[];var n=t.length;return n>1&&ar(e,t[0],t[1])?t=[]:n>2&&ar(t[0],t[1],t[2])&&(t=[t[0]]),Mi(e,ri(t,1),[])}),pa=Zt||function(){return Ge.Date.now()};function Ea(e,t,n){return t=n?void 0:t,Hl(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function _a(e,t){var i;if("function"!=typeof t)throw new _e(n);return e=io(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=void 0),i}}var Sa=xi(function(e,t,n){var i=1;if(n.length){var l=Vt(n,Xl(Sa));i|=32}return Hl(e,i,t,n,l)}),ga=xi(function(e,t,n){var i=3;if(n.length){var l=Vt(n,Xl(ga));i|=32}return Hl(t,i,e,n,l)});function ya(e,t,i){var l,r,a,o,u,c,s=0,d=!1,v=!1,m=!0;if("function"!=typeof e)throw new _e(n);function f(t){var n=l,i=r;return l=r=void 0,s=t,o=e.apply(i,n)}function p(e){return s=e,u=Sr(_,t),d?f(e):o}function E(e){var n=e-c;return void 0===c||n>=t||n<0||v&&e-s>=a}function _(){var e=pa();if(E(e))return S(e);u=Sr(_,function(e){var n=t-(e-c);return v?on(n,a-(e-s)):n}(e))}function S(e){return u=void 0,m&&l?f(e):(l=r=void 0,o)}function g(){var e=pa(),n=E(e);if(l=arguments,r=this,c=e,n){if(void 0===u)return p(c);if(v)return cl(u),u=Sr(_,t),f(c)}return void 0===u&&(u=Sr(_,t)),o}return t=ro(t)||0,Ga(i)&&(d=!!i.leading,a=(v="maxWait"in i)?an(ro(i.maxWait)||0,t):a,m="trailing"in i?!!i.trailing:m),g.cancel=function(){void 0!==u&&cl(u),s=0,l=c=r=u=void 0},g.flush=function(){return void 0===u?o:S(pa())},g}var ha=xi(function(e,t){return $n(e,1,t)}),Ta=xi(function(e,t,n){return $n(e,ro(t)||0,n)});function Ia(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new _e(n);var i=function n(){var i=arguments,l=t?t.apply(this,i):i[0],r=n.cache;if(r.has(l))return r.get(l);var a=e.apply(this,i);return n.cache=r.set(l,a)||r,a};return i.cache=new(Ia.Cache||kn),i}function Da(e){if("function"!=typeof e)throw new _e(n);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ia.Cache=kn;var Ca=ol(function(e,t){var n=(t=1==t.length&&Pa(t[0])?ct(t[0],At(ql())):ct(ri(t,1),At(ql()))).length;return xi(function(i){for(var l=-1,r=on(i.length,n);++l<r;)i[l]=t[l].call(this,i[l]);return tt(e,this,i)})}),Na=xi(function(e,t){return Hl(e,32,void 0,t,Vt(t,Xl(Na)))}),Aa=xi(function(e,t){return Hl(e,64,void 0,t,Vt(t,Xl(Aa)))}),Oa=Gl(function(e,t){return Hl(e,256,void 0,void 0,void 0,t)});function La(e,t){return e===t||e!=e&&t!=t}var Ra=Pl(fi),Ma=Pl(function(e,t){return e>=t}),ba=gi(function(){return arguments}())?gi:function(e){return za(e)&&Te.call(e,"callee")&&!Ke.call(e,"callee")},Pa=K.isArray,Fa=qe?At(qe):function(e){return za(e)&&mi(e)==h};function ka(e){return null!=e&&Ya(e.length)&&!Ua(e)}function wa(e){return za(e)&&ka(e)}var xa=tn||au,Ha=Ze?At(Ze):function(e){return za(e)&&mi(e)==u};function Va(e){if(!za(e))return!1;var t=mi(e);return t==c||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Ka(e)}function Ua(e){if(!Ga(e))return!1;var t=mi(e);return t==s||t==d||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Ba(e){return"number"==typeof e&&e==io(e)}function Ya(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function Ga(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function za(e){return null!=e&&"object"==typeof e}var Wa=Qe?At(Qe):function(e){return za(e)&&tr(e)==v};function ja(e){return"number"==typeof e||za(e)&&mi(e)==m}function Ka(e){if(!za(e)||mi(e)!=f)return!1;var t=ze(e);if(null===t)return!0;var n=Te.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&he.call(n)==Ne}var Xa=$e?At($e):function(e){return za(e)&&mi(e)==p},qa=Je?At(Je):function(e){return za(e)&&tr(e)==E};function Za(e){return"string"==typeof e||!Pa(e)&&za(e)&&mi(e)==S}function Qa(e){return"symbol"==typeof e||za(e)&&mi(e)==g}var $a=et?At(et):function(e){return za(e)&&Ya(e.length)&&!!we[mi(e)]},Ja=Pl(Ci),eo=Pl(function(e,t){return e<=t});function to(e){if(!e)return[];if(ka(e))return Za(e)?Gt(e):El(e);if(Tt&&e[Tt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Tt]());var t=tr(e);return(t==v?xt:t==E?Ut:Ro)(e)}function no(e){return e?(e=ro(e))===1/0||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function io(e){var t=no(e),n=t%1;return t==t?n?t-n:t:0}function lo(e){return e?qn(io(e),0,4294967295):0}function ro(e){if("number"==typeof e)return e;if(Qa(e))return NaN;if(Ga(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ga(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Nt(e);var n=ie.test(e);return n||re.test(e)?Ue(e.slice(2),n?2:8):ne.test(e)?NaN:+e}function ao(e){return _l(e,To(e))}function oo(e){return null==e?"":Zi(e)}var uo=gl(function(e,t){if(sr(t)||ka(t))_l(t,ho(t),e);else for(var n in t)Te.call(t,n)&&Gn(e,n,t[n])}),co=gl(function(e,t){_l(t,To(t),e)}),so=gl(function(e,t,n,i){_l(t,To(t),e,i)}),vo=gl(function(e,t,n,i){_l(t,ho(t),e,i)}),mo=Gl(Xn),fo=xi(function(e,t){e=fe(e);var n=-1,i=t.length,l=i>2?t[2]:void 0;for(l&&ar(t[0],t[1],l)&&(i=1);++n<i;)for(var r=t[n],a=To(r),o=-1,u=a.length;++o<u;){var c=a[o],s=e[c];(void 0===s||La(s,ge[c])&&!Te.call(e,c))&&(e[c]=r[c])}return e}),po=xi(function(e){return e.push(void 0,Ul),tt(Do,void 0,e)});function Eo(e,t,n){var i=null==e?void 0:di(e,t);return void 0===i?n:i}function _o(e,t){return null!=e&&nr(e,t,Ei)}var So=Ol(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ce.call(t)),e[t]=n},zo(Ko)),go=Ol(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Ce.call(t)),Te.call(e,t)?e[t].push(n):e[t]=[n]},ql),yo=xi(Si);function ho(e){return ka(e)?Hn(e):Di(e)}function To(e){return ka(e)?Hn(e,!0):function(e){if(!Ga(e))return function(e){var t=[];if(null!=e)for(var n in fe(e))t.push(n);return t}(e);var t=sr(e),n=[];for(var i in e)("constructor"!=i||!t&&Te.call(e,i))&&n.push(i);return n}(e)}var Io=gl(function(e,t,n){Li(e,t,n)}),Do=gl(function(e,t,n,i){Li(e,t,n,i)}),Co=Gl(function(e,t){var n={};if(null==e)return n;var i=!1;t=ct(t,function(t){return t=al(t,e),i||(i=t.length>1),t}),_l(e,Wl(e),n),i&&(n=Zn(n,7,Bl));for(var l=t.length;l--;)$i(n,t[l]);return n}),No=Gl(function(e,t){return null==e?{}:function(e,t){return bi(e,t,function(t,n){return _o(e,n)})}(e,t)});function Ao(e,t){if(null==e)return{};var n=ct(Wl(e),function(e){return[e]});return t=ql(t),bi(e,n,function(e,n){return t(e,n[0])})}var Oo=xl(ho),Lo=xl(To);function Ro(e){return null==e?[]:Ot(e,ho(e))}var Mo=Il(function(e,t,n){return t=t.toLowerCase(),e+(n?bo(t):t)});function bo(e){return Uo(oo(e).toLowerCase())}function Po(e){return(e=oo(e))&&e.replace(oe,Pt).replace(Le,"")}var Fo=Il(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),ko=Il(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),wo=Tl("toLowerCase"),xo=Il(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),Ho=Il(function(e,t,n){return e+(n?" ":"")+Uo(t)}),Vo=Il(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),Uo=Tl("toUpperCase");function Bo(e,t,n){return e=oo(e),void 0===(t=n?void 0:t)?function(e){return Pe.test(e)}(e)?function(e){return e.match(Me)||[]}(e):function(e){return e.match(Q)||[]}(e):e.match(t)||[]}var Yo=xi(function(e,t){try{return tt(e,void 0,t)}catch(e){return Va(e)?e:new de(e)}}),Go=Gl(function(e,t){return it(t,function(t){t=Nr(t),Kn(e,t,Sa(e[t],e))}),e});function zo(e){return function(){return e}}var Wo=Nl(),jo=Nl(!0);function Ko(e){return e}function Xo(e){return Ii("function"==typeof e?e:Zn(e,1))}var qo=xi(function(e,t){return function(n){return Si(n,e,t)}}),Zo=xi(function(e,t){return function(n){return Si(e,n,t)}});function Qo(e,t,n){var i=ho(t),l=si(t,i);null!=n||Ga(t)&&(l.length||!i.length)||(n=t,t=e,e=this,l=si(t,ho(t)));var r=!(Ga(n)&&"chain"in n&&!n.chain),a=Ua(e);return it(l,function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(r||t){var n=e(this.__wrapped__),l=n.__actions__=El(this.__actions__);return l.push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,st([this.value()],arguments))})}),e}function $o(){}var Jo=Rl(ct),eu=Rl(rt),tu=Rl(mt);function nu(e){return or(e)?ht(Nr(e)):function(e){return function(t){return di(t,e)}}(e)}var iu=bl(),lu=bl(!0);function ru(){return[]}function au(){return!1}var ou,uu=Ll(function(e,t){return e+t},0),cu=kl("ceil"),su=Ll(function(e,t){return e/t},1),du=kl("floor"),vu=Ll(function(e,t){return e*t},1),mu=kl("round"),fu=Ll(function(e,t){return e-t},0);return On.after=function(e,t){if("function"!=typeof t)throw new _e(n);return e=io(e),function(){if(--e<1)return t.apply(this,arguments)}},On.ary=Ea,On.assign=uo,On.assignIn=co,On.assignInWith=so,On.assignWith=vo,On.at=mo,On.before=_a,On.bind=Sa,On.bindAll=Go,On.bindKey=ga,On.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Pa(e)?e:[e]},On.chain=ta,On.chunk=function(e,t,n){t=(n?ar(e,t,n):void 0===t)?1:an(io(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var l=0,r=0,a=K($t(i/t));l<i;)a[r++]=zi(e,l,l+=t);return a},On.compact=function(e){for(var t=-1,n=null==e?0:e.length,i=0,l=[];++t<n;){var r=e[t];r&&(l[i++]=r)}return l},On.concat=function(){var e=arguments.length;if(!e)return[];for(var t=K(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return st(Pa(n)?El(n):[n],ri(t,1))},On.cond=function(e){var t=null==e?0:e.length,i=ql();return e=t?ct(e,function(e){if("function"!=typeof e[1])throw new _e(n);return[i(e[0]),e[1]]}):[],xi(function(n){for(var i=-1;++i<t;){var l=e[i];if(tt(l[0],this,n))return tt(l[1],this,n)}})},On.conforms=function(e){return function(e){var t=ho(e);return function(n){return Qn(n,e,t)}}(Zn(e,1))},On.constant=zo,On.countBy=la,On.create=function(e,t){var n=Ln(e);return null==t?n:jn(n,t)},On.curry=function e(t,n,i){var l=Hl(t,8,void 0,void 0,void 0,void 0,void 0,n=i?void 0:n);return l.placeholder=e.placeholder,l},On.curryRight=function e(t,n,i){var l=Hl(t,16,void 0,void 0,void 0,void 0,void 0,n=i?void 0:n);return l.placeholder=e.placeholder,l},On.debounce=ya,On.defaults=fo,On.defaultsDeep=po,On.defer=ha,On.delay=Ta,On.difference=Lr,On.differenceBy=Rr,On.differenceWith=Mr,On.drop=function(e,t,n){var i=null==e?0:e.length;return i?zi(e,(t=n||void 0===t?1:io(t))<0?0:t,i):[]},On.dropRight=function(e,t,n){var i=null==e?0:e.length;return i?zi(e,0,(t=i-(t=n||void 0===t?1:io(t)))<0?0:t):[]},On.dropRightWhile=function(e,t){return e&&e.length?el(e,ql(t,3),!0,!0):[]},On.dropWhile=function(e,t){return e&&e.length?el(e,ql(t,3),!0):[]},On.fill=function(e,t,n,i){var l=null==e?0:e.length;return l?(n&&"number"!=typeof n&&ar(e,t,n)&&(n=0,i=l),function(e,t,n,i){var l=e.length;for((n=io(n))<0&&(n=-n>l?0:l+n),(i=void 0===i||i>l?l:io(i))<0&&(i+=l),i=n>i?0:lo(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},On.filter=function(e,t){return(Pa(e)?at:li)(e,ql(t,3))},On.flatMap=function(e,t){return ri(va(e,t),1)},On.flatMapDeep=function(e,t){return ri(va(e,t),1/0)},On.flatMapDepth=function(e,t,n){return n=void 0===n?1:io(n),ri(va(e,t),n)},On.flatten=Fr,On.flattenDeep=function(e){return null!=e&&e.length?ri(e,1/0):[]},On.flattenDepth=function(e,t){return null!=e&&e.length?ri(e,t=void 0===t?1:io(t)):[]},On.flip=function(e){return Hl(e,512)},On.flow=Wo,On.flowRight=jo,On.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,i={};++t<n;){var l=e[t];i[l[0]]=l[1]}return i},On.functions=function(e){return null==e?[]:si(e,ho(e))},On.functionsIn=function(e){return null==e?[]:si(e,To(e))},On.groupBy=ca,On.initial=function(e){return null!=e&&e.length?zi(e,0,-1):[]},On.intersection=wr,On.intersectionBy=xr,On.intersectionWith=Hr,On.invert=So,On.invertBy=go,On.invokeMap=sa,On.iteratee=Xo,On.keyBy=da,On.keys=ho,On.keysIn=To,On.map=va,On.mapKeys=function(e,t){var n={};return t=ql(t,3),ui(e,function(e,i,l){Kn(n,t(e,i,l),e)}),n},On.mapValues=function(e,t){var n={};return t=ql(t,3),ui(e,function(e,i,l){Kn(n,i,t(e,i,l))}),n},On.matches=function(e){return Ai(Zn(e,1))},On.matchesProperty=function(e,t){return Oi(e,Zn(t,1))},On.memoize=Ia,On.merge=Io,On.mergeWith=Do,On.method=qo,On.methodOf=Zo,On.mixin=Qo,On.negate=Da,On.nthArg=function(e){return e=io(e),xi(function(t){return Ri(t,e)})},On.omit=Co,On.omitBy=function(e,t){return Ao(e,Da(ql(t)))},On.once=function(e){return _a(2,e)},On.orderBy=function(e,t,n,i){return null==e?[]:(Pa(t)||(t=null==t?[]:[t]),Pa(n=i?void 0:n)||(n=null==n?[]:[n]),Mi(e,t,n))},On.over=Jo,On.overArgs=Ca,On.overEvery=eu,On.overSome=tu,On.partial=Na,On.partialRight=Aa,On.partition=ma,On.pick=No,On.pickBy=Ao,On.property=nu,On.propertyOf=function(e){return function(t){return null==e?void 0:di(e,t)}},On.pull=Ur,On.pullAll=Br,On.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Pi(e,t,ql(n,2)):e},On.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Pi(e,t,void 0,n):e},On.pullAt=Yr,On.range=iu,On.rangeRight=lu,On.rearg=Oa,On.reject=function(e,t){return(Pa(e)?at:li)(e,Da(ql(t,3)))},On.remove=function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,l=[],r=e.length;for(t=ql(t,3);++i<r;){var a=e[i];t(a,i,e)&&(n.push(a),l.push(i))}return Fi(e,l),n},On.rest=function(e,t){if("function"!=typeof e)throw new _e(n);return xi(e,t=void 0===t?t:io(t))},On.reverse=Gr,On.sampleSize=function(e,t,n){return t=(n?ar(e,t,n):void 0===t)?1:io(t),(Pa(e)?Un:Vi)(e,t)},On.set=function(e,t,n){return null==e?e:Ui(e,t,n)},On.setWith=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:Ui(e,t,n,i)},On.shuffle=function(e){return(Pa(e)?Bn:Gi)(e)},On.slice=function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&ar(e,t,n)?(t=0,n=i):(t=null==t?0:io(t),n=void 0===n?i:io(n)),zi(e,t,n)):[]},On.sortBy=fa,On.sortedUniq=function(e){return e&&e.length?Xi(e):[]},On.sortedUniqBy=function(e,t){return e&&e.length?Xi(e,ql(t,2)):[]},On.split=function(e,t,n){return n&&"number"!=typeof n&&ar(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=oo(e))&&("string"==typeof t||null!=t&&!Xa(t))&&!(t=Zi(t))&&wt(e)?ul(Gt(e),0,n):e.split(t,n):[]},On.spread=function(e,t){if("function"!=typeof e)throw new _e(n);return t=null==t?0:an(io(t),0),xi(function(n){var i=n[t],l=ul(n,0,t);return i&&st(l,i),tt(e,this,l)})},On.tail=function(e){var t=null==e?0:e.length;return t?zi(e,1,t):[]},On.take=function(e,t,n){return e&&e.length?zi(e,0,(t=n||void 0===t?1:io(t))<0?0:t):[]},On.takeRight=function(e,t,n){var i=null==e?0:e.length;return i?zi(e,(t=i-(t=n||void 0===t?1:io(t)))<0?0:t,i):[]},On.takeRightWhile=function(e,t){return e&&e.length?el(e,ql(t,3),!1,!0):[]},On.takeWhile=function(e,t){return e&&e.length?el(e,ql(t,3)):[]},On.tap=function(e,t){return t(e),e},On.throttle=function(e,t,i){var l=!0,r=!0;if("function"!=typeof e)throw new _e(n);return Ga(i)&&(l="leading"in i?!!i.leading:l,r="trailing"in i?!!i.trailing:r),ya(e,t,{leading:l,maxWait:t,trailing:r})},On.thru=na,On.toArray=to,On.toPairs=Oo,On.toPairsIn=Lo,On.toPath=function(e){return Pa(e)?ct(e,Nr):Qa(e)?[e]:El(Cr(oo(e)))},On.toPlainObject=ao,On.transform=function(e,t,n){var i=Pa(e),l=i||xa(e)||$a(e);if(t=ql(t,4),null==n){var r=e&&e.constructor;n=l?i?new r:[]:Ga(e)&&Ua(r)?Ln(ze(e)):{}}return(l?it:ui)(e,function(e,i,l){return t(n,e,i,l)}),n},On.unary=function(e){return Ea(e,1)},On.union=zr,On.unionBy=Wr,On.unionWith=jr,On.uniq=function(e){return e&&e.length?Qi(e):[]},On.uniqBy=function(e,t){return e&&e.length?Qi(e,ql(t,2)):[]},On.uniqWith=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Qi(e,void 0,t):[]},On.unset=function(e,t){return null==e||$i(e,t)},On.unzip=Kr,On.unzipWith=Xr,On.update=function(e,t,n){return null==e?e:Ji(e,t,rl(n))},On.updateWith=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:Ji(e,t,rl(n),i)},On.values=Ro,On.valuesIn=function(e){return null==e?[]:Ot(e,To(e))},On.without=qr,On.words=Bo,On.wrap=function(e,t){return Na(rl(t),e)},On.xor=Zr,On.xorBy=Qr,On.xorWith=$r,On.zip=Jr,On.zipObject=function(e,t){return il(e||[],t||[],Gn)},On.zipObjectDeep=function(e,t){return il(e||[],t||[],Ui)},On.zipWith=ea,On.entries=Oo,On.entriesIn=Lo,On.extend=co,On.extendWith=so,Qo(On,On),On.add=uu,On.attempt=Yo,On.camelCase=Mo,On.capitalize=bo,On.ceil=cu,On.clamp=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=ro(n))==n?n:0),void 0!==t&&(t=(t=ro(t))==t?t:0),qn(ro(e),t,n)},On.clone=function(e){return Zn(e,4)},On.cloneDeep=function(e){return Zn(e,5)},On.cloneDeepWith=function(e,t){return Zn(e,5,t="function"==typeof t?t:void 0)},On.cloneWith=function(e,t){return Zn(e,4,t="function"==typeof t?t:void 0)},On.conformsTo=function(e,t){return null==t||Qn(e,t,ho(t))},On.deburr=Po,On.defaultTo=function(e,t){return null==e||e!=e?t:e},On.divide=su,On.endsWith=function(e,t,n){e=oo(e),t=Zi(t);var i=e.length,l=n=void 0===n?i:qn(io(n),0,i);return(n-=t.length)>=0&&e.slice(n,l)==t},On.eq=La,On.escape=function(e){return(e=oo(e))&&x.test(e)?e.replace(k,Ft):e},On.escapeRegExp=function(e){return(e=oo(e))&&W.test(e)?e.replace(z,"\\$&"):e},On.every=function(e,t,n){var i=Pa(e)?rt:ni;return n&&ar(e,t,n)&&(t=void 0),i(e,ql(t,3))},On.find=ra,On.findIndex=br,On.findKey=function(e,t){return pt(e,ql(t,3),ui)},On.findLast=aa,On.findLastIndex=Pr,On.findLastKey=function(e,t){return pt(e,ql(t,3),ci)},On.floor=du,On.forEach=oa,On.forEachRight=ua,On.forIn=function(e,t){return null==e?e:ai(e,ql(t,3),To)},On.forInRight=function(e,t){return null==e?e:oi(e,ql(t,3),To)},On.forOwn=function(e,t){return e&&ui(e,ql(t,3))},On.forOwnRight=function(e,t){return e&&ci(e,ql(t,3))},On.get=Eo,On.gt=Ra,On.gte=Ma,On.has=function(e,t){return null!=e&&nr(e,t,pi)},On.hasIn=_o,On.head=kr,On.identity=Ko,On.includes=function(e,t,n,i){e=ka(e)?e:Ro(e),n=n&&!i?io(n):0;var l=e.length;return n<0&&(n=an(l+n,0)),Za(e)?n<=l&&e.indexOf(t,n)>-1:!!l&&_t(e,t,n)>-1},On.indexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var l=null==n?0:io(n);return l<0&&(l=an(i+l,0)),_t(e,t,l)},On.inRange=function(e,t,n){return t=no(t),void 0===n?(n=t,t=0):n=no(n),function(e,t,n){return e>=on(t,n)&&e<an(t,n)}(e=ro(e),t,n)},On.invoke=yo,On.isArguments=ba,On.isArray=Pa,On.isArrayBuffer=Fa,On.isArrayLike=ka,On.isArrayLikeObject=wa,On.isBoolean=function(e){return!0===e||!1===e||za(e)&&mi(e)==o},On.isBuffer=xa,On.isDate=Ha,On.isElement=function(e){return za(e)&&1===e.nodeType&&!Ka(e)},On.isEmpty=function(e){if(null==e)return!0;if(ka(e)&&(Pa(e)||"string"==typeof e||"function"==typeof e.splice||xa(e)||$a(e)||ba(e)))return!e.length;var t=tr(e);if(t==v||t==E)return!e.size;if(sr(e))return!Di(e).length;for(var n in e)if(Te.call(e,n))return!1;return!0},On.isEqual=function(e,t){return yi(e,t)},On.isEqualWith=function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?yi(e,t,void 0,n):!!i},On.isError=Va,On.isFinite=function(e){return"number"==typeof e&&nn(e)},On.isFunction=Ua,On.isInteger=Ba,On.isLength=Ya,On.isMap=Wa,On.isMatch=function(e,t){return e===t||hi(e,t,Ql(t))},On.isMatchWith=function(e,t,n){return n="function"==typeof n?n:void 0,hi(e,t,Ql(t),n)},On.isNaN=function(e){return ja(e)&&e!=+e},On.isNative=function(e){if(cr(e))throw new de("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ti(e)},On.isNil=function(e){return null==e},On.isNull=function(e){return null===e},On.isNumber=ja,On.isObject=Ga,On.isObjectLike=za,On.isPlainObject=Ka,On.isRegExp=Xa,On.isSafeInteger=function(e){return Ba(e)&&e>=-9007199254740991&&e<=9007199254740991},On.isSet=qa,On.isString=Za,On.isSymbol=Qa,On.isTypedArray=$a,On.isUndefined=function(e){return void 0===e},On.isWeakMap=function(e){return za(e)&&tr(e)==y},On.isWeakSet=function(e){return za(e)&&"[object WeakSet]"==mi(e)},On.join=function(e,t){return null==e?"":ln.call(e,t)},On.kebabCase=Fo,On.last=Vr,On.lastIndexOf=function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var l=i;return void 0!==n&&(l=(l=io(n))<0?an(i+l,0):on(l,i-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,l):Et(e,gt,l,!0)},On.lowerCase=ko,On.lowerFirst=wo,On.lt=Ja,On.lte=eo,On.max=function(e){return e&&e.length?ii(e,Ko,fi):void 0},On.maxBy=function(e,t){return e&&e.length?ii(e,ql(t,2),fi):void 0},On.mean=function(e){return yt(e,Ko)},On.meanBy=function(e,t){return yt(e,ql(t,2))},On.min=function(e){return e&&e.length?ii(e,Ko,Ci):void 0},On.minBy=function(e,t){return e&&e.length?ii(e,ql(t,2),Ci):void 0},On.stubArray=ru,On.stubFalse=au,On.stubObject=function(){return{}},On.stubString=function(){return""},On.stubTrue=function(){return!0},On.multiply=vu,On.nth=function(e,t){return e&&e.length?Ri(e,io(t)):void 0},On.noConflict=function(){return Ge._===this&&(Ge._=Ae),this},On.noop=$o,On.now=pa,On.pad=function(e,t,n){e=oo(e);var i=(t=io(t))?Yt(e):0;if(!t||i>=t)return e;var l=(t-i)/2;return Ml(Jt(l),n)+e+Ml($t(l),n)},On.padEnd=function(e,t,n){e=oo(e);var i=(t=io(t))?Yt(e):0;return t&&i<t?e+Ml(t-i,n):e},On.padStart=function(e,t,n){e=oo(e);var i=(t=io(t))?Yt(e):0;return t&&i<t?Ml(t-i,n)+e:e},On.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),cn(oo(e).replace(j,""),t||0)},On.random=function(e,t,n){if(n&&"boolean"!=typeof n&&ar(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=no(e),void 0===t?(t=e,e=0):t=no(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var l=sn();return on(e+l*(t-e+Ve("1e-"+((l+"").length-1))),t)}return ki(e,t)},On.reduce=function(e,t,n){var i=Pa(e)?dt:It,l=arguments.length<3;return i(e,ql(t,4),n,l,ei)},On.reduceRight=function(e,t,n){var i=Pa(e)?vt:It,l=arguments.length<3;return i(e,ql(t,4),n,l,ti)},On.repeat=function(e,t,n){return t=(n?ar(e,t,n):void 0===t)?1:io(t),wi(oo(e),t)},On.replace=function(){var e=arguments,t=oo(e[0]);return e.length<3?t:t.replace(e[1],e[2])},On.result=function(e,t,n){var i=-1,l=(t=al(t,e)).length;for(l||(l=1,e=void 0);++i<l;){var r=null==e?void 0:e[Nr(t[i])];void 0===r&&(i=l,r=n),e=Ua(r)?r.call(e):r}return e},On.round=mu,On.runInContext=e,On.sample=function(e){return(Pa(e)?Vn:Hi)(e)},On.size=function(e){if(null==e)return 0;if(ka(e))return Za(e)?Yt(e):e.length;var t=tr(e);return t==v||t==E?e.size:Di(e).length},On.snakeCase=xo,On.some=function(e,t,n){var i=Pa(e)?mt:Wi;return n&&ar(e,t,n)&&(t=void 0),i(e,ql(t,3))},On.sortedIndex=function(e,t){return ji(e,t)},On.sortedIndexBy=function(e,t,n){return Ki(e,t,ql(n,2))},On.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var i=ji(e,t);if(i<n&&La(e[i],t))return i}return-1},On.sortedLastIndex=function(e,t){return ji(e,t,!0)},On.sortedLastIndexBy=function(e,t,n){return Ki(e,t,ql(n,2),!0)},On.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ji(e,t,!0)-1;if(La(e[n],t))return n}return-1},On.startCase=Ho,On.startsWith=function(e,t,n){return e=oo(e),n=null==n?0:qn(io(n),0,e.length),t=Zi(t),e.slice(n,n+t.length)==t},On.subtract=fu,On.sum=function(e){return e&&e.length?Dt(e,Ko):0},On.sumBy=function(e,t){return e&&e.length?Dt(e,ql(t,2)):0},On.template=function(e,t,n){var i=On.templateSettings;n&&ar(e,t,n)&&(t=void 0),e=oo(e),t=so({},t,i,Vl);var l,r,a=so({},t.imports,i.imports,Vl),o=ho(a),u=Ot(a,o),c=0,s=t.interpolate||ue,d="__p += '",v=pe((t.escape||ue).source+"|"+s.source+"|"+(s===U?ee:ue).source+"|"+(t.evaluate||ue).source+"|$","g"),m="//# sourceURL="+(Te.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ke+"]")+"\n";e.replace(v,function(t,n,i,a,o,u){return i||(i=a),d+=e.slice(c,u).replace(ce,kt),n&&(l=!0,d+="' +\n__e("+n+") +\n'"),o&&(r=!0,d+="';\n"+o+";\n__p += '"),i&&(d+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=u+t.length,t}),d+="';\n";var f=Te.call(t,"variable")&&t.variable;if(f){if($.test(f))throw new de("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(r?d.replace(M,""):d).replace(b,"$1").replace(P,"$1;"),d="function("+(f||"obj")+") {\n"+(f?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(l?", __e = _.escape":"")+(r?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var p=Yo(function(){return ve(o,m+"return "+d).apply(void 0,u)});if(p.source=d,Va(p))throw p;return p},On.times=function(e,t){if((e=io(e))<1||e>9007199254740991)return[];var n=4294967295,i=on(e,4294967295);e-=4294967295;for(var l=Ct(i,t=ql(t));++n<e;)t(n);return l},On.toFinite=no,On.toInteger=io,On.toLength=lo,On.toLower=function(e){return oo(e).toLowerCase()},On.toNumber=ro,On.toSafeInteger=function(e){return e?qn(io(e),-9007199254740991,9007199254740991):0===e?e:0},On.toString=oo,On.toUpper=function(e){return oo(e).toUpperCase()},On.trim=function(e,t,n){if((e=oo(e))&&(n||void 0===t))return Nt(e);if(!e||!(t=Zi(t)))return e;var i=Gt(e),l=Gt(t);return ul(i,Rt(i,l),Mt(i,l)+1).join("")},On.trimEnd=function(e,t,n){if((e=oo(e))&&(n||void 0===t))return e.slice(0,zt(e)+1);if(!e||!(t=Zi(t)))return e;var i=Gt(e);return ul(i,0,Mt(i,Gt(t))+1).join("")},On.trimStart=function(e,t,n){if((e=oo(e))&&(n||void 0===t))return e.replace(j,"");if(!e||!(t=Zi(t)))return e;var i=Gt(e);return ul(i,Rt(i,Gt(t))).join("")},On.truncate=function(e,t){var n=30,i="...";if(Ga(t)){var l="separator"in t?t.separator:l;n="length"in t?io(t.length):n,i="omission"in t?Zi(t.omission):i}var r=(e=oo(e)).length;if(wt(e)){var a=Gt(e);r=a.length}if(n>=r)return e;var o=n-Yt(i);if(o<1)return i;var u=a?ul(a,0,o).join(""):e.slice(0,o);if(void 0===l)return u+i;if(a&&(o+=u.length-o),Xa(l)){if(e.slice(o).search(l)){var c,s=u;for(l.global||(l=pe(l.source,oo(te.exec(l))+"g")),l.lastIndex=0;c=l.exec(s);)var d=c.index;u=u.slice(0,void 0===d?o:d)}}else if(e.indexOf(Zi(l),o)!=o){var v=u.lastIndexOf(l);v>-1&&(u=u.slice(0,v))}return u+i},On.unescape=function(e){return(e=oo(e))&&w.test(e)?e.replace(F,Wt):e},On.uniqueId=function(e){var t=++Ie;return oo(e)+t},On.upperCase=Vo,On.upperFirst=Uo,On.each=oa,On.eachRight=ua,On.first=kr,Qo(On,(ou={},ui(On,function(e,t){Te.call(On.prototype,t)||(ou[t]=e)}),ou),{chain:!1}),On.VERSION="4.17.21",it(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){On[e].placeholder=On}),it(["drop","take"],function(e,t){bn.prototype[e]=function(n){n=void 0===n?1:an(io(n),0);var i=this.__filtered__&&!t?new bn(this):this.clone();return i.__filtered__?i.__takeCount__=on(n,i.__takeCount__):i.__views__.push({size:on(n,4294967295),type:e+(i.__dir__<0?"Right":"")}),i},bn.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),it(["filter","map","takeWhile"],function(e,t){var n=t+1,i=1==n||3==n;bn.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:ql(e,3),type:n}),t.__filtered__=t.__filtered__||i,t}}),it(["head","last"],function(e,t){var n="take"+(t?"Right":"");bn.prototype[e]=function(){return this[n](1).value()[0]}}),it(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");bn.prototype[e]=function(){return this.__filtered__?new bn(this):this[n](1)}}),bn.prototype.compact=function(){return this.filter(Ko)},bn.prototype.find=function(e){return this.filter(e).head()},bn.prototype.findLast=function(e){return this.reverse().find(e)},bn.prototype.invokeMap=xi(function(e,t){return"function"==typeof e?new bn(this):this.map(function(n){return Si(n,e,t)})}),bn.prototype.reject=function(e){return this.filter(Da(ql(e)))},bn.prototype.slice=function(e,t){e=io(e);var n=this;return n.__filtered__&&(e>0||t<0)?new bn(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=io(t))<0?n.dropRight(-t):n.take(t-e)),n)},bn.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},bn.prototype.toArray=function(){return this.take(4294967295)},ui(bn.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),l=On[i?"take"+("last"==t?"Right":""):t],r=i||/^find/.test(t);l&&(On.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,o=t instanceof bn,u=a[0],c=o||Pa(t),s=function(e){var t=l.apply(On,st([e],a));return i&&d?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(o=c=!1);var d=this.__chain__,v=!!this.__actions__.length,m=r&&!d,f=o&&!v;if(!r&&c){t=f?t:new bn(this);var p=e.apply(t,a);return p.__actions__.push({func:na,args:[s],thisArg:void 0}),new Mn(p,d)}return m&&f?e.apply(this,a):(p=this.thru(s),m?i?p.value()[0]:p.value():p)})}),it(["pop","push","shift","sort","splice","unshift"],function(e){var t=Se[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);On.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var l=this.value();return t.apply(Pa(l)?l:[],e)}return this[n](function(n){return t.apply(Pa(n)?n:[],e)})}}),ui(bn.prototype,function(e,t){var n=On[t];if(n){var i=n.name+"";Te.call(gn,i)||(gn[i]=[]),gn[i].push({name:t,func:n})}}),gn[Al(void 0,2).name]=[{name:"wrapper",func:void 0}],bn.prototype.clone=function(){var e=new bn(this.__wrapped__);return e.__actions__=El(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=El(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=El(this.__views__),e},bn.prototype.reverse=function(){if(this.__filtered__){var e=new bn(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},bn.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Pa(e),i=t<0,l=n?e.length:0,r=function(e,t,n){for(var i=-1,l=n.length;++i<l;){var r=n[i],a=r.size;switch(r.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=on(t,e+a);break;case"takeRight":e=an(e,t-a)}}return{start:e,end:t}}(0,l,this.__views__),a=r.start,o=r.end,u=o-a,c=i?o:a-1,s=this.__iteratees__,d=s.length,v=0,m=on(u,this.__takeCount__);if(!n||!i&&l==u&&m==u)return tl(e,this.__actions__);var f=[];e:for(;u--&&v<m;){for(var p=-1,E=e[c+=t];++p<d;){var _=s[p],S=_.type,g=(0,_.iteratee)(E);if(2==S)E=g;else if(!g){if(1==S)continue e;break e}}f[v++]=E}return f},On.prototype.at=ia,On.prototype.chain=function(){return ta(this)},On.prototype.commit=function(){return new Mn(this.value(),this.__chain__)},On.prototype.next=function(){void 0===this.__values__&&(this.__values__=to(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},On.prototype.plant=function(e){for(var t,n=this;n instanceof Rn;){var i=Or(n);i.__index__=0,i.__values__=void 0,t?l.__wrapped__=i:t=i;var l=i;n=n.__wrapped__}return l.__wrapped__=e,t},On.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof bn){var t=e;return this.__actions__.length&&(t=new bn(this)),(t=t.reverse()).__actions__.push({func:na,args:[Gr],thisArg:void 0}),new Mn(t,this.__chain__)}return this.thru(Gr)},On.prototype.toJSON=On.prototype.valueOf=On.prototype.value=function(){return tl(this.__wrapped__,this.__actions__)},On.prototype.first=On.prototype.head,Tt&&(On.prototype[Tt]=function(){return this}),On}();We?((We.exports=jt)._=jt,ze._=jt):Ge._=jt}).call(_)}(v={exports:{}},v.exports),v.exports),g=function(e){var n=e.path,a=r.useLocation(),o=l.useTranslation().t,u=Digit.ComponentRegistryService.getComponent("FSMNewApplicationCitizen"),s=Digit.ComponentRegistryService.getComponent("FSMMyApplications"),d=Digit.ComponentRegistryService.getComponent("FSMEmployeeApplicationDetails"),v=Digit.ComponentRegistryService.getComponent("FSMCitizenApplicationDetails"),m=Digit.ComponentRegistryService.getComponent("FSMSelectRating"),f=Digit.ComponentRegistryService.getComponent("FSMRateView"),p=Digit.ComponentRegistryService.getComponent("FSMResponse"),E=Digit.ComponentRegistryService.getComponent("FSMDsoDashboard"),_=Digit.ComponentRegistryService.getComponent("FSMEmpInbox");return i.createElement(i.Fragment,null,i.createElement("div",{className:"fsm-citizen-wrapper"},a.pathname.includes("/response")||a.pathname.split("/").includes("check")?null:i.createElement(t.BackButton,null,o("CS_COMMON_BACK")),i.createElement(r.Switch,null,i.createElement(t.PrivateRoute,{path:n+"/inbox",component:function(){return Digit.UserService.hasAccess(["FSM_DSO"])?i.createElement(_,{parentRoute:n,isInbox:!0}):i.createElement(r.Redirect,{to:"/digit-ui/citizen"})}}),i.createElement(t.PrivateRoute,{path:n+"/search",component:function(){return Digit.UserService.hasAccess(["FSM_DSO"])?i.createElement(_,{parentRoute:n,isSearch:!0}):i.createElement(r.Redirect,{to:"/digit-ui/citizen"})}}),i.createElement(t.PrivateRoute,{path:n+"/new-application",component:function(){return i.createElement(u,{parentRoute:n})}}),i.createElement(t.PrivateRoute,{path:n+"/my-applications",component:s}),i.createElement(t.PrivateRoute,{path:n+"/dso-application-details/:id",component:function(){return i.createElement(d,{parentRoute:n,userType:"DSO"})}}),i.createElement(t.PrivateRoute,{path:n+"/application-details/:id",component:function(){return i.createElement(v,{parentRoute:n})}}),i.createElement(t.PrivateRoute,{path:n+"/rate/:id",component:function(){return i.createElement(m,{parentRoute:n})}}),i.createElement(t.PrivateRoute,{path:n+"/rate-view/:id",component:function(){return i.createElement(f,{parentRoute:n})}}),i.createElement(t.PrivateRoute,{path:n+"/response",component:function(e){return i.createElement(p,c({parentRoute:n},e))}}),i.createElement(t.PrivateRoute,{path:n+"/dso-dashboard",component:function(){return i.createElement(E,{parentRoute:n})}}))))},y=function(e,t){var n,i;return null!=e&&e.slumName?t(e.slumName):null!=e&&null!==(n=e.slum)&&void 0!==n&&n.i18nKey?t(""+(null==e||null===(i=e.slum)||void 0===i?void 0:i.i18nKey)):"N/A"},h=function(e){return e&&0!==e?"₹ "+e:"N/A"},T=function(e){return e&&0!==e?"₹ "+e:"N/A"},I=function(e,t,n){var i,l,r,a,o,u,c,s,d,v,f,p,E,_,S,g,I,D,C,N,A,O,L,R=e.additionalDetails,M=null==R?void 0:R.tripAmount,b=M*(null==e?void 0:e.noOfTrips),P=null==e?void 0:e.advanceAmount;return{t:n,tenantId:null==t?void 0:t.code,name:n(null==t?void 0:t.i18nKey)+" "+n("ULBGRADE_"+(null==t||null===(i=t.city)||void 0===i?void 0:i.ulbGrade.toUpperCase().replace(" ","_").replace(".","_"))),email:null==t?void 0:t.emailId,phoneNumber:null==t?void 0:t.contactNumber,heading:n("PDF_HEADER_DESLUDGING_REQUEST_ACKNOWLEDGEMENT"),details:[{title:n("CS_TITLE_APPLICATION_DETAILS"),values:[{title:n("CS_MY_APPLICATION_APPLICATION_NO"),value:null==e?void 0:e.applicationNo},{title:n("CS_APPLICATION_DETAILS_APPLICATION_DATE"),value:Digit.DateUtils.ConvertTimestampToDate(null==e||null===(l=e.auditDetails)||void 0===l?void 0:l.createdTime,"dd/MM/yyyy")},{title:n("CS_APPLICATION_DETAILS_APPLICATION_CHANNEL"),value:n("ES_APPLICATION_DETAILS_APPLICATION_CHANNEL_"+(null==e?void 0:e.source))||"N/A"}]},{title:n("CS_APPLICATION_DETAILS_APPLICANT_DETAILS"),values:[{title:n("CS_APPLICATION_DETAILS_APPLICANT_NAME"),value:(null==e||null===(r=e.citizen)||void 0===r?void 0:r.name)||"N/A"},{title:n("CS_APPLICATION_DETAILS_APPLICANT_MOBILE"),value:(null==e||null===(a=e.citizen)||void 0===a?void 0:a.mobileNumber)||"N/A"}]},{title:n("CS_APPLICATION_DETAILS_PROPERTY_DETAILS"),values:[{title:n("CS_APPLICATION_DETAILS_PROPERTY_TYPE"),value:n((L=null==e?void 0:e.propertyUsage,"PROPERTYTYPE_MASTERS_"+(null==L?void 0:L.split(".")[0])))||"N/A"},{title:n("CS_APPLICATION_DETAILS_PROPERTY_SUB_TYPE"),value:n(m(null==e?void 0:e.propertyUsage))||"N/A"}]},{title:n("CS_APPLICATION_DETAILS_PROPERTY_LOCATION_DETAILS"),values:[{title:n("CS_APPLICATION_DETAILS_PINCODE"),value:(null==e||null===(o=e.address)||void 0===o?void 0:o.pincode)||"N/A"},{title:n("CS_APPLICATION_DETAILS_CITY"),value:(null==e||null===(u=e.address)||void 0===u?void 0:u.city)||"N/A"},{title:n("CS_APPLICATION_DETAILS_MOHALLA"),value:n((null==e||null===(c=e.tenantId)||void 0===c?void 0:c.toUpperCase().split(".").join("_"))+"_REVENUE_"+(null==e||null===(s=e.address)||void 0===s||null===(d=s.locality)||void 0===d?void 0:d.code))||"N/A"},{title:n("CS_APPLICATION_DETAILS_SLUM_NAME"),value:y(e,n)},{title:n("CS_APPLICATION_DETAILS_STREET"),value:(null==e||null===(v=e.address)||void 0===v?void 0:v.street)||"N/A"},{title:n("CS_APPLICATION_DETAILS_DOOR_NO"),value:(null==e||null===(f=e.address)||void 0===f?void 0:f.doorNo)||"N/A"},{title:n("CS_APPLICATION_DETAILS_LANDMARK"),value:(null==e||null===(p=e.address)||void 0===p?void 0:p.landmark)||"N/A"}]},{title:n("CS_APPLICATION_DETAILS_PIT_DETAILS"),values:[{title:n("CS_APPLICATION_DETAILS_PIT_TYPE"),value:null!=e&&e.sanitationtype?n("PITTYPE_MASTERS_"+(null==e?void 0:e.sanitationtype)):"N/A"},{title:n("CS_APPLICATION_DETAILS_DIMENSION"),value:null!=e&&null!==(E=e.pitDetail)&&void 0!==E&&E.height&&null!==(null==e||null===(_=e.pitDetail)||void 0===_?void 0:_.height)?null!=e&&null!==(S=e.pitDetail)&&void 0!==S&&S.length?(null==e||null===(g=e.pitDetail)||void 0===g?void 0:g.length)+"m * "+(null==e||null===(I=e.pitDetail)||void 0===I?void 0:I.width)+"m * "+(null==e||null===(D=e.pitDetail)||void 0===D?void 0:D.height)+"m                                  ("+n("CS_COMMON_LENGTH")+" x "+n("CS_COMMON_BREADTH")+" x "+n("CS_COMMON_DEPTH")+")":(null==e||null===(C=e.pitDetail)||void 0===C?void 0:C.diameter)+"m * "+(null==e||null===(N=e.pitDetail)||void 0===N?void 0:N.height)+"m                                  ("+n("CS_COMMON_DIAMETER")+" x "+n("CS_COMMON_DEPTH")+")":"N/A"},{title:n("ES_APPLICATION_DETAILS_VEHICLE_CAPACITY"),value:(O=null==e?void 0:e.vehicleCapacity,O||"N/A")},{title:n("CS_APPLICATION_DETAILS_TRIPS"),value:(null==e?void 0:e.noOfTrips)||"N/A"},{title:n("CS_APPLICATION_DETAILS_AMOUNT_PER_TRIP"),value:h(M)},{title:n("CS_APPLICATION_DETAILS_AMOUNT_DUE"),value:T(b)},{title:n("CS_APPLICATION_DETAILS_ADV_AMOUNT_DUE"),value:(A=P,null===A?"N/A":"₹ "+A)}]}]}},D=function(e){var t=e.otherComment;return i.createElement("div",{className:"checkpoint-comments-wrap"},i.createElement("h4",null,e.headComment),i.createElement("p",null,t))},C=function(e){var t,r,a,o,u,c,s,d,v,m=e.assigner,f=l.useTranslation().t,p=(n.useState(null),Digit.ULBService.getCurrentTenantId()),E=Digit.Hooks.useEmployeeSearch(p,{uuids:null==m?void 0:m.uuid},{enabled:"employee"===Digit.UserService.getType()&&"EMPLOYEE"===(null==m?void 0:m.type)}).data;return i.createElement("p",null,null==m?void 0:m.name," ",null!=E&&null!==(t=E.Employees)&&void 0!==t&&null!==(r=t[0])&&void 0!==r&&null!==(a=r.assignments)&&void 0!==a&&null!==(o=a[0])&&void 0!==o&&o.designation?"("+f("COMMON_MASTERS_DESIGNATION_"+(null==E||null===(u=E.Employees)||void 0===u||null===(c=u[0])||void 0===c||null===(s=c.assignments)||void 0===s||null===(d=s[0])||void 0===d?void 0:d.designation))+")":"","CITIZEN"===(null==m?void 0:m.type)&&null!=m&&null!==(v=m.roles)&&void 0!==v&&v.some(function(e){return"FSM_DSO"===e.code})?"(DSO)":"")},N=function(e){var n=e.data,r=l.useTranslation().t;return i.createElement("div",null,n.date&&i.createElement("p",null,n.date),i.createElement(C,{assigner:n.name}),n.mobileNumber&&i.createElement(t.TelePhone,{mobile:n.mobileNumber}),n.source&&i.createElement("p",null,r("ES_APPLICATION_DETAILS_APPLICATION_CHANNEL_"+n.source.toUpperCase())),n.comment&&i.createElement(D,{otherComment:null==n?void 0:n.otherComment,headComment:null==n?void 0:n.comment}))},A=function(e){var a,o,u,c,s=l.useTranslation().t,d=Digit.Hooks.useWorkflowDetails({tenantId:null===(a=e.application)||void 0===a?void 0:a.tenantId,id:e.id,moduleCode:"FSM"}),v=d.isLoading,m=d.data,f=function(l){var a,o=null==l||null===(a=l.comment)||void 0===a?void 0:a.split("~"),u=o?o[0]:null,c=o?o[1]:null;if("CREATED"===l.status){var d,v,f={date:null==l||null===(d=l.auditDetails)||void 0===d?void 0:d.created,source:(null===(v=e.application)||void 0===v?void 0:v.source)||""};return i.createElement(N,{data:f})}if("PENDING_APPL_FEE_PAYMENT"===l.status||"DSO_REJECTED"===l.status||"CANCELED"===l.status||"REJECTED"===l.status){var p,E={date:null==l||null===(p=l.auditDetails)||void 0===p?void 0:p.created,name:null==l?void 0:l.assigner,comment:u?s("ES_ACTION_REASON_"+u):null,otherComment:c||null};return i.createElement(N,{data:E})}if("CITIZEN_FEEDBACK_PENDING"===l.status)return i.createElement(n.Fragment,null,(null==m?void 0:m.nextActions.length)>0&&i.createElement("div",null,i.createElement(r.Link,{to:"/digit-ui/citizen/fsm/rate/"+e.id},i.createElement(t.ActionLinks,null,s("CS_FSM_RATE")))));if("DSO_INPROGRESS"===l.status){var _,S,g,y={name:null==l?void 0:l.assigner,mobileNumber:null===(_=e.application)||void 0===_||null===(S=_.dsoDetails)||void 0===S?void 0:S.mobileNumber,date:s("CS_FSM_EXPECTED_DATE")+" "+Digit.DateUtils.ConvertTimestampToDate(null===(g=e.application)||void 0===g?void 0:g.possibleServiceDate)};return i.createElement(N,{data:y})}if("COMPLETED"===l.status)return i.createElement("div",null,i.createElement(t.Rating,{withText:!0,text:s("CS_FSM_YOU_RATED"),currentRating:l.rating}),i.createElement(r.Link,{to:"/digit-ui/citizen/fsm/rate-view/"+e.id},i.createElement(t.ActionLinks,null,s("CS_FSM_RATE_VIEW"))));if("DISPOSAL_IN_PROGRESS"===l.status){var h,T,I={date:null==l||null===(h=l.auditDetails)||void 0===h?void 0:h.created,name:null==l?void 0:l.assigner,mobileNumber:null==l||null===(T=l.assigner)||void 0===T?void 0:T.mobileNumber};return null!=l&&l.numberOfTrips&&(I.comment=s("NUMBER_OF_TRIPS")+": "+(null==l?void 0:l.numberOfTrips)),i.createElement(N,{data:I})}};return v?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,!v&&i.createElement(n.Fragment,null,(null==m||null===(o=m.timeline)||void 0===o?void 0:o.length)>0&&i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},s("CS_APPLICATION_DETAILS_APPLICATION_TIMELINE")),null!=m&&m.timeline&&1===(null==m||null===(u=m.timeline)||void 0===u?void 0:u.length)?i.createElement(t.CheckPoint,{isCompleted:!0,label:s("CS_COMMON_"+(null==m||null===(c=m.timeline[0])||void 0===c?void 0:c.status)),customChild:f(null==m?void 0:m.timeline[0])}):i.createElement(t.ConnectingCheckPoints,null,(null==m?void 0:m.timeline)&&(null==m?void 0:m.timeline.map(function(e,n,l){return i.createElement(i.Fragment,{key:n},i.createElement(t.CheckPoint,{keyValue:n,isCompleted:0===n,label:s("CS_COMMON_"+e.status),customChild:f(e)}))})))),m&&function(n){switch(null==n?void 0:n.action){case"PAY":return i.createElement("div",{style:{marginTop:"24px"}},i.createElement(r.Link,{to:{pathname:"/digit-ui/citizen/payment/my-bills/FSM.TRIP_CHARGES/"+e.id+"/?tenantId="+e.application.tenantId,state:{tenantId:e.application.tenantId}}},!window.location.href.includes("citizen/fsm/")&&i.createElement(t.SubmitBar,{label:s("CS_APPLICATION_DETAILS_MAKE_PAYMENT")})));case"SUBMIT_FEEDBACK":return i.createElement("div",{style:{marginTop:"24px"}},i.createElement(r.Link,{to:"/digit-ui/citizen/fsm/rate/"+e.id},i.createElement(t.SubmitBar,{label:s("CS_APPLICATION_DETAILS_RATE")})))}}(null==m?void 0:m.nextActions[0]))},O=function(e){var n=e.application,a=l.useTranslation().t;return i.createElement(t.Card,null,i.createElement(t.KeyNote,{keyValue:a("CS_FSM_APPLICATION_APPLICATION_NO"),note:n.applicationNo}),i.createElement(t.KeyNote,{keyValue:a("CS_FSM_APPLICATION_SERVICE_CATEGORY"),note:n.serviceCategory||a("CS_TITLE_FSM")}),i.createElement(t.KeyNote,{keyValue:a("CS_FSM_APPLICATION_DETAIL_STATUS"),note:a("CS_COMMON_"+n.applicationStatus)}),i.createElement(r.Link,{to:{pathname:"/digit-ui/citizen/fsm/application-details/"+n.applicationNo,state:{tenantId:n.tenantId}}},i.createElement(t.SubmitBar,{label:a("CS_COMMON_VIEW")})))},L=((d={type:"component",route:"check-slum",isMandatory:!0,component:"CheckSlum",texts:{header:"ES_NEW_APPLICATION_SLUM_CHECK",submitBarLabel:"CS_COMMON_NEXT"}}).component="CheckSlum",d.key="address",d.withoutLabel=!0,d.nextStep="slum-details",d.hideInEmployee=!0,function(e){var n=e.jumpTo,a=l.useTranslation().t,o=r.useHistory();return i.createElement(t.LinkButton,{label:a("CS_COMMON_CHANGE"),className:"check-page-link-button",onClick:function(){o.push(n)}})}),R=function(e){var n,a,o,u,s,d,v,m,f,p,_,S=e.onSubmit,g=e.value,y=l.useTranslation().t,h=(r.useHistory(),g.address),T=g.propertyType,I=g.subtype,D=g.pitType,C=g.pitDetail,N=g.selectGender,A=g.selectPaymentPreference,O=g.selectTripNo,R=C?Object.values(C).filter(function(e){return!!e}):null,M=null==R?void 0:R.reduce(function(e,t,n,i){return n===i.length-1?e+t+"m":e+t+"m x "},"");return i.createElement(i.Fragment,null,i.createElement(E,{currentStep:4,flow:"APPLY"}),i.createElement(t.Card,null,i.createElement(t.CardHeader,null,y("CS_CHECK_CHECK_YOUR_ANSWERS")),i.createElement(t.CardText,null,y("CS_CHECK_CHECK_YOUR_ANSWERS_TEXT")),i.createElement(t.CardSubHeader,null,y("CS_CHECK_PROPERTY_DETAILS")),i.createElement(t.StatusTable,null,O&&(null==O?void 0:O.tripNo)&&i.createElement(t.Row,{label:y("ES_FSM_ACTION_NUMBER_OF_TRIPS"),text:y(null==O||null===(n=O.tripNo)||void 0===n?void 0:n.i18nKey),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/select-trip-number"})}),O&&(null==O?void 0:O.vehicleCapacity)&&i.createElement(t.Row,{label:y("ES_VEHICLE CAPACITY"),text:y(null==O||null===(a=O.vehicleCapacity)||void 0===a?void 0:a.capacity),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/select-trip-number"})}),N&&i.createElement(t.Row,{label:y("ES_FSM_ACTION_GENDER_TYPE"),text:y(N.i18nKey),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/select-gender"})}),i.createElement(t.Row,{label:y("CS_CHECK_PROPERTY_TYPE"),text:y(T.i18nKey),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/property-type"})}),i.createElement(t.Row,{label:y("CS_CHECK_PROPERTY_SUB_TYPE"),text:y(I.i18nKey),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/property-subtype"})}),i.createElement(t.Row,{label:y("CS_CHECK_ADDRESS"),text:(null!=h&&null!==(o=h.doorNo)&&void 0!==o&&o.trim()?(null==h||null===(u=h.doorNo)||void 0===u?void 0:u.trim())+", ":"")+" "+(null!=h&&null!==(s=h.street)&&void 0!==s&&s.trim()?(null==h||null===(d=h.street)||void 0===d?void 0:d.trim())+", ":"")+y(null==h||null===(v=h.locality)||void 0===v?void 0:v.i18nkey)+", "+y(null==h?void 0:h.city.code),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/pincode"})}),(null==h||null===(m=h.landmark)||void 0===m?void 0:m.trim())&&i.createElement(t.Row,{label:y("CS_CHECK_LANDMARK"),text:null==h||null===(f=h.landmark)||void 0===f?void 0:f.trim(),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/landmark"})}),!0===(null==h||null===(p=h.slumArea)||void 0===p?void 0:p.code)&&i.createElement(t.Row,{label:y("CS_APPLICATION_DETAILS_SLUM_NAME"),text:y(null==h||null===(_=h.slumData)||void 0===_?void 0:_.i18nKey),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/slum-details"})}),D&&i.createElement(t.Row,{label:y("CS_CHECK_PIT_TYPE"),text:y(D.i18nKey),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/pit-type"})}),M&&i.createElement(t.Row,{label:y("CS_CHECK_SIZE"),text:[M],actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/tank-size"})}),((null==A?void 0:A.advanceAmount)||0===(null==A?void 0:A.advanceAmount))&&i.createElement(t.Row,{label:y("ADV_AMOUNT"),text:"₹ "+y(null==A?void 0:A.advanceAmount),actionButton:i.createElement(L,{jumpTo:"/digit-ui/citizen/fsm/new-application/select-payment-preference"})})),i.createElement(t.SubmitBar,{label:y("CS_COMMON_SUBMIT"),onSubmit:S})),T&&i.createElement(t.CitizenInfoLabel,{style:{marginTop:"8px",padding:"16px"},info:y("CS_FILE_APPLICATION_INFO_LABEL"),text:y("CS_FILE_APPLICATION_INFO_TEXT",c({content:y("CS_DEFAULT_INFO_TEXT")},T))}))},M=function(e){var n;return i.createElement(t.Banner,{message:(0,l.useTranslation().t)("CS_FILE_DESLUDGING_APPLICATION_SUCCESS"),applicationNumber:null===(n=e.data)||void 0===n?void 0:n.fsm[0].applicationNo,info:e.t("CS_FILE_DESLUDGING_APPLICATION_NO"),successful:e.isSuccess})},b=function(e){var a,o,u,s,d,v,m,f,p,E,_=e.data,S=e.onSuccess,g=l.useTranslation().t,y=Digit.ULBService.getCurrentTenantId(),h=Digit.Hooks.fsm.useDesludging(null!=_&&null!==(a=_.address)&&void 0!==a&&a.city?null===(o=_.address)||void 0===o||null===(u=o.city)||void 0===u?void 0:u.code:y),T=(Digit.Hooks.useStore.getInitData().data||{}).tenants,D=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1),C=D[0],N=D[1],A=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1),O=A[0],L=A[1],R=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1),b=R[0],P=R[1],F=n.useState(null),k=F[0],w=F[1],x=n.useState(null),H=x[0],V=x[1],U=n.useState(null),B=U[0],Y=U[1],G=(null==h?void 0:h.data)||b,z=null==G||null===(s=G.fsm)||void 0===s||null===(d=s[0].address)||void 0===d||null===(v=d.locality)||void 0===v?void 0:v.code,W=null==G||null===(m=G.fsm)||void 0===m||null===(f=m[0].address)||void 0===f?void 0:f.slumName,j=Digit.Hooks.fsm.useSlum(null==G||null===(p=G.fsm)||void 0===p||null===(E=p[0].address)||void 0===E?void 0:E.tenantId,W,z,{enabled:!!W,retry:!!W}),K=function(e,t){var n,i,l;L((null==e||null===(n=e.response)||void 0===n||null===(i=n.data)||void 0===i||null===(l=i.Errors[0])||void 0===l?void 0:l.code)||"ERROR"),N(!0)};n.useEffect(function(){h.data&&P(h.data)},[h.data]),n.useEffect(function(){if(!C&&!O)try{var e,t,n,i,l=Digit.SessionStorage.get("total_amount"),r=Digit.SessionStorage.get("amount_per_trip"),a=_.subtype,o=_.pitDetail,u=_.address,c=_.pitType,s=_.source,d=_.selectGender,v=_.selectPaymentPreference,m=_.selectTripNo,f=u.city,p=u.locality,E=u.geoLocation,g=u.pincode,y=u.street,T=u.doorNo,I=u.landmark,D=u.slum;w(null==v?void 0:v.code);var A=0===l?null:null==v?void 0:v.advanceAmount;Y(0===l),V(0===A);var L={fsm:(i={citizen:{gender:null==d?void 0:d.code},tenantId:f.code,additionalDetails:{},propertyUsage:a.code,address:{tenantId:f.code,additionalDetails:null,street:null==y?void 0:y.trim(),doorNo:null==T?void 0:T.trim(),landmark:null==I?void 0:I.trim(),slumName:D,city:f.name,pincode:g,locality:{code:p.code,name:p.name},geoLocation:{latitude:null==E?void 0:E.latitude,longitude:null==E?void 0:E.longitude,additionalDetails:{}}},pitDetail:{additionalDetails:{fileStoreId:{CITIZEN:null==o?void 0:o.images}}},source:s,sanitationtype:null==c?void 0:c.code,paymentPreference:0===l?null:null!=v&&v.paymentType?null==v||null===(e=v.paymentType)||void 0===e?void 0:e.code:null,noOfTrips:m?null==m||null===(t=m.tripNo)||void 0===t?void 0:t.code:1,vehicleCapacity:m?null==m||null===(n=m.vehicleCapacity)||void 0===n?void 0:n.capacity:""},i.additionalDetails={totalAmount:l,tripAmount:r},i.advanceAmount=A,i),workflow:null};h.mutate(L,{onError:K,onSuccess:function(){N(!0),S()}}),sessionStorage.removeItem("Digit.total_amount")}catch(e){}},[]);var X=!!b||(null==h?void 0:h.isSuccess);return h.isLoading||h.isIdle&&!C?i.createElement(t.Loader,null):i.createElement(t.Card,null,i.createElement(M,{t:g,data:G,isSuccess:X,isLoading:h.isIdle&&!C||(null==h?void 0:h.isLoading)}),i.createElement(t.CardText,null,g(k&&"POST_PAY"==k||H?"CS_FILE_PROPERTY_RESPONSE_POST_PAY":B?"CS_FSM_RESPONSE_CREATE_DISPLAY_ZERO_PAY":"CS_FILE_PROPERTY_RESPONSE")),X&&i.createElement(t.LinkButton,{label:i.createElement("div",{className:"response-download-button"},i.createElement("span",null,i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#f47738"},i.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}))),i.createElement("span",{className:"download-button"},g("CS_COMMON_DOWNLOAD"))),onClick:function(){var e=G.fsm,t=e[0],n=(e.slice(1),T.find(function(e){return e.code===t.tenantId})),i=I(c({},t,{slum:j}),n,g);Digit.Utils.pdf.generate(i)},className:"w-full"}),i.createElement(r.Link,{to:"/digit-ui/citizen"},i.createElement(t.SubmitBar,{label:g("CORE_COMMON_GO_TO_HOME")})))},P=function(e){var a=l.useTranslation().t,o=r.useHistory(),u=n.useState(""),c=u[0],s=u[1],d={texts:{cardText:"",submitBarLabel:"CS_COMMON_NEXT"},inputs:[{label:a("ES_FSM_VEHICLE_NUMBER"),type:"text",name:"vehicleNumber",validation:{pattern:"[A-Z]{2}\\s{1}[0-9]{2}\\s{0,1}[A-Z]{1,2}\\s{1}[0-9]{4}",title:a("ES_FSM_VEHICLE_FORMAT_TIP")}}],key:"vehicleNumber"},v=window.Digit.Utils.browser.isMobile();return i.createElement(i.Fragment,null,i.createElement("div",{style:v?{}:{marginLeft:"20px"}},i.createElement(t.Header,null,a("ES_FSM_ADD_VEHICLE_LOG"))),i.createElement(t.FormStep,{config:d,onChange:function(e){0!=e.target.value.trim().length&&s(e.target.value)},onSelect:function(e){o.push("/digit-ui/employee/fsm/fstp-fsm-request/"+e.vehicleNumber.trim())},t:a,isDisabled:!c,cardStyle:{margin:"10px"},textInputStyle:{maxWidth:"540px"}}))},F=function(){return l.useTranslation(),Digit.ULBService.getStateId(),Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId(),r.useHistory(),i.createElement(i.Fragment,null,i.createElement(t.ULBHomeCard,{title:"ES_COMMON_FSTP_OPERATION",module:[{name:"ES_FSM_ADD_NEW_BUTTON",link:"/digit-ui/employee/fsm/fstp-add-vehicle",icon:i.createElement(t.AddNewIcon,null)},{name:"ES_FSM_VIEW_REPORTS_BUTTON",link:"/employee/report/fsm/FSMFSTPPlantWithVehicleLogReport",hyperlink:!0,icon:i.createElement(t.ViewReportIcon,null)},{name:"ES_COMMON_INBOX",link:"/digit-ui/employee/fsm/fstp-inbox",icon:i.createElement(t.InboxIcon,null)}]}," "))},k=function(e){var a=e.parentRoute,o=l.useTranslation().t,u=[{text:o("ES_TITLE_NEW_DESULDGING_APPLICATION"),link:"/digit-ui/employee/fsm/new-application",roles:["FSM_CREATOR_EMP"]},{text:o("ES_TITILE_SEARCH_APPLICATION"),link:a+"/search"},{text:o("ES_TITLE_REPORTS"),link:"/employee/report/fsm/FSMDailyDesludingReport",roles:["FSM_ADMIN"],hyperlink:!0}],c=n.useState([]),s=c[0],d=c[1],v=Digit.UserService.getUser().info.roles;return n.useEffect(function(){var e=u.filter(function(e){var t=e.roles;return(null==t?void 0:t.some(function(e){return null==v?void 0:v.map(function(e){return e.code}).includes(e)}))||!(null!=t&&t.length)});d(e)},[]),i.createElement(t.Card,{className:"employeeCard inboxLinksFSM"},i.createElement("div",{className:"complaint-links-container"},i.createElement("div",{className:"header"},i.createElement("span",{className:"logo"},i.createElement(t.ShippingTruck,null))," ",i.createElement("span",{className:"text"},o("ES_TITLE_FAECAL_SLUDGE_MGMT"))),i.createElement("div",{className:"body"},s.map(function(e,t){var n=e.link,l=e.text,a=e.hyperlink;return i.createElement("span",{className:"link",key:t},void 0!==a&&a?i.createElement("a",{href:n},l):i.createElement(r.Link,{to:n},l))}))))},w=function(e){var n=e.className;return i.createElement(t.Table,{className:void 0===n?"table":n,t:e.t,data:e.data,currentPage:e.currentPage,columns:e.columns,getCellProps:e.getCellProps,onNextPage:e.onNextPage,onPrevPage:e.onPrevPage,pageSizeLimit:e.pageSizeLimit,disableSort:e.disableSort,onPageSizeChange:e.onPageSizeChange,onSort:e.onSort,sortParams:e.sortParams,totalRecords:e.totalRecords,isPaginationRequired:e.isPaginationRequired})},x=function(e){var n,r,a=e.status,o=e.fsmfilters,u=e.onAssignmentChange,c=e.statusMap,s=l.useTranslation().t,d=null==c||null===(n=c.filter(function(e){return(null==e?void 0:e.applicationstatus)===a.code}))||void 0===n||null===(r=n[0])||void 0===r?void 0:r.count;return i.createElement(t.CheckBox,{onChange:function(e){return u(e,a)},checked:0!==(null==o?void 0:o.applicationStatus.filter(function(e){return e.name===a.name}).length),label:s(a.name)+" ("+(d||0)+")"})},H=function(e){var r=e.onAssignmentChange,a=e.fsmfilters,o=e.mergedRoleDetails,u=e.statusMap,c=l.useTranslation().t,s=Digit.Hooks.fsm.useApplicationStatus(!0,!0,u),d=s.data,v=s.isLoading,m=n.useState(!1),f=m[0],p=m[1],E=o.statuses.map(function(e){return null==d?void 0:d.filter(function(t){return t.code===e})[0]}).filter(function(e){return null==e?void 0:e.code}),_=null==d?void 0:d.filter(function(e){return!E.find(function(t){return t.code===e.code})});return v?i.createElement(t.Loader,null):(null==E?void 0:E.length)>0?i.createElement("div",{className:"status-container"},i.createElement("div",{className:"filter-label"},c("ES_INBOX_STATUS")),null==E?void 0:E.map(function(e,t){return i.createElement(x,{key:t,onAssignmentChange:r,status:e,fsmfilters:a,statusMap:u})}),f?null==_?void 0:_.map(function(e,t){return i.createElement(x,{key:t,onAssignmentChange:r,status:e,fsmfilters:a,statusMap:u})}):null,!1===o.fixed&&_.length>0?i.createElement("div",{className:"filter-button",onClick:function(){return p(!f)}}," ",c(f?"ES_COMMON_LESS":"ES_COMMON_MORE")," "):null):null},V=["searchParams","paginationParms","onFilterChange","onSearch","removeParam"],U=function(e){var n,a,o,u,c,s,d=e.searchParams,v=e.onFilterChange,m=e.onSearch,f=function(e,t){if(null==e)return{};var n,i,l={},r=Object.keys(e);for(i=0;i<r.length;i++)t.indexOf(n=r[i])>=0||(l[n]=e[n]);return l}(e,V),p=l.useTranslation().t,E=r.useLocation(),_=Digit.UserService.hasAccess(["FSM_DSO"])||!1,S=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1,g=Digit.UserService.hasAccess("FSM_EMP_FSTPO")&&E.pathname.includes("fstp-fsm-request")||!1,y=Digit.ULBService.getCurrentTenantId(),h=Digit.ULBService.getStateId(),T=Digit.Hooks.fsm.useMDMS(h,"DIGIT-UI","RoleStatusMapping"),I=T.data,D=T.isFetched,C=Digit.UserService.getUser().info.roles.map(function(e){return e.code}),N=null==I?void 0:I.filter(function(e){return C.filter(function(t){return t===e.userRole})[0]}),A=null==N?void 0:N.reduce(function(e,t){return{fixed:(null==t?void 0:t.fixed)&&(null==e?void 0:e.fixed),statuses:[].concat(null==e?void 0:e.statuses,null==t?void 0:t.statuses).filter(function(e,t,n){return n.indexOf(e)==t}),zeroCheck:(null==t?void 0:t.zeroCheck)||(null==e?void 0:e.zeroCheck)}},{statuses:[]}),O=function(){if(S)return v();v({applicationStatus:[],locality:[]})};return i.createElement(i.Fragment,null,(!_&&!S&&d&&((null==d||null===(n=d.applicationStatus)||void 0===n?void 0:n.length)>0||(null==d||null===(a=d.locality)||void 0===a?void 0:a.length)>0)||(null==A||null===(o=A.statuses)||void 0===o?void 0:o.length)>0||g)&&i.createElement("div",{className:"filter",style:{marginTop:S?"-0px":"revert"}},i.createElement("div",{className:"filter-card"},i.createElement("div",{className:"heading"},i.createElement("div",{className:"filter-label"},p("ES_COMMON_FILTER_BY"),":"),i.createElement("div",{className:"clearAll",onClick:O},p("ES_COMMON_CLEAR_ALL")),"desktop"===f.type&&i.createElement("span",{className:"clear-search",onClick:O},p("ES_COMMON_CLEAR_ALL")),"mobile"===f.type&&i.createElement("span",{onClick:f.onClose},i.createElement(t.CloseSvg,null))),(null==A||null===(u=A.statuses)||void 0===u?void 0:u.length)>0||g?i.createElement("div",null,i.createElement("div",{className:"filter-label"},p("ES_INBOX_LOCALITY")),i.createElement(t.Localities,{selectLocality:function(e){v(S?{locality:[e]}:{locality:[].concat(null==d?void 0:d.locality,[e])})},tenantId:y,boundaryType:"revenue"}),i.createElement("div",{className:"tag-container"},null==d?void 0:d.locality.map(function(e,n){return i.createElement(t.RemoveableTag,{key:n,text:e.i18nkey,onClick:function(){v({locality:null==d?void 0:d.locality.filter(function(t){return t.code!==e.code})})}})}))):null,i.createElement("div",null,D&&A&&null!=f&&null!==(c=f.applications)&&void 0!==c&&c.statuses?i.createElement(H,{onAssignmentChange:function(e,t){v(e.target.checked?{applicationStatus:[].concat(null==d?void 0:d.applicationStatus,[t])}:{applicationStatus:null==d?void 0:d.applicationStatus.filter(function(e){return t.name!==e.name})})},fsmfilters:d,mergedRoleDetails:A,statusMap:null==f||null===(s=f.applications)||void 0===s?void 0:s.statuses}):E.pathname.includes("fstp-fsm-request")?"":i.createElement(t.Loader,null)))),"mobile"===f.type&&i.createElement(t.ActionBar,null,i.createElement(t.ApplyFilterBar,{submit:!1,labelLink:p("ES_COMMON_CLEAR_ALL"),buttonLink:p("ES_COMMON_FILTER"),onClear:O,onSubmit:function(){m()},style:{flex:1}})))},B=function(e){return e.areApplicationStatus?i.createElement(t.Dropdown,{option:e.applicationStatuses,optionKey:"name",selected:e.value,select:e.onAssignmentChange}):i.createElement(t.Loader,null)},Y=function(e){var r=e.onSearch,o=e.type,u=e.onClose,s=e.searchFields,d=e.searchParams,v=e.isInboxPage,m=v?Digit.SessionStorage.get("fsm/inbox/searchParams"):Digit.SessionStorage.get("fsm/search/searchParams"),f=Digit.Hooks.fsm.useApplicationStatus(),p=f.data,E=f.isFetched,_=l.useTranslation().t,S=a.useForm({defaultValues:m||d}),g=S.register,y=S.handleSubmit,h=S.reset,T=S.watch,I=S.control,D=n.useState(!1),C=D[0],N=D[1],A=innerWidth<=640,O=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1,L=T(["applicationNos","mobileNumber","fromDate","toDate"]);function R(){var e=s.reduce(function(e,t){var n;return c({},e,((n={})[null==t?void 0:t.name]="",n))},{});h(e),v?Digit.SessionStorage.del("fsm/inbox/searchParams"):Digit.SessionStorage.del("fsm/search/searchParams"),r({})}var M=function(e){return i.createElement(t.LinkLabel,{style:c({display:"inline"},e?{margin:0}:{}),onClick:R},_("ES_COMMON_CLEAR_SEARCH"))},b=function(e){return O?null:(N(!(L.applicationNos||L.mobileNumber||L.fromDate&&L.toDate)),!!(L.applicationNos||L.mobileNumber||L.fromDate&&L.toDate))},P=window.location.href.includes("employee/fsm/inbox")||window.location.href.includes("employee/fsm/fstp-inbox")||window.location.href.includes("employee/fsm/fstp-fsm-request");return i.createElement("form",{onSubmit:y(function(e){e.mobileNumber||delete e.mobileNumber,r(e),"mobile"===o&&u()})},i.createElement(i.Fragment,null,P?"":i.createElement(t.Header,{styles:A?{marginTop:"10px"}:{}},_("ACTION_TEST_SEARCH_FSM_APPLICATION")),i.createElement("div",{className:"search-container",style:{width:"auto",marginLeft:O?"":v?"24px":"revert"}},i.createElement("div",{className:"search-complaint-container"},("mobile"===o||A)&&i.createElement("div",{className:"complaint-header"},i.createElement("h2",null,_("ES_COMMON_SEARCH_BY")),i.createElement("span",{style:{position:"absolute",top:"2%",right:"8px"},onClick:u},i.createElement(t.CloseSvg,null))),i.createElement("div",{className:O?"complaint-input-container for-pt for-search":"complaint-input-container",style:{width:"100%"}},null==s?void 0:s.map(function(e,n){return i.createElement("span",{key:n,className:0===n?"complaint-input":"mobile-input"},i.createElement(t.Label,null,e.label),function(e){switch(e.type){case"date":return i.createElement(a.Controller,{render:function(e){return i.createElement(t.DatePicker,{date:e.value,onChange:e.onChange})},name:e.name,control:I,defaultValue:null});case"status":return i.createElement(a.Controller,{render:function(e){return i.createElement(B,{onAssignmentChange:e.onChange,value:e.value,applicationStatuses:p,areApplicationStatus:E})},name:e.name,control:I,defaultValue:null});default:return i.createElement(t.TextInput,c({},e,{inputRef:g},g(e.name,{validate:b}),{watch:T,shouldUpdate:!0}))}}(e)," ")}),"desktop"===o&&!A&&i.createElement(t.SubmitBar,{className:"submit-bar-search",label:_("ES_COMMON_SEARCH"),submit:!0})),C?i.createElement(t.CardLabelError,{className:"search-error-label"},_("ES_SEARCH_APPLICATION_ERROR")):null,"desktop"===o&&!A&&i.createElement("span",{className:"clear-search"},M()))),("mobile"===o||A)&&i.createElement(t.ActionBar,{className:"clear-search-container"},i.createElement("button",{className:"clear-search",style:{flex:1}},M(A)),i.createElement(t.SubmitBar,{label:_("ES_COMMON_SEARCH"),style:{flex:1},submit:!0}))))},G=function(e){var n,a,o,u,c,s=l.useTranslation().t,d=Digit.UserService.hasAccess(["FSM_DSO"])||!1,v=function(e){return i.createElement("span",{className:"cell-text"},e)},m=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1,f=i.useMemo(function(){if(e.isSearch)return[{Header:s("ES_INBOX_APPLICATION_NO"),accessor:"applicationNo",disableSortBy:!0,Cell:function(t){var n=t.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:e.parentRoute+"/"+(d?"dso-application-details":"application-details")+"/"+n.original.applicationNo},n.original.applicationNo)))}},{Header:s("ES_APPLICATION_DETAILS_APPLICANT_NAME"),disableSortBy:!0,accessor:function(e){var t;return v((null===(t=e.citizen)||void 0===t?void 0:t.name)||"")}},{Header:s("ES_APPLICATION_DETAILS_APPLICANT_MOBILE_NO"),disableSortBy:!0,accessor:function(e){var t;return v((null===(t=e.citizen)||void 0===t?void 0:t.mobileNumber)||"")}},{Header:s("ES_APPLICATION_DETAILS_PROPERTY_TYPE"),accessor:function(e){return s("PROPERTYTYPE_MASTERS_"+e.propertyUsage.split(".")[0])},disableSortBy:!0},{Header:s("ES_APPLICATION_DETAILS_PROPERTY_SUB-TYPE"),accessor:function(e){return s("PROPERTYTYPE_MASTERS_"+e.propertyUsage)},disableSortBy:!0},{Header:s("ES_INBOX_LOCALITY"),accessor:function(e){return v(s(Digit.Utils.locale.getRevenueLocalityCode(e.address.locality.code,e.tenantId)))},disableSortBy:!0},{Header:s("ES_INBOX_STATUS"),accessor:function(e){return v(s("CS_COMMON_FSM_"+e.applicationStatus))},disableSortBy:!0}];switch(e.userRole){case"FSM_EMP_FSTPO_REQUEST":return[{Header:s("ES_INBOX_APPLICATION_NO"),accessor:"applicationNo",Cell:function(t){var n,l=t.row,a=null==e||null===(n=e.fstprequest)||void 0===n?void 0:n.find(function(e){return l.original.tripDetails[0].referenceNo===e.applicationNo});return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:"/digit-ui/employee/fsm/fstp-operator-details/"+l.original.applicationNo}," ",null==a?void 0:a.applicationNo)))}},{Header:s("CS_COMMON_CITIZEN_NAME"),disableSortBy:!0,Cell:function(t){var n,l,r=t.row,a=null==e||null===(n=e.fstprequest)||void 0===n?void 0:n.find(function(e){return r.original.tripDetails[0].referenceNo===e.applicationNo});return i.createElement("div",null,i.createElement("span",null,null==a||null===(l=a.citizen)||void 0===l?void 0:l.name))}},{Header:s("CS_COMMON_CITIZEN_NUMBER"),disableSortBy:!0,accessor:"number",Cell:function(t){var n,l,r=t.row,a=null==e||null===(n=e.fstprequest)||void 0===n?void 0:n.find(function(e){return r.original.tripDetails[0].referenceNo===e.applicationNo});return i.createElement("div",null,i.createElement("span",null,null==a||null===(l=a.citizen)||void 0===l?void 0:l.mobileNumber))}},{Header:s("ES_INBOX_LOCALITY"),disableSortBy:!0,accessor:"locality",Cell:function(t){var n,l,r,a=t.row,o=null==e||null===(n=e.fstprequest)||void 0===n?void 0:n.find(function(e){return a.original.tripDetails[0].referenceNo===e.applicationNo});return i.createElement("div",null,i.createElement("span",null,s(""+(null==o||null===(l=o.address)||void 0===l||null===(r=l.locality)||void 0===r?void 0:r.code))))}}];case"FSM_EMP_FSTPO":return[{Header:s("ES_INBOX_APPLICATION_NO"),disableSortBy:!0,accessor:"tripDetails",Cell:function(e){var t=e.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:"/digit-ui/employee/fsm/fstp-operator-details/"+t.original.applicationNo},t.original.tripDetails.map(function(e){return i.createElement("div",null,e.referenceNo,i.createElement("br",null))}))))}},{Header:s("ES_INBOX_VEHICLE_LOG"),accessor:"applicationNo",disableSortBy:!0,Cell:function(e){var t=e.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:"/digit-ui/employee/fsm/fstp-operator-details/"+t.original.applicationNo},t.original.applicationNo)))}},{Header:s("ES_INBOX_APPLICATION_DATE"),accessor:"createdTime",Cell:function(e){var t=e.row;return v(new Date(t.original.auditDetails.createdTime).getDate()+"/"+(new Date(t.original.auditDetails.createdTime).getMonth()+1)+"/"+new Date(t.original.auditDetails.createdTime).getFullYear())}},{Header:s("ES_INBOX_VEHICLE_NO"),disableSortBy:!0,accessor:function(e){var t;return null===(t=e.vehicle)||void 0===t?void 0:t.registrationNumber}},{Header:s("ES_INBOX_DSO_NAME"),disableSortBy:!0,accessor:function(e){return e.dsoName?e.dsoName+" - "+e.tripOwner.name:""+e.tripOwner.name}},{Header:s("ES_INBOX_VEHICLE_STATUS"),disableSortBy:!0,accessor:function(e){return e.status}},{Header:s("ES_INBOX_WASTE_COLLECTED"),disableSortBy:!0,accessor:function(e){var t;return null===(t=e.tripDetails[0])||void 0===t?void 0:t.volume}}];default:return[{Header:s("CS_FILE_DESLUDGING_APPLICATION_NO"),Cell:function(t){var n=t.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:e.parentRoute+"/"+(d?"dso-application-details":"application-details")+"/"+n.original.applicationNo},n.original.applicationNo)))}},{Header:s("ES_INBOX_APPLICATION_DATE"),accessor:"createdTime",Cell:function(e){var t=e.row;return v(t.original.createdTime.getDate()+"/"+(t.original.createdTime.getMonth()+1)+"/"+t.original.createdTime.getFullYear())}},{Header:s("ES_INBOX_LOCALITY"),Cell:function(e){var t=e.row;return v(s(Digit.Utils.locale.getRevenueLocalityCode(t.original.locality,t.original.tenantId)))}},{Header:s("ES_INBOX_STATUS"),Cell:function(e){return v(s("CS_COMMON_FSM_"+e.row.original.status))}},{Header:s("ES_INBOX_SLA_DAYS_REMAINING"),Cell:function(e){var t;return"-"===(t=e.row.original.sla)?i.createElement("span",{className:"sla-cell-success"},"-"):isNaN(t)?i.createElement("span",{className:"sla-cell-success"},"0"):i.createElement("span",t<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},t)}}]}},[e.fstprequest,e.data]);return e.isLoading?c=i.createElement(t.Loader,null):e.isSearch&&!e.shouldSearch||0===(null==e||null===(n=e.data)||void 0===n||null===(a=n.table)||void 0===a?void 0:a.length)?c=i.createElement(t.Card,{style:{marginTop:20}},s("CS_MYAPPLICATIONS_NO_APPLICATION").split("\\n").map(function(e,t){return i.createElement("p",{key:t,style:{textAlign:"center"}},e)})):(null==e||null===(o=e.data)||void 0===o||null===(u=o.table)||void 0===u?void 0:u.length)>0&&(c=i.createElement(w,{t:s,data:e.data.table,columns:f,getCellProps:function(e){return{style:{minWidth:e.column.Header===s("ES_INBOX_APPLICATION_NO")?"240px":"",padding:"20px 18px",fontSize:"16px"}}},onPageSizeChange:e.onPageSizeChange,currentPage:e.currentPage,onNextPage:e.onNextPage,onPrevPage:e.onPrevPage,pageSizeLimit:e.pageSizeLimit,onSort:e.onSort,disableSort:e.disableSort,sortParams:e.sortParams,totalRecords:e.totalRecords,isPaginationRequired:e.isPaginationRequired})),i.createElement("div",{className:"inbox-container"},"FSM_EMP_FSTPO"!==e.userRole&&!e.isSearch&&i.createElement("div",{className:"filters-container"},"FSM_EMP_FSTPO_REQUEST"!==e.userRole?i.createElement(k,{parentRoute:e.parentRoute}):null,i.createElement("div",{style:"FSM_EMP_FSTPO_REQUEST"!==e.userRole?{marginTop:"24px"}:{}},i.createElement(U,{searchParams:e.searchParams,paginationParms:e.paginationParms,applications:e.data,onFilterChange:e.onFilterChange,type:"desktop"}))),i.createElement("div",{style:{flex:1,marginLeft:"24px"}},i.createElement(Y,{onSearch:e.onSearch,type:"desktop",searchFields:e.searchFields,isInboxPage:!(null!=e&&e.isSearch),searchParams:e.searchParams}),i.createElement("div",{className:"result",style:{marginLeft:m||null!=e&&e.isSearch?"":"24px",flex:1}},c)))},z=function(e){var r=l.useTranslation().t,a=n.useState(function(){var t,n;return null!==(t=e.sortParams)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.desc?{code:"DESC",name:r("ES_INBOX_DATE_LATEST_FIRST")}:{code:"ASC",name:r("ES_INBOX_DATE_LATEST_LAST")}})[0];function o(){}return i.createElement(i.Fragment,null,i.createElement("div",{className:"filter"},i.createElement("div",{className:"filter-card"},i.createElement("div",{className:"heading"},i.createElement("div",{className:"filter-label"},r("SORT_BY"),":"),i.createElement("div",{className:"clearAll",onClick:o},r("ES_COMMON_CLEAR_ALL")),"desktop"===e.type&&i.createElement("span",{className:"clear-search",onClick:o},r("ES_COMMON_CLEAR_ALL")),"mobile"===e.type&&i.createElement("span",{onClick:e.onClose},i.createElement(t.CloseSvg,null))),i.createElement("div",null,i.createElement(t.RadioButtons,{onSelect:function(t){e.onSort([{id:"createdTime",desc:"DESC"===t.code}]),e.onClose()},selectedOption:a,optionsKey:"name",options:[{code:"DESC",name:r("ES_INBOX_DATE_LATEST_FIRST")},{code:"ASC",name:r("ES_INBOX_DATE_LATEST_LAST")}]})))))},W=function(e){var l,r=e.t,a=e.data,o=e.onFilterChange,u=e.onSearch,s=e.onSort,d=e.serviceRequestIdKey,v=e.isFstpOperator,m=e.isLoading,f=e.isSearch,p=e.searchParams,E=e.searchFields,_=e.sortParams,S=e.linkPrefix,g=e.removeParam,y=e.filterData,h=n.useState(f?"SEARCH":""),T=h[0],I=h[1],D=n.useState(!!f),C=D[0],N=D[1],A=n.useState(p),O=A[0],L=A[1],R=n.useState(_)[1],M=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId()),b=Digit.Hooks.fsm.useMDMS(M,"DIGIT-UI","RoleStatusMapping"),P=b.data,F=b.isFetched,k=Digit.UserService.getUser().info.roles.map(function(e){return e.code}),w=null==P?void 0:P.filter(function(e){return k.filter(function(t){return t===e.userRole})[0]}),x=null==w?void 0:w.reduce(function(e,t){return{fixed:(null==t?void 0:t.fixed)&&(null==e?void 0:e.fixed),statuses:[].concat(null==e?void 0:e.statuses,null==t?void 0:t.statuses).filter(function(e,t,n){return n.indexOf(e)==t}),zeroCheck:(null==t?void 0:t.zeroCheck)||(null==e?void 0:e.zeroCheck)}},{statuses:[]});n.useEffect(function(){T&&N(!0)},[T]);var H,V=Digit.UserService.hasAccess(["FSM_DSO"])||!1,B=function(){N(!1),I(""),L(p),R(_)};return m||!F?i.createElement(t.Loader,null):(a&&0!==(null==a?void 0:a.length)?a&&(null==a?void 0:a.length)>0&&(H=i.createElement(t.DetailsCard,{data:a,serviceRequestIdKey:d,linkPrefix:S||(V?"/digit-ui/employee/fsm/application-details/":"/digit-ui/employee/fsm/")})):H=i.createElement(t.Card,{style:{marginTop:20}},r("CS_MYAPPLICATIONS_NO_APPLICATION").split("\\n").map(function(e,t){return i.createElement("p",{key:t,style:{textAlign:"center"}},e)})),i.createElement(i.Fragment,null,i.createElement("div",{className:"searchBox"},u&&i.createElement(t.SearchAction,{text:"SEARCH",handleActionClick:function(){I("SEARCH"),N(!0)}}),!f&&o&&(!V&&!v&&p||(null==x||null===(l=x.statuses)||void 0===l?void 0:l.length)>0)&&i.createElement(t.FilterAction,{text:"FILTER",handleActionClick:function(){I("FILTER"),N(!0)}}),!f&&i.createElement(t.FilterAction,{text:"SORT",handleActionClick:function(){I("SORT"),N(!0)}})),H,C&&i.createElement(t.PopUp,null,"FILTER"===T&&i.createElement("div",{className:"popup-module"},i.createElement(U,{onFilterChange:function(e){L(function(t){return c({},t,e)})},onClose:B,onSearch:function(e){o(c({},O,e)),I(""),N(!1)},applications:y,type:"mobile",searchParams:O,removeParam:g})),"SORT"===T&&i.createElement("div",{className:"popup-module"},i.createElement(z,{type:"mobile",sortParams:_,onClose:B,onSort:s})),"SEARCH"===T&&i.createElement("div",{className:"popup-module"},i.createElement(Y,{type:"mobile",onClose:B,onSearch:u,isFstpOperator:v,searchParams:p,searchFields:E})))))},j=function(e){return i.createElement("span",{className:"sla-cell"},e)},K=function(e){var t,n,r=e.data,a=e.vehicleLog,o=e.isLoading,u=e.isSearch,c=e.onSearch,s=e.onFilterChange,d=e.onSort,v=e.searchParams,m=e.searchFields,f=e.linkPrefix,p=e.removeParam,E=e.sortParams,_=e.fstprequest,S=e.isFSMRequest,g=l.useTranslation().t,y=(Digit.UserService.hasAccess(["FSM_DSO"]),Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1),h=null==a?void 0:a.map(function(e){var t,n,i;return(i={})[g("ES_INBOX_APPLICATION_NO")]=null==e?void 0:e.tripDetails.map(function(e){return e.referenceNo}),i[g("ES_INBOX_VEHICLE_LOG")]=null==e?void 0:e.applicationNo,i[g("ES_INBOX_VEHICLE_NO")]=null==e||null===(t=e.vehicle)||void 0===t?void 0:t.registrationNumber,i[g("ES_INBOX_DSO_NAME")]=null==e?void 0:e.tripOwner.displayName,i[g("ES_INBOX_VEHICLE_STATUS")]=null==e?void 0:e.status,i[g("ES_INBOX_WASTE_COLLECTED")]=null==e||null===(n=e.tripDetails[0])||void 0===n?void 0:n.volume,i}),T=null==_?void 0:_.map(function(e){var t,n,i,l,r,o=null==a?void 0:a.find(function(t){var n;return(null==t||null===(n=t.tripDetails[0])||void 0===n?void 0:n.referenceNo)===(null==e?void 0:e.applicationNo)});return(r={})[g("ES_INBOX_VEHICLE_LOG")]=(null==o?void 0:o.applicationNo)||"N/A",r[g("CS_COMMON_CITIZEN_NAME")]=(null==e||null===(t=e.citizen)||void 0===t?void 0:t.name)||"N/A",r[g("CS_COMMON_CITIZEN_NUMBER")]=(null==e||null===(n=e.citizen)||void 0===n?void 0:n.mobileNumber)||"N/A",r[g("ES_INBOX_LOCALITY")]=(null==e||null===(i=e.address)||void 0===i||null===(l=i.locality)||void 0===l?void 0:l.name)||"N/A",r});return i.createElement("div",{style:{padding:0}},i.createElement("div",{className:"inbox-container"},i.createElement("div",{className:"filters-container"},i.createElement("div",{style:{display:"none"}},!u&&i.createElement(U,{searchParams:v,applications:r,onFilterChange:s,type:"mobile"})),i.createElement(W,{t:g,filterData:r,data:r?u?null==r||null===(t=r.table)||void 0===t?void 0:t.map(function(e){var t,n=e.applicationNo,i=e.applicationStatus,l=e.propertyUsage,r=e.tenantId,a=e.address,o=e.citizen;return(t={})[g("ES_INBOX_APPLICATION_NO")]=n,t[g("ES_APPLICATION_DETAILS_APPLICANT_NAME")]=j((null==o?void 0:o.name)||""),t[g("ES_APPLICATION_DETAILS_APPLICANT_MOBILE_NO")]=j((null==o?void 0:o.mobileNumber)||""),t[g("ES_APPLICATION_DETAILS_PROPERTY_TYPE")]=j(g("PROPERTYTYPE_MASTERS_"+l.split(".")[0])),t[g("ES_APPLICATION_DETAILS_PROPERTY_SUB-TYPE")]=j(g("PROPERTYTYPE_MASTERS_"+l)),t[g("ES_INBOX_LOCALITY")]=j(g(Digit.Utils.locale.getRevenueLocalityCode(a.locality.code,r))),t[g("ES_INBOX_STATUS")]=j(g("CS_COMMON_FSM_"+i)),t}):null==r||null===(n=r.table)||void 0===n?void 0:n.map(function(e){var t,n,l=e.locality,r=e.applicationNo,a=e.createdTime,o=e.tenantId,u=e.status,c=e.sla;return(t={})[g("ES_INBOX_APPLICATION_NO")]=r,t[g("ES_INBOX_APPLICATION_DATE")]=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),t[g("ES_INBOX_LOCALITY")]=j(g(Digit.Utils.locale.getRevenueLocalityCode(l,o))),t[g("ES_INBOX_STATUS")]=j(g("CS_COMMON_"+u)),t[g("ES_INBOX_SLA_DAYS_REMAINING")]=(n=c,isNaN(n)?i.createElement("span",{className:"sla-cell-success"},"0"):i.createElement("span",n<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},n)),t}):y&&S?T:h,onFilterChange:!(!S&&y)&&s,serviceRequestIdKey:g(y?"ES_INBOX_VEHICLE_LOG":"ES_INBOX_APPLICATION_NO"),isFstpOperator:y,isLoading:o,isSearch:u,onSearch:c,onSort:d,searchParams:v,searchFields:m,linkPrefix:f,removeParam:p,sortParams:E}))))},X={select:function(e){return{totalCount:null==e?void 0:e.totalCount,vehicleLog:null==e?void 0:e.vehicleTrip.map(function(e){var t=e.tripOwner,n=c({},t,{displayName:t.name+(t.userName?"- "+t.userName:"")});return c({},e,{tripOwner:n})})}}},q=function(){var e,a,o,u=r.useHistory(),c=l.useTranslation().t,s=r.useLocation().pathname.split("/").at(-1),d=Digit.ULBService.getCurrentTenantId(),v=n.useState({applicationStatus:"WAITING_FOR_DISPOSAL"})[0],m=n.useState(null),f=m[0],p=m[1],E=n.useState(),_=E[0],S=E[1],g=n.useState([{id:"applicationNo",desc:!0}]),y=g[0],h=g[1],T=n.useState(0),I=T[0],D=T[1],C=n.useState(100),N=C[0],A=C[1],O=n.useState(!1),L=O[0],R=O[1],M=n.useState(null),b=M[0],P=M[1],F=(Digit.UserService.getUser(),window.Digit.Utils.browser.isMobile()),k=Digit.Hooks.fsm.useVehiclesSearch({tenantId:d,filters:{registrationNumber:s},config:{enabled:(null==s?void 0:s.length)>0}}),w=k.isLoading,x=k.data,H={businessService:"FSM_VEHICLE_TRIP",vehicleIds:void 0!==x&&(null==x||null===(e=x.vehicle[0])||void 0===e?void 0:e.id.length)>0&&(null==x||null===(a=x.vehicle[0])||void 0===a?void 0:a.id)||"null",applicationStatus:null==v?void 0:v.applicationStatus,sortOrder:!1===(null===(o=y[0])||void 0===o?void 0:o.desc)?"ASC":"DESC"},V=Digit.Hooks.fsm.useVehicleSearch({tenantId:d,filters:H,config:X,options:{searchWithDSO:!0}}),U=V.isLoading,B=V.data,Y=void 0===B?{}:B,z=Y.totalCount,W=Y.vehicleLog,j=V.isSuccess,q=Digit.Hooks.fsm.useSearchAll(d,f,null,{enabled:!!L}),Z=q.isLoading,Q=q.isIdle,$=q.data,J=(void 0===$?{}:$).data,ee=(void 0===J?{}:J).table;n.useEffect(function(){var e,t=null==W?void 0:W.map(function(e){var t;return null==e||null===(t=e.tripDetails[0])||void 0===t?void 0:t.referenceNo}).join(",");p({applicationNos:t||"null",sortOrder:!1===(null===(e=y[0])||void 0===e?void 0:e.desc)?"ASC":"DESC"}),R(!0)},[j,Z,w,W,Q,U,y,x]),n.useEffect(function(){ee&&P(ee)},[ee,Z,Q]),null==W||W.map(function(e){});var te=function(e){var t,n,i;void 0===e&&(e={});var l=(null===(t=e)||void 0===t||null===(n=t.applicationNos)||void 0===n?void 0:n.length)>0?null===(i=e)||void 0===i?void 0:i.applicationNos:null,r=ee.filter(l?function(e){return e.applicationNo===l}:function(e){return e.applicationNo});P(r)},ne=function(e){var t=ee.filter(function(t){var n,i,l,r,a;return null==t||null===(n=t.address)||void 0===n||null===(i=n.locality)||void 0===i?void 0:i.name.includes(null!=e&&null!==(l=e.locality)&&void 0!==l&&null!==(r=l[0])&&void 0!==r&&r.name?null==e||null===(a=e.locality)||void 0===a?void 0:a[0].name:"")});P(t),S(e)},ie=[{label:c("ES_SEARCH_APPLICATION_APPLICATION_NO"),name:"applicationNos"}],le=n.useCallback(function(e){0!==(null==e?void 0:e.length)&&h(e)},[]);if(U&&!j&&Z&&w&&!Q&&!L)return i.createElement(t.Loader,null);0!==(null==W?void 0:W.length)||0!==(null==ee?void 0:ee.length)||!j||Z||0!==(null==b?void 0:b.length)||w||u.push("/digit-ui/employee/fsm/fstp/new-vehicle-entry/"+s);var re=[];return null==b||b.map(function(e){re.push(null==W?void 0:W.find(function(t){var n;return(null==t||null===(n=t.tripDetails[0])||void 0===n?void 0:n.referenceNo)===(null==e?void 0:e.applicationNo)}))}),F?i.createElement("div",null,i.createElement(t.Header,null,c("ES_FSM_FSTP_SERVICE_REQUEST")),i.createElement(K,{onFilterChange:ne,vehicleLog:W,fstprequest:b,isFSMRequest:!0,isLoading:U,userRole:"FSM_EMP_FSTPO",linkPrefix:"/digit-ui/employee/fsm/fstp-operator-details/",onSearch:te,searchFields:ie,onSort:le,sortParams:y}),i.createElement("span",{className:"link",style:{margin:"8px"}},i.createElement(r.Link,{to:{pathname:"/digit-ui/employee/fsm/fstp/new-vehicle-entry/"}},c("ES_FSM_FSTP_NEW_ENTRY")))):i.createElement("div",null,i.createElement(t.Header,null,c("ES_FSM_FSTP_SERVICE_REQUEST")),i.createElement(G,{data:{table:re},fstprequest:ee,isLoading:U,onSort:le,isFSMRequest:!0,disableSort:!1,sortParams:y,userRole:"FSM_EMP_FSTPO_REQUEST",onFilterChange:ne,searchFields:ie,onSearch:te,onNextPage:function(){D(function(e){return e+N})},onPrevPage:function(){D(function(e){return e-N})},currentPage:Math.floor(I/N),pageSizeLimit:N,onPageSizeChange:function(e){A(Number(e.target.value))},totalRecords:z||0,isPaginationRequired:!1,searchParams:_}),i.createElement("span",{className:"link",style:{margin:"294px",padding:"2px"}},i.createElement(r.Link,{to:{pathname:"/digit-ui/employee/fsm/fstp/new-vehicle-entry/"}},c("ES_FSM_FSTP_NEW_ENTRY"))))},Z=function(e){var a=e.path,o=e.url,u=e.userType,s=l.useTranslation().t,d=r.useLocation();Digit.UserService.hasAccess(["FSM_DSO"]),Digit.UserService.hasAccess("FSM_COLLECTOR"),Digit.UserService.hasAccess("FSM_ADMIN"),Digit.UserService.hasAccess("FSM_EDITOR_EMP"),Digit.UserService.hasAccess("FSM_CREATOR_EMP"),n.useEffect(function(){var e,t,n;null!=d&&null!==(e=d.pathname)&&void 0!==e&&e.includes("application-details")||(null!=d&&null!==(t=d.pathname)&&void 0!==t&&t.includes("inbox")?null!=d&&null!==(n=d.pathname)&&void 0!==n&&n.includes("search")||Digit.SessionStorage.del("fsm/search/searchParams"):Digit.SessionStorage.del("fsm/inbox/searchParams"))},[d]);var v=Digit.ComponentRegistryService.getComponent("FSMEmpInbox"),m=Digit.ComponentRegistryService.getComponent("FSMFstpInbox"),f=Digit.ComponentRegistryService.getComponent("FSMNewApplicationEmp"),p=Digit.ComponentRegistryService.getComponent("FSMEditApplication"),E=Digit.ComponentRegistryService.getComponent("FSMEmployeeApplicationDetails"),_=Digit.ComponentRegistryService.getComponent("FSMFstpOperatorDetails"),S=Digit.ComponentRegistryService.getComponent("FSMResponse"),g=Digit.ComponentRegistryService.getComponent("FSMApplicationAudit"),y=Digit.ComponentRegistryService.getComponent("FSMRateView"),h=Digit.ComponentRegistryService.getComponent("FSMLinks"),T=Digit.UserService.hasAccess(["FSM_EMP_FSTPO"]),I=Digit.ComponentRegistryService.getComponent("FSMRegistry"),D=Digit.ComponentRegistryService.getComponent("VendorDetails"),C=Digit.ComponentRegistryService.getComponent("AddVendor"),N=Digit.ComponentRegistryService.getComponent("EditVendor"),A=Digit.ComponentRegistryService.getComponent("VehicleDetails"),O=Digit.ComponentRegistryService.getComponent("AddVehicle"),L=Digit.ComponentRegistryService.getComponent("EditVehicle"),R=Digit.ComponentRegistryService.getComponent("DriverDetails"),M=Digit.ComponentRegistryService.getComponent("AddDriver"),b=Digit.ComponentRegistryService.getComponent("EditDriver"),k=Digit.ComponentRegistryService.getComponent("FsmBreadCrumb"),w=window.location.href.includes("/employee/fsm/inbox")||window.location.href.includes("/employee/fsm/registry")||window.location.href.includes("/employee/fsm/application-details/"),x=window.location.href.includes("/employee/fsm/new-application")||window.location.href.includes("/employee/fsm/modify-application");return i.createElement(r.Switch,null,i.createElement(i.Fragment,null,i.createElement("div",{className:"ground-container"},T?i.createElement(t.BackButton,{isCommonPTPropertyScreen:!!d.pathname.includes("new"),getBackPageNumber:d.pathname.includes("new")?function(){return-2}:null},s("CS_COMMON_BACK")):i.createElement("div",{style:w?{marginLeft:"-4px"}:x?{marginLeft:"12px"}:{marginLeft:"20px"}},i.createElement(k,{location:d})),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/",component:function(){return i.createElement(h,{matchPath:a,userType:u})}}),i.createElement(t.PrivateRoute,{path:a+"/inbox",component:function(){return i.createElement(v,{parentRoute:a,isInbox:!0})}}),i.createElement(t.PrivateRoute,{path:a+"/fstp-inbox",component:function(){return i.createElement(m,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/new-application",component:function(){return i.createElement(f,{parentUrl:o})}}),i.createElement(t.PrivateRoute,{path:a+"/modify-application/:id",component:function(){return i.createElement(p,null)}}),i.createElement(t.PrivateRoute,{path:a+"/application-details/:id",component:function(){return i.createElement(E,{parentRoute:a,userType:"EMPLOYEE"})}}),i.createElement(t.PrivateRoute,{path:a+"/fstp-operator-details/:id",component:_}),i.createElement(t.PrivateRoute,{path:a+"/response",component:function(e){return i.createElement(S,c({},e,{parentRoute:a}))}}),i.createElement(t.PrivateRoute,{path:a+"/application-audit/:id",component:function(){return i.createElement(g,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/search",component:function(){return i.createElement(v,{parentRoute:a,isSearch:!0})}}),i.createElement(t.PrivateRoute,{path:a+"/rate-view/:id",component:function(){return i.createElement(y,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/mark-for-disposal",component:function(){return i.createElement("div",null)}}),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/registry",component:function(){return i.createElement(I,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/vendor-details/:id",component:function(){return i.createElement(D,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/new-vendor",component:function(){return i.createElement(C,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/modify-vendor/:id",component:function(){return i.createElement(N,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/vehicle-details/:id",component:function(){return i.createElement(A,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/new-vehicle",component:function(){return i.createElement(O,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/modify-vehicle/:id",component:function(){return i.createElement(L,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/driver-details/:id",component:function(){return i.createElement(R,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/new-driver",component:function(){return i.createElement(M,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{path:a+"/registry/modify-driver/:id",component:function(){return i.createElement(b,{parentRoute:a})}}),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/fstp-operations",component:function(){return i.createElement(F,null)}}),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/fstp-add-vehicle",component:function(){return i.createElement(P,null)}}),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/fstp-fsm-request/:id",component:function(){return i.createElement(q,null)}}),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/fstp/new-vehicle-entry",component:_}),i.createElement(t.PrivateRoute,{exact:!0,path:a+"/fstp/new-vehicle-entry/:id",component:_}))))};function Q(e,t,n){return null==e?void 0:e.filter(function(e){var t;return null===(t=e.vehicles)||void 0===t?void 0:t.find(function(e){return(null==e?void 0:e.capacity)==n})})}function $(e,t,n){return null==e?void 0:e.filter(function(e){var t;return null===(t=e.vehicles)||void 0===t?void 0:t.find(function(e){return(null==e?void 0:e.capacity)==n})})}var J=function(e){var n=e.t,l=e.rejectMenu,r=e.setReason,a=e.reason,o=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+o,submit:"CS_COMMON_"+o,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:n("ES_FSM_ACTION_"+o.toUpperCase()+"_REASON"),type:"dropdown",populators:i.createElement(t.Dropdown,{t:n,option:l,id:"reason",optionKey:"i18nKey",selected:a,select:r}),isMandatory:!0},{label:n("ES_FSM_ACTION_COMMENTS"),type:"textarea",populators:{name:"comments"}}]}]}},ee=function(e,t){var n=(null==e?void 0:e.defaultValues)||1;return i.createElement(i.Fragment,null,i.createElement("div",{className:"PlusMinus"},i.createElement("button",{type:"button",onClick:function(){e.onSelect(n>1?n-=1:n=1)},className:"PlusMinusbutton"},"-"),i.createElement("input",{readOnly:!0,value:n,style:{textAlign:"center",border:"1px solid #505A5F"}}),i.createElement("button",{type:"button",onClick:function(){e.onSelect(n>=1?n+=1:n=1)},className:"PlusMinusbutton"},"+")))},te=function(e){return i.createElement("h1",{className:"heading-m"},e.label)},ne=function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},i.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),i.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}))},ie=function(e){return i.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},i.createElement(ne,null))},le={boxShadow:"0 -2px 8px rgb(0 0 0 / 16%)",maxWidth:"480px",zIndex:"100",left:"0",bottom:"0",width:"100%",backgroundColor:"rgba(255, 255, 255)",padding:"8px",position:"fixed",textAlign:"right",display:"flex",justifyContent:"space-around"},re=function(e){var l=e.t,r=e.action,a=e.tenantId,u=e.id,s=e.closeModal,d=e.submitAction,v=e.actionData,m=e.module,f=!!Digit.Utils.browser.isMobile(),p=Digit.Hooks.fsm.useDsoSearch(a,{limit:"-1",status:"ACTIVE"}),E=p.data,_=p.isLoading,S=p.isSuccess,g=Digit.Hooks.fsm.useSearch(a,{applicationNos:u},{staleTime:Infinity,select:function(e){var t=e.additionalDetails;return c({},e,{additionalDetails:t=function e(t){return"object"==typeof t?t:e(JSON.parse(t))}(t)})}}),y=g.isSuccess,h=g.data,T=(o.useQueryClient(),Digit.ULBService.getStateId()),I=Digit.Hooks.fsm.useMDMS(T,"FSM","ReceivedPaymentType"),D=I.data,C=I.isLoading,N=Digit.Hooks.fsm.useMDMS(T,"Vehicle","VehicleType",{staleTime:Infinity}),A=N.data,O=N.isSuccess,L=Digit.Hooks.fsm.useMDMS(T,"FSM","PropertyType",{staleTime:Infinity}),R=L.data,M=L.isSuccess,b=Digit.Hooks.fsm.useMDMS(T,"FSM","PropertySubtype",{staleTime:Infinity}),P=b.data,F=b.isSuccess,k=Digit.Hooks.fsm.useMDMS(T,"FSM","PitType",{staleTime:Infinity}),w=k.data,x=k.isSuccess,H=Digit.Hooks.fsm.useMDMS(T,"FSM","Reason",{staleTime:Infinity},["ReassignReason","RejectionReason","DeclineReason","CancelReason"]),V=H.data,U=H.isLoading,B=Digit.Hooks.fsm.useMDMS(T,"Vehicle","FSTPORejectionReason",{staleTime:Infinity}).data,Y=n.useState([])[1],G=n.useState([]),z=G[0],W=G[1],j=n.useState({}),K=j[0],X=j[1],q=n.useState(null),Z=q[0],ne=q[1],re=n.useState(null),ae=re[0],oe=re[1],ue=n.useState([]),ce=ue[0],se=ue[1],de=n.useState(null),ve=de[0],me=de[1],fe=n.useState(null),pe=fe[0],Ee=fe[1],_e=n.useState(null),Se=_e[0],ge=_e[1],ye=n.useState(null),he=ye[0],Te=ye[1],Ie=n.useState(null),De=Ie[0],Ce=Ie[1],Ne=n.useState(!1),Ae=Ne[0],Oe=Ne[1],Le=n.useState(null)[1],Re=n.useState([])[1],Me=n.useState(null)[1],be=n.useState(null)[1],Pe=(n.useState(null),n.useState()),Fe=Pe[0],ke=Pe[1],we=n.useState()[1],xe=n.useState(),He=xe[0],Ve=xe[1],Ue=n.useState(null)[1],Be=n.useState(null)[1],Ye=n.useState({capacity:null==ve?void 0:ve.capacity,wasteCollected:null==ve?void 0:ve.capacity,propertyType:null==h?void 0:h.propertyUsage.split(".")[0],subtype:null==h?void 0:h.propertyUsage,pitType:null==h?void 0:h.sanitationtype,pitDetail:null==h?void 0:h.pitDetail}),Ge=Ye[0],ze=Ye[1];function We(e){ne(e)}function je(e){oe(e)}function Ke(e){me(e),ze({capacity:null==e?void 0:e.capacity,wasteCollected:null==e?void 0:e.capacity})}function Xe(e){Ve(e)}function qe(e,t,n){t.comments=n.comments?e.code+"~"+n.comments:e.code}return n.useEffect(function(){C||Be(D)},[C,D]),n.useEffect(function(){if(y&&O&&h){var e=A.filter(function(e){return e.code===h.vehicleType})[0],t=Ge;t.capacity=null==h?void 0:h.vehicleCapacity,t.wasteCollected=null==h?void 0:h.vehicleCapacity,se([e]),me(e),ze(t)}},[O,y]),n.useEffect(function(){if(y&&M&&h){var e=R.filter(function(e){return e.code===h.propertyUsage.split(".")[0]})[0],t=Ge;t.propertyType=e,Re([e]),Le(e),ze(t)}},[M,y]),n.useEffect(function(){if(y&&F&&h){var e=P.filter(function(e){return e.code===h.propertyUsage})[0],t=Ge;t.subtype=e,Me(e),ze(t)}},[F,y]),n.useEffect(function(){if(y&&x&&h){var e=w.filter(function(e){return e.code===h.sanitationtype})[0],t=h.pitDetail,n=Ge;n.pitType=e,n.pitDetail=t,be(e),we(h.pitDetail),ze(n)}},[x,y]),n.useEffect(function(){if(ve&&S){var e=E.filter(function(e){var t;return null==e||null===(t=e.vehicles)||void 0===t?void 0:t.find(function(e){return e.type===ve.code})});Y(e)}},[ve,S]),n.useEffect(function(){if(y&&S&&h&&h.dsoId){var e,t=E.filter(function(e){return e.id===h.dsoId})[0],n=null==t||null===(e=t.vehicles)||void 0===e?void 0:e.filter(function(e){return e.capacity==(null==h?void 0:h.vehicleCapacity)});W(n)}},[y,S]),n.useEffect(function(){var e,t;pe||v&&v[0]&&(null===(e=v[0].comment)||void 0===e?void 0:e.length)>0&&"DSO_REJECTED"===(null===(t=v[0])||void 0===t?void 0:t.status)?Oe(!0):Oe(!1)},[pe]),n.useEffect(function(){Oe(!!Se)},[Se]),n.useEffect(function(){Oe(!!he)},[he]),n.useEffect(function(){Oe(!!De)},[De]),n.useEffect(function(){var e,n,a,o,u,s;switch(r){case"UPDATE":return Oe(!0),X(function(e){var t=e.t,n=e.noOfTrips,l=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+l,submit:"CS_COMMON_"+l,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:t("ES_FSM_ACTION_NUMBER_OF_TRIPS"),isMandatory:!0,type:"custom",populators:{name:"noOfTrips",error:t("ES_NEW_APPLICATION_NO_OF_TRIPS_INVALID"),validation:{required:!0},defaultValue:n,rules:{required:!0},customProps:{isMandatory:!0,optionsKey:"i18nKey",innerStyles:{minWidth:"33%"}},component:function(e,t){return i.createElement(ee,c({defaultValues:e.value},t,{onSelect:function(t){e.onChange(t)}}))}}}]}]}}({t:l,noOfTrips:null==h?void 0:h.noOfTrips,action:r}));case"DSO_ACCEPT":case"ACCEPT":return Oe(!!ae),X(function(e){var n=e.t,l=e.selectVehicleNo,r=e.vehicleNoList,a=e.vehicleNo,o=e.noOfTrips,u=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+u,submit:"CS_COMMON_"+u,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:n("ES_FSM_ACTION_VEHICLE_REGISTRATION_NO"),isMandatory:!0,type:"dropdown",populators:i.createElement(i.Fragment,null,null!=r&&r.length?null:i.createElement(t.CardLabelError,null,n("ES_FSM_NO_VEHICLE_AVAILABLE")),i.createElement(t.Dropdown,{option:r,autoComplete:"off",optionKey:"registrationNumber",id:"vehicle",select:l,selected:a,disable:!((null==r?void 0:r.length)>0)}))},{label:n("ES_FSM_ACTION_VEHICLE_CAPACITY_IN_LTRS"),isMandatory:!0,type:"text",populators:{name:"capacity",validation:{required:!0}},disable:!0},{label:n("ES_FSM_ACTION_NUMBER_OF_TRIPS"),isMandatory:!0,type:"text",populators:{name:"noOfTrips",validation:{required:!0},defaultValue:o},disable:!0}]}]}}({t:l,dsoData:E,dso:Z,vehicle:ve,vehicleCapacity:null==h?void 0:h.vehicleCapacity,noOfTrips:null==h?void 0:h.noOfTrips,vehicleNo:ae,vehicleNoList:z,selectVehicleNo:je,action:r}));case"ASSIGN":case"GENERATE_DEMAND":case"FSM_GENERATE_DEMAND":return Oe(!!Z),X(function(e){var n=e.t,l=e.dsoData,r=e.dso,a=e.selectDSO,o=e.vehicleCapacity,u=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+u,submit:"CS_COMMON_"+u,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:n("ES_FSM_ACTION_DSO_NAME"),isMandatory:!0,type:"dropdown",populators:i.createElement(i.Fragment,null,Q(l,0,o)&&!Q(l,0,o).length?i.createElement(t.CardLabelError,null,n("ES_COMMON_NO_DSO_AVAILABLE_WITH_SUCH_VEHICLE")):null,i.createElement(t.Dropdown,{option:Q(l,0,o),autoComplete:"off",optionKey:"displayName",id:"dso",selected:r,select:a,disable:!(!Q(l,0,o)||Q(l,0,o).length)}))},{label:n("ES_FSM_ACTION_VEHICLE_CAPACITY_IN_LTRS"),isMandatory:!0,type:"text",populators:{name:"capacity",validation:{required:!0}},disable:!0},{label:n("ES_FSM_ACTION_SERVICE_DATE"),isMandatory:!0,type:"custom",populators:{name:"date",validation:{required:!0},customProps:{min:Digit.Utils.date.getDate()},defaultValue:Digit.Utils.date.getDate(),component:function(e,n){return i.createElement(t.DatePicker,c({onChange:e.onChange,date:e.value},n))}}}]}]}}({t:l,dsoData:E,dso:Z,selectDSO:We,vehicleMenu:ce,vehicle:ve,vehicleCapacity:null==h?void 0:h.vehicleCapacity,selectVehicle:Ke,action:r}));case"REASSIGN":case"REASSING":case"FSM_REASSING":return Z&&(pe||v&&v[0]&&(null===(e=v[0].comment)||void 0===e?void 0:e.length)>0&&"DSO_REJECTED"===(null===(n=v[0])||void 0===n?void 0:n.status))?Oe(!0):Oe(!1),X(function(e){var n=e.t,l=e.dsoData,r=e.dso,a=e.selectDSO,o=e.vehicleCapacity,u=e.reassignReasonMenu,s=e.reassignReason,d=e.selectReassignReason,v=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+v,submit:"CS_COMMON_"+v,cancel:"CS_COMMON_CLOSE"},form:[{body:[].concat(e.showReassignReason?[{label:n("ES_FSM_ACTION_REASSIGN_REASON"),type:"dropdown",isMandatory:!0,populators:i.createElement(t.Dropdown,{option:u,optionKey:"i18nKey",id:"reassign-reason",selected:s,select:d,t:n})}]:[],[{label:n("ES_FSM_ACTION_DSO_NAME"),isMandatory:!0,type:"dropdown",populators:i.createElement(i.Fragment,null,$(l,0,o)&&!$(l,0,o).length?i.createElement(t.CardLabelError,null,n("ES_COMMON_NO_DSO_AVAILABLE_WITH_SUCH_VEHICLE")):null,i.createElement(t.Dropdown,{option:$(l,0,o),autoComplete:"off",optionKey:"displayName",id:"dso",selected:r,select:a}))},{label:n("ES_FSM_ACTION_VEHICLE_CAPACITY_IN_LTRS"),type:"text",populators:{name:"capacity",validation:{required:!0}},disable:!0},{label:n("ES_FSM_ACTION_SERVICE_DATE"),isMandatory:!0,type:"custom",populators:{name:"date",validation:{required:!0},customProps:{min:Digit.Utils.date.getDate()},defaultValue:Digit.Utils.date.getDate(),component:function(e,n){return i.createElement(t.DatePicker,c({onChange:e.onChange,date:e.value},n))}}}])}]}}({t:l,dsoData:E,dso:Z,selectDSO:We,vehicleMenu:ce,vehicle:ve,vehicleCapacity:null==h?void 0:h.vehicleCapacity,selectVehicle:Ke,reassignReasonMenu:null==V?void 0:V.ReassignReason,reassignReason:pe,selectReassignReason:Ee,action:r,showReassignReason:!(v&&v[0]&&(null===(a=v[0].comment)||void 0===a?void 0:a.length)>0&&"DSO_REJECTED"===(null===(o=v[0])||void 0===o?void 0:o.status))}));case"COMPLETE":case"COMPLETED":return Oe(!0),X(function(e){var n=e.t,l=e.vehicleCapacity,r=e.noOfTrips,a=e.applicationCreatedTime,o=void 0===a?0:a,u=e.receivedPaymentType,s=e.action,d=e.module;return{label:{heading:"ES_FSM_ACTION_TITLE_"+s,submit:"CS_COMMON_"+s,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:n("ES_FSM_ACTION_DESLUGED_DATE_LABEL"),isMandatory:!0,type:"custom",populators:{name:"desluged",validation:{required:!0},defaultValue:Digit.Utils.date.getDate(),customProps:{min:Digit.Utils.date.getDate(o),max:Digit.Utils.date.getDate()},component:function(e,n){return i.createElement(t.DatePicker,c({disabled:!0,onChange:e.onChange,date:e.value},n))}}},{label:n("ES_FSM_ACTION_WASTE_VOLUME_LABEL"),type:"number",isMandatory:!0,populators:{name:"wasteCollected",validation:{required:!0,validate:function(e){return parseInt(e)<=parseInt(l)}},error:n("ES_FSM_ACTION_INVALID_WASTE_VOLUME")+" "+l+" "+n("CS_COMMON_LITRES")}},{label:"ES_NEW_APPLICATION_PROPERTY_TYPE",isMandatory:!0,type:"component",route:"property-type",key:"propertyType",component:"SelectPropertyType",disable:!0,texts:{headerCaption:"",header:"CS_FILE_APPLICATION_PROPERTY_LABEL",cardText:"CS_FILE_APPLICATION_PROPERTY_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"property-subtype"},{label:"ES_NEW_APPLICATION_PROPERTY_SUB-TYPE",isMandatory:!0,type:"component",route:"property-subtype",key:"subtype",component:"SelectPropertySubtype",disable:!0,texts:{headerCaption:"",header:"CS_FILE_APPLICATION_PROPERTY_SUBTYPE_LABEL",cardText:"CS_FILE_APPLICATION_PROPERTY_SUBTYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"map"},{label:"ES_NEW_APPLICATION_PIT_TYPE",isMandatory:!1,type:"component",route:"pit-type",key:"pitType",component:"SelectPitType",texts:{header:"CS_FILE_PROPERTY_PIT_TYPE",cardText:"CS_FILE_PROPERTY_PIT_TYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},nextStep:"tank-size"},{label:"ES_NEW_APPLICATION_PIT_DIMENSION",isMandatory:!1,type:"component",route:"tank-size",key:"pitDetail",component:"SelectTankSize",texts:{headerCaption:"",header:"CS_FILE_APPLICATION_PIT_SEPTIC_TANK_SIZE_TITLE",cardText:"CS_FILE_APPLICATION_PIT_SEPTIC_TANK_SIZE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:null},{label:n("ES_NEW_APPLICATION_PAYMENT_NO_OF_TRIPS")+" *",type:"number",populators:{name:"noOfTrips",error:n("ES_NEW_APPLICATION_NO_OF_TRIPS_INVALID"),validation:{required:!0},defaultValue:r},disable:!0},"FSM_ZERO_PAY_SERVICE"!==d&&{label:"FSM_PAYMENT_RECEIVED",isMandatory:!0,type:"custom",populators:{name:"paymentMode",error:n("ES_NEW_APPLICATION_NO_OF_TRIPS_INVALID"),validation:{required:!0},rules:{required:!0},customProps:{isMandatory:!0,options:u,optionsKey:"i18nKey",innerStyles:{minWidth:"33%"}},component:function(e,n){return i.createElement(t.RadioButtons,c({selectedOption:e.value,onSelect:function(t){e.onChange(t)}},n))}}}]}]}}({t:l,vehicle:ve,vehicleCapacity:null==h?void 0:h.vehicleCapacity,noOfTrips:null==h?void 0:h.noOfTrips,applicationCreatedTime:null==h||null===(u=h.auditDetails)||void 0===u?void 0:u.createdTime,receivedPaymentType:D,action:r,module:m}));case"SUBMIT":case"FSM_SUBMIT":return history.push("/digit-ui/employee/fsm/modify-application/"+applicationNumber);case"DECLINE":case"DSO_REJECT":return Oe(!!he),X(J({t:l,rejectMenu:null==V?void 0:V.DeclineReason,setTrips:Ue,trips:null==h?void 0:h.noOfTrips,setReason:Te,action:r}));case"REJECT":case"SENDBACK":return Oe(!!Se),X(J({t:l,rejectMenu:null==V?void 0:V.RejectionReason,setReason:ge,reason:Se,action:r}));case"CANCEL":return Oe(!!De),X(J({t:l,rejectMenu:null==V?void 0:V.CancelReason,setReason:Ce,reason:De,action:r}));case"SCHEDULE":case"ES_FSM_SCHEDULE":return Oe(!0),X(function(e){var n=e.t,l=e.applicationCreatedTime,r=void 0===l?0:l,a=e.vehicleCapacity,o=e.noOfTrips,u=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+u,submit:"CS_COMMON_"+u,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:n("ES_FSM_ACTION_DESLUDGING_ON"),isMandatory:!0,type:"custom",populators:{name:"desluged",validation:{required:!0},defaultValue:Digit.Utils.date.getDate(),customProps:{min:Digit.Utils.date.getDate(r),max:Digit.Utils.date.getDate()},component:function(e,n){return i.createElement(t.DatePicker,c({onChange:e.onChange,date:e.value},n))}}},{label:n("ES_FSM_ACTION_WASTE_VOLUME_LABEL"),type:"number",isMandatory:!0,disable:!0,populators:{name:"wasteCollected",validation:{required:!0,validate:function(e){return parseInt(e)<=parseInt(a)}},error:n("ES_FSM_ACTION_INVALID_WASTE_VOLUME")+" "+a+" "+n("CS_COMMON_LITRES")}},{label:n("ES_NEW_APPLICATION_PAYMENT_NO_OF_TRIPS"),type:"number",populators:{name:"noOfTrips",error:n("ES_NEW_APPLICATION_NO_OF_TRIPS_INVALID"),validation:{required:!0},defaultValue:o}}]}]}}({t:l,rejectMenu:null==V?void 0:V.DeclineReason,setReason:Te,reason:he,applicationCreatedTime:null==h||null===(s=h.auditDetails)||void 0===s?void 0:s.createdTime,vehicle:ve,vehicleCapacity:null==h?void 0:h.vehicleCapacity,action:r,noOfTrips:null==h?void 0:h.noOfTrips}));case"PAY":case"ADDITIONAL_PAY_REQUEST":case"FSM_PAY":return history.push("/digit-ui/employee/payment/collect/FSM.TRIP_CHARGES/"+applicationNumber);case"DECLINEVEHICLE":return Oe(!!He),X(function(e){var n=e.t,l=e.rejectMenu,r=e.selectReason,a=e.reason,o=e.action;return{label:{heading:"ES_FSM_ACTION_TITLE_"+o,submit:"CS_COMMON_"+o,cancel:"CS_COMMON_CLOSE"},form:[{body:[{label:n("ES_FSM_ACTION_DECLINE_REASON"),isMandatory:!0,type:"dropdown",populators:i.createElement(t.Dropdown,{option:l,autoComplete:"off",optionKey:"i18nKey",id:"Reason",select:r,selected:a,t:n})},"OTHERS"===(null==a?void 0:a.code)?{label:n("Comments"),isMandatory:!0,type:"text",populators:{name:"comments",validation:{required:!0}}}:{}]}]}}({t:l,rejectMenu:B,selectReason:Xe,reason:He,action:r}))}},[r,pe,_,Z,ce,Se,ae,z,V,He]),i.useRef(null),r&&K.form&&!_&&!U&&O?i.createElement(t.Modal,{popupStyles:f?{height:"fit-content",minHeight:"100vh"}:{height:"fit-content"},headerBarMain:i.createElement(te,{label:l(K.label.heading)}),headerBarEnd:i.createElement(ie,{onClick:s}),actionCancelLabel:l(K.label.cancel),actionCancelOnSubmit:s,actionSaveLabel:l(K.label.submit),actionSaveOnSubmit:function(){},formId:"modal-action",isDisabled:!Ae,popupModuleMianStyles:f?{paddingBottom:"60px"}:{},popupModuleActionBarStyles:f?le:{}},i.createElement(t.FormComposer,{config:K.form,noBoxShadow:!0,inline:!0,childrenAtTheBottom:!0,onSubmit:function(e){var t={action:r};Z&&(h.dsoId=Z.id),ae&&"ACCEPT"===r&&(h.vehicleId=ae.id),ae&&"DSO_ACCEPT"===r&&(h.vehicleId=ae.id),ve&&"ASSIGN"===r&&(h.vehicleType=ve.code),e.date&&(h.possibleServiceDate=new Date(""+e.date).getTime()),e.desluged&&(h.completedOn=new Date(e.desluged).getTime()),e.wasteCollected&&(h.wasteCollected=e.wasteCollected),e.pitDetail&&(h.pitDetail.height=Number(e.pitDetail.height)),e.pitDetail&&(h.pitDetail.width=Number(e.pitDetail.width)),e.pitDetail&&(h.pitDetail.diameter=Number(e.pitDetail.diameter)),e.pitDetail&&(h.pitDetail.length=Number(e.pitDetail.length)),e.pitType&&(h.sanitationtype=e.pitType.code),e.subtype&&"object"==typeof e.subtype&&(h.propertyUsage=e.subtype.code),e.subtype&&"string"==typeof e.subtype&&(h.propertyUsage=e.subtype),e.noOfTrips&&(h.noOfTrips=e.noOfTrips),e.paymentMode&&(h.additionalDetails.receivedPayment=e.paymentMode.code),Fe&&(h.pitDetail.additionalDetails&&h.pitDetail.additionalDetails.fileStoreId?h.pitDetail.additionalDetails.fileStoreId=c({},h.pitDetail.additionalDetails.fileStoreId,{FSM_DSO:Fe}):h.pitDetail.additionalDetails={fileStoreId:{FSM_DSO:Fe}}),e.noOfTrips&&(h.noOfTrips=Number(e.noOfTrips)),"REASSING"===r&&(h.vehicleId=null),pe&&qe(pe,t,e),Se&&qe(Se,t,e),he&&qe(he,t,e),De&&qe(De,t,e),He&&e.comments&&(t.comments=e.comments),He&&(t.fstpoRejectionReason=null==He?void 0:He.code),d({fsm:h,workflow:t})},formId:"modal-action",defaultValues:Ge}),"COMPLETED"===r?i.createElement(t.UploadPitPhoto,{header:"",tenantId:a,cardText:"",onPhotoChange:function(e){(!Fe||Fe.length<4)&&ke(e)},uploadedImages:null}):null):i.createElement(t.Loader,null)},ae=function(e){var t=n.useState(null),l=t[0],r=t[1],a=n.useState(e.fileStoreIds),o=a[0],u=a[1];n.useEffect(function(){u(e.fileStoreIds)},[e.fileStoreIds]),n.useEffect(function(){!function(){try{var e=function(){if(null!==o)return Promise.resolve(c()).then(function(){})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[o]);var c=n.useCallback(function(){try{var t=function(){if(null!==o&&o.length>0)return Promise.resolve(Digit.UploadServices.Filefetch(o,e.tenantId)).then(function(e){!function(e){var t=Object.keys(e.data),n=t.findIndex(function(e){return"fileStoreIds"===e});n>-1&&t.splice(n,1);var i=t.map(function(t){return{image:e.data[t].split(",")[2],key:t,fullImage:Digit.Utils.getFileUrl(e.data[t])}});r([].concat([],i))}(e)})}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},[o]);return i.createElement(i.Fragment,null,i.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},null==l?void 0:l.map(function(t,n){return i.createElement("div",{key:n,style:{minWidth:"160px",marginRight:"8px",marginBottom:"8px",maxWidth:"200px"}},i.createElement("img",{src:t.image,alt:"uploaded thumbnail",onClick:function(){return e.onClick(t.fullImage,n)}}))})))},oe=function(e){return"lbd"===e},ue=function(e){var a=e.applicationData,o=e.channelMenu,u=e.sanitationMenu,s=l.useTranslation().t,d=r.useHistory(),v=n.useState(!1),m=v[0],f=v[1],p=Digit.ULBService.getStateId(),E=Digit.Hooks.fsm.useMDMS(p,"FSM","CommonFieldsConfig"),_=E.data,S=E.isLoading,g=Digit.Hooks.fsm.useMDMS(p,"FSM","PreFieldsConfig"),y=g.data,h=g.isLoading,T=Digit.Hooks.fsm.useMDMS(p,"FSM","PostFieldsConfig").isLoading,I=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],D=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],C=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2];n.useEffect(function(){I(!1),C(),D()},[]);var N={channel:o.filter(function(e){return e.code===a.source})[0],applicationData:{applicantName:a.citizen.name,mobileNumber:a.citizen.mobileNumber,applicantGender:a.citizen.gender},tripData:{noOfTrips:a.noOfTrips,amountPerTrip:a.additionalDetails.tripAmount,amount:a.noOfTrips*a.additionalDetails.tripAmount||void 0,vehicleType:{capacity:null==a?void 0:a.vehicleCapacity},vehicleCapacity:null==a?void 0:a.vehicleCapacity},propertyType:a.propertyUsage.split(".")[0],subtype:a.propertyUsage,address:{pincode:a.address.pincode,locality:c({},a.address.locality,{i18nkey:a.tenantId.toUpperCase().split(".").join("_")+"_REVENUE_"+a.address.locality.code}),slum:a.address.slumName,street:a.address.street,doorNo:a.address.doorNo,landmark:a.address.landmark},pitType:u.filter(function(e){return e.code===a.sanitationtype})[0],pitDetail:a.pitDetail,paymentPreference:a.paymentPreference,advancepaymentPreference:{advanceAmount:null==a?void 0:a.advanceAmount}};if(S||T||h)return i.createElement(t.Loader,null);var A=[].concat(y,_);return i.createElement(n.Fragment,null,i.createElement("div",{style:{marginLeft:"15px"}},i.createElement(t.Header,null,s("ES_TITLE_MODIFY_DESULDGING_APPLICATION"))),i.createElement(t.FormComposer,{isDisabled:!m,label:s("CREATED"!=(null==a?void 0:a.applicationStatus)?"ES_FSM_APPLICATION_SCHEDULE":"ES_FSM_APPLICATION_UPDATE"),config:A.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},formCardStyle:!0,onSubmit:function(e){var t,n,i,l,r,o,u,s,v,m,f,p,E,_,S,g,y,h,T,I,D,C,N=e.channel,A=null==e||null===(t=e.pitType)||void 0===t?void 0:t.code,O=null==e?void 0:e.pitDetail,L=null==e||null===(n=e.address)||void 0===n?void 0:n.pincode,R=null==e||null===(i=e.address)||void 0===i||null===(l=i.street)||void 0===l?void 0:l.trim(),M=null==e||null===(r=e.address)||void 0===r||null===(o=r.doorNo)||void 0===o?void 0:o.trim(),b=null==e||null===(u=e.address)||void 0===u?void 0:u.slum,P=null==e||null===(s=e.address)||void 0===s||null===(v=s.landmark)||void 0===v?void 0:v.trim(),F=e.tripData.noOfTrips,k=e.tripData.amountPerTrip,w=null==e||null===(m=e.address)||void 0===m||null===(f=m.city)||void 0===f?void 0:f.code,x=null==e||null===(p=e.address)||void 0===p||null===(E=p.locality)||void 0===E?void 0:E.code,H=null==e||null===(_=e.address)||void 0===_||null===(S=_.locality)||void 0===S?void 0:S.name,V=null==e?void 0:e.subtype,U=0===k?null:null==e||null===(g=e.advancepaymentPreference)||void 0===g?void 0:g.advanceAmount,B=O.height,Y=O.length,G=O.width,z=O.diameter,W=c({},a,{sanitationtype:A,source:N.code,additionalDetails:c({},a.additionalDetails,{tripAmount:k}),propertyUsage:V,vehicleType:e.tripData.vehicleType.type,vehicleCapacity:null==e||null===(y=e.tripData)||void 0===y||null===(h=y.vehicleType)||void 0===h?void 0:h.capacity,noOfTrips:F,pitDetail:c({},a.pitDetail,{distanceFromRoad:e.distanceFromRoad,height:B,length:Y,width:G,diameter:z}),address:c({},a.address,{tenantId:w,landmark:P,doorNo:M,street:R,pincode:L,slumName:b,locality:c({},a.address.locality,{code:x,name:H}),geoLocation:c({},a.address.geoLocation,{latitude:null!=e&&null!==(T=e.address)&&void 0!==T&&T.latitude?null==e||null===(I=e.address)||void 0===I?void 0:I.latitude:a.address.geoLocation.latitude,longitude:null!=e&&null!==(D=e.address)&&void 0!==D&&D.longitude?null==e||null===(C=e.address)||void 0===C?void 0:C.longitude:a.address.geoLocation.longitude})}),advanceAmount:U});delete W.responseInfo,window.Digit.SessionStorage.set("propertyType",null),window.Digit.SessionStorage.set("subType",null),Digit.SessionStorage.set("city_property",null),Digit.SessionStorage.set("selected_localities",null),Digit.SessionStorage.set("locality_property",null),d.replace("/digit-ui/employee/fsm/response",{applicationData:W,key:"update",action:"CREATED"===(null==a?void 0:a.applicationStatus)?"SUBMIT":"SCHEDULE"})},defaultValues:N,onFormValueChange:function(e,t){var n,i,l,r,o;if(null!=t&&t.propertyType&&null!=t&&t.subtype&&null!=t&&null!==(n=t.address)&&void 0!==n&&null!==(i=n.locality)&&void 0!==i&&i.code&&null!=t&&null!==(l=t.tripData)&&void 0!==l&&l.vehicleType&&(null!=t&&null!==(r=t.tripData)&&void 0!==r&&r.amountPerTrip||0===(null==t||null===(o=t.tripData)||void 0===o?void 0:o.amountPerTrip))){var u,c,s,d,v;f(!0);var m,p,E=null!=t&&t.pitDetail?Object.values(null==t?void 0:t.pitDetail).filter(function(e){return e>0}):null,_=Digit.SessionStorage.get("advance_amount");null!=t&&t.pitType&&(null===E||0===(null==E?void 0:E.length)||oe(null==t||null===(m=t.pitType)||void 0===m?void 0:m.dimension)&&(null==E?void 0:E.length)>=3||!oe(null==t||null===(p=t.pitType)||void 0===p?void 0:p.dimension)&&(null==E?void 0:E.length)>=2?f(!0):f(!1)),0!==(null==t||null===(u=t.tripData)||void 0===u?void 0:u.amountPerTrip)&&((null==t||null===(c=t.advancepaymentPreference)||void 0===c?void 0:c.advanceAmount)>(null==t||null===(s=t.tripData)||void 0===s?void 0:s.amount)||(null==t||null===(d=t.advancepaymentPreference)||void 0===d?void 0:d.advanceAmount)<_)&&f(!1),(null==a?void 0:a.advanceAmount)>0&&(null==t||null===(v=t.advancepaymentPreference)||void 0===v?void 0:v.advanceAmount)<=0&&f(!1)}else f(!1)},noBreakLine:!0,fms_inline:!0}))},ce={select:function(e){return{totalCount:null==e?void 0:e.totalCount,vehicleLog:null==e?void 0:e.vehicleTrip.map(function(e){var t=e.tripOwner,n=c({},t,{displayName:t.name+(t.userName?"- "+t.userName:"")});return c({},e,{tripOwner:n})})}}},se=function(e){var t=e.value,n=e.onChange;return i.createElement(u,{name:e.name,onChange:n,onBlur:function(){var e=null==t?void 0:t.split(":"),i=null==e?void 0:e[1];n(t);for(var l,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,void 0):void 0}}(e))){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(document.getElementsByClassName("react-time-picker__inputGroup__minute"));!(l=r()).done;){var a=l.value,o=a.value;a.value=Number(o)<60?o:i}},value:t,locale:"en-US",disableClock:!1,clearIcon:null,format:"h:mm a"})},de={select:function(e){return e.vehicleTrip[0]}},ve={select:function(e){return e.vehicleTrip}},me=function(e){return"lbd"===e},fe=function(e,t,n,i,l,r){var a,o,u=0===(null==r||null===(a=r.additionalDetails)||void 0===a?void 0:a.tripAmount)||null===(null==r||null===(o=r.additionalDetails)||void 0===o?void 0:o.tripAmount)||!1;return l((i?"E":"C")+"S_FSM_RESPONSE_"+(t||"CREATE")+"_"+e+(n?"":"_ERROR")+(t?"":0===(null==r?void 0:r.advanceAmount)?"_POST_PAY":u?"_ZERO_PAY":""))},pe=function(e,t,n,i){return fe("ACTION",e,t,n,i)},Ee=function(e){var n,l,r,a,o,u=null!=e&&e.action?e.action:"CREATE",c=(o=(null===(n=e.data)||void 0===n||null===(l=n.fsm)||void 0===l?void 0:l[0].applicationStatus)||e.action,fe("LABEL",o,e.isSuccess,e.isEmployee,e.t));return e.errorInfo&&null!==e.errorInfo&&""!==e.errorInfo&&"string"==typeof e.errorInfo&&"SCHEDULE"!==e.action&&(c=e.errorInfo),i.createElement(t.Banner,{message:pe(u||e.action,e.isSuccess,e.isEmployee,e.t),applicationNumber:null===(r=e.data)||void 0===r||null===(a=r.fsm)||void 0===a?void 0:a[0].applicationNo,info:c,successful:e.isSuccess})},_e=function(e){var o=e.onSearch,u=e.type,s=e.onClose,d=e.onTabChange,v=e.searchFields,m=e.searchParams,f=e.isInboxPage,p=e.selectedTab,E=f?Digit.SessionStorage.get("fsm/inbox/searchParams"):Digit.SessionStorage.get("fsm/search/searchParams"),_=Digit.Hooks.fsm.useApplicationStatus(),S=_.data,g=_.isFetched,y=l.useTranslation().t,h=r.useHistory(),T=a.useForm({defaultValues:E||m}),I=T.register,D=T.handleSubmit,C=T.reset,N=T.watch,A=T.control,O=n.useState(!1)[0],L=n.useState(!1),R=L[0],M=L[1],b=innerWidth<=640,P=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1;function F(){var e=v.reduce(function(e,t){var n;return c({},e,((n={})[null==t?void 0:t.name]="",n))},{});C(e),f?Digit.SessionStorage.del("fsm/inbox/searchParams"):Digit.SessionStorage.del("fsm/search/searchParams"),o({})}N(["applicationNos","mobileNumber"]);var k=function(e){return null};return i.createElement(i.Fragment,null,i.createElement("div",{className:"search-container",style:{width:"auto"}},i.createElement("div",{className:"search-complaint-container"},("mobile"===u||b)&&i.createElement("div",{className:"complaint-header"},i.createElement("h2",null,y("ES_COMMON_SEARCH_BY")),i.createElement("span",{style:{position:"absolute",top:"2%",right:"8px"},onClick:s},i.createElement(t.CloseSvg,null))),i.createElement("div",{className:"search-tabs-container"},i.createElement("div",null,i.createElement("button",{className:"VENDOR"===p?"search-tab-head-selected":"search-tab-head",onClick:function(){F(),d("VENDOR")}},y("ES_FSM_REGISTRY_INBOX_TAB_VENDOR")),i.createElement("button",{className:"VEHICLE"===p?"search-tab-head-selected":"search-tab-head",onClick:function(){F(),d("VEHICLE")}},y("ES_FSM_REGISTRY_INBOX_TAB_VEHICLE")),i.createElement("button",{className:"DRIVER"===p?"search-tab-head-selected":"search-tab-head",onClick:function(){F(),d("DRIVER")}},y("ES_FSM_REGISTRY_INBOX_TAB_DRIVER"))),i.createElement("div",{className:"action-bar-wrap-registry"},i.createElement("div",{className:"search-add",onClick:function(){M(!R)}},y("ES_FSM_REGISTRY_INBOX_HEADER_ADD"),i.createElement("div",{className:"search-add-icon"},i.createElement(t.AddIcon,{className:""}))),R&&i.createElement(t.Menu,{localeKeyPrefix:"ES_FSM_ACTION_CREATE",options:["VENDOR","DRIVER","VEHICLE"],t:y,onSelect:function(e){switch(e){case"VENDOR":return h.push("/digit-ui/employee/fsm/registry/new-vendor");case"VEHICLE":return h.push("/digit-ui/employee/fsm/registry/new-vehicle");case"DRIVER":return h.push("/digit-ui/employee/fsm/registry/new-driver")}}}))),i.createElement("form",{onSubmit:D(function(e){e.mobileNumber||delete e.mobileNumber,o(e),"mobile"===u&&s()})},i.createElement("div",{className:P?"complaint-input-container for-pt for-search":"complaint-input-container",style:{width:"100%",gridTemplateColumns:"33.33% 66.66% 0%"}},null==v?void 0:v.map(function(e,n){return i.createElement("span",{key:n,className:0===n?"complaint-input":"mobile-input"},i.createElement(t.Label,null,e.label),function(e){switch(e.type){case"date":return i.createElement(a.Controller,{render:function(e){return i.createElement(t.DatePicker,{date:e.value,onChange:e.onChange})},name:e.name,control:A,defaultValue:null});case"status":return i.createElement(a.Controller,{render:function(e){return i.createElement(B,{onAssignmentChange:e.onChange,value:e.value,applicationStatuses:S,areApplicationStatus:g})},name:e.name,control:A,defaultValue:null});default:return i.createElement(t.TextInput,c({},e,{inputRef:I},I(e.name,{validate:k}),{watch:N,shouldUpdate:!0}))}}(e)," ")}),i.createElement("div",{style:{display:"flex"}},"desktop"===u&&!b&&i.createElement(t.SubmitBar,{className:"submit-bar-search",label:y("ES_COMMON_SEARCH"),submit:!0}),"desktop"===u&&!b&&i.createElement("span",{className:"clear-search"},i.createElement(t.LinkLabel,{style:c({},{marginTop:"40px",marginLeft:"16px"}),onClick:F},y("ES_COMMON_CLEAR_SEARCH"))))),O?i.createElement(t.CardLabelError,{className:"search-error-label"},y("ES_SEARCH_APPLICATION_ERROR")):null))))},Se=function(e){var a=Digit.ULBService.getCurrentTenantId(),u=l.useTranslation().t,s=r.useHistory(),d=(Digit.UserService.hasAccess(["FSM_DSO"]),function(e){return i.createElement("span",{className:"cell-text"},e)}),v=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1,m=n.useState([]),f=m[0],p=m[1],E=n.useState(null),_=E[0],S=E[1],g=n.useState([]),y=g[0],h=g[1],T=o.useQueryClient(),I=Digit.Hooks.fsm.useDsoSearch(a,{sortBy:"name",sortOrder:"ASC",status:"ACTIVE"},{enabled:!1}),D=I.data,C=I.refetch,N=Digit.Hooks.fsm.useVendorUpdate(a).mutate,A=Digit.Hooks.fsm.useUpdateVehicle(a).mutate,O=Digit.Hooks.fsm.useDriverUpdate(a).mutate;n.useEffect(function(){var t;p((null==e||null===(t=e.data)||void 0===t?void 0:t.table)||[])},[e]),n.useEffect(function(){"DRIVER"!==e.selectedTab&&"VEHICLE"!==e.selectedTab||C()},[e.selectedTab]),n.useEffect(function(){if(D){var e=D.map(function(e){return e.dsoDetails});h(e)}},[D]);var L,R=function(){S(null)},M=function(e,t,n){p(function(i){return i.map(function(i,l){var r,a;return l==e.id&&e.id!==(null==i||null===(r=i.popup)||void 0===r?void 0:r.row)&&t.id!==(null==i||null===(a=i.popup)||void 0===a?void 0:a.column)&&n?c({},i,{popup:{row:e.id,column:t.id}}):c({},i,{popup:{}})})})},b=function(e,t,n){if("VEHICLE"===t)s.push("/digit-ui/employee/fsm/registry/vehicle-details/"+e);else{var i=n.find(function(t){return t.name===e});s.push("/digit-ui/employee/fsm/registry/driver-details/"+(null==i?void 0:i.id))}},P=i.useMemo(function(){switch(e.selectedTab){case"VENDOR":return[{Header:u("ES_FSM_REGISTRY_INBOX_VENDOR_NAME"),disableSortBy:!0,Cell:function(e){var t=e.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:"/digit-ui/employee/fsm/registry/vendor-details/"+t.original.id},i.createElement("div",null,t.original.name,i.createElement("br",null)))))}},{Header:u("ES_FSM_REGISTRY_INBOX_DATE_VENDOR_CREATION"),accessor:"createdTime",Cell:function(e){var t,n,i,l,r=e.row;return d(null!==(t=r.original)&&void 0!==t&&null!==(n=t.auditDetails)&&void 0!==n&&n.createdTime?Digit.DateUtils.ConvertEpochToDate(null===(i=r.original)||void 0===i||null===(l=i.auditDetails)||void 0===l?void 0:l.createdTime):"")}},{Header:u("ES_FSM_REGISTRY_INBOX_TOTAL_VEHICLES"),Cell:function(e){var n,l,r,a,o,u,c,s,d,v,m=e.row,f=e.column;return i.createElement("div",{className:"action-bar-wrap-registry",style:{position:"relative"}},i.createElement("div",{className:null!==(n=m.original)&&void 0!==n&&null!==(l=n.allVehicles)&&void 0!==l&&l.length?"link":"cell-text",style:{cursor:"pointer"},onClick:function(){var e,t;return M(m,f,null===(e=m.original)||void 0===e||null===(t=e.allVehicles)||void 0===t?void 0:t.length)}},(null===(r=m.original)||void 0===r||null===(a=r.allVehicles)||void 0===a?void 0:a.length)||0,i.createElement("br",null)),m.id===(null===(o=m.original)||void 0===o||null===(u=o.popup)||void 0===u?void 0:u.row)&&f.id===(null===(c=m.original)||void 0===c||null===(s=c.popup)||void 0===s?void 0:s.column)&&i.createElement(t.Menu,{localeKeyPrefix:"",options:null===(d=m.original)||void 0===d||null===(v=d.allVehicles)||void 0===v?void 0:v.map(function(e){return e.registrationNumber}),onSelect:function(e){return b(e,"VEHICLE")}}))}},{Header:u("ES_FSM_REGISTRY_INBOX_ACTIVE_VEHICLES"),disableSortBy:!0,Cell:function(e){var n,l,r,a,o,u,c,s,d,v,m=e.row,f=e.column;return i.createElement("div",{className:"action-bar-wrap-registry",style:{position:"relative"}},i.createElement("div",{className:null!==(n=m.original)&&void 0!==n&&null!==(l=n.vehicles)&&void 0!==l&&l.length?"link":"cell-text",style:{cursor:"pointer"},onClick:function(){var e,t;return M(m,f,null===(e=m.original)||void 0===e||null===(t=e.vehicles)||void 0===t?void 0:t.length)}},(null===(r=m.original)||void 0===r||null===(a=r.vehicles)||void 0===a?void 0:a.length)||0,i.createElement("br",null)),m.id===(null===(o=m.original)||void 0===o||null===(u=o.popup)||void 0===u?void 0:u.row)&&f.id===(null===(c=m.original)||void 0===c||null===(s=c.popup)||void 0===s?void 0:s.column)&&i.createElement(t.Menu,{localeKeyPrefix:"",options:null===(d=m.original)||void 0===d||null===(v=d.vehicles)||void 0===v?void 0:v.map(function(e){return e.registrationNumber}),onSelect:function(e){return b(e,"VEHICLE")}}))}},{Header:u("ES_FSM_REGISTRY_INBOX_TOTAL_DRIVERS"),disableSortBy:!0,Cell:function(e){var n,l,r,a,o,u,c,s,d,v,m=e.row,f=e.column;return i.createElement("div",{className:"action-bar-wrap-registry",style:{position:"relative"}},i.createElement("div",{className:null!==(n=m.original)&&void 0!==n&&null!==(l=n.drivers)&&void 0!==l&&l.length?"link":"cell-text",style:{cursor:"pointer"},onClick:function(){var e,t;return M(m,f,null===(e=m.original)||void 0===e||null===(t=e.drivers)||void 0===t?void 0:t.length)}},(null===(r=m.original)||void 0===r||null===(a=r.drivers)||void 0===a?void 0:a.length)||0,i.createElement("br",null)),m.id===(null===(o=m.original)||void 0===o||null===(u=o.popup)||void 0===u?void 0:u.row)&&f.id===(null===(c=m.original)||void 0===c||null===(s=c.popup)||void 0===s?void 0:s.column)&&i.createElement(t.Menu,{localeKeyPrefix:"",options:null===(d=m.original)||void 0===d||null===(v=d.drivers)||void 0===v?void 0:v.map(function(e){return e.name}),onSelect:function(e){var t;return b(e,"DRIVER",null===(t=m.original)||void 0===t?void 0:t.drivers)}}))}},{Header:u("ES_FSM_REGISTRY_INBOX_ACTIVE_DRIVERS"),disableSortBy:!0,Cell:function(e){var n,l,r,a,o,u,c,s,d,v,m=e.row,f=e.column;return i.createElement("div",{className:"action-bar-wrap-registry",style:{position:"relative"}},i.createElement("div",{className:null!==(n=m.original)&&void 0!==n&&null!==(l=n.activeDrivers)&&void 0!==l&&l.length?"link":"cell-text",style:{cursor:"pointer"},onClick:function(){var e,t;return M(m,f,null===(e=m.original)||void 0===e||null===(t=e.activeDrivers)||void 0===t?void 0:t.length)}},(null===(r=m.original)||void 0===r||null===(a=r.activeDrivers)||void 0===a?void 0:a.length)||0,i.createElement("br",null)),m.id===(null===(o=m.original)||void 0===o||null===(u=o.popup)||void 0===u?void 0:u.row)&&f.id===(null===(c=m.original)||void 0===c||null===(s=c.popup)||void 0===s?void 0:s.column)&&i.createElement(t.Menu,{localeKeyPrefix:"",options:null===(d=m.original)||void 0===d||null===(v=d.activeDrivers)||void 0===v?void 0:v.map(function(e){return e.name}),onSelect:function(e){var t;return b(e,"DRIVER",null===(t=m.original)||void 0===t?void 0:t.activeDrivers)}}))}},{Header:u("ES_FSM_REGISTRY_INBOX_ENABLED"),disableSortBy:!0,Cell:function(n){var l,r,a=n.row;return i.createElement(t.ToggleSwitch,{style:{display:"flex",justifyContent:"left"},value:"DISABLED"!==(null===(l=a.original)||void 0===l||null===(r=l.dsoDetails)||void 0===r?void 0:r.status),onChange:function(){return function(t){var n,i,l,r,a=t.original.dsoDetails,o={vendor:c({},a,{status:"ACTIVE"===(null==a?void 0:a.status)?"DISABLED":"ACTIVE",owner:c({},a.owner,{gender:(null==a||null===(n=a.owner)||void 0===n?void 0:n.gender)||"OTHER",dob:(null==a||null===(i=a.owner)||void 0===i?void 0:i.dob)||new Date("1/1/1970").getTime(),emailId:(null==a||null===(l=a.owner)||void 0===l?void 0:l.emailId)||"abc@egov.com",relationship:(null==a||null===(r=a.owner)||void 0===r?void 0:r.relationship)||"OTHER"})})};N(o,{onError:function(e,t){S({key:"error",action:e}),setTimeout(R,5e3)},onSuccess:function(t,n){S({key:"success",action:"VENDOR"}),T.invalidateQueries("DSO_SEARCH"),e.refetchData(),setTimeout(R,3e3)}})}(a)},name:"switch-"+a.id})}}];case"VEHICLE":return[{Header:u("ES_FSM_REGISTRY_INBOX_VEHICLE_NAME"),disableSortBy:!0,Cell:function(e){var t=e.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:"/digit-ui/employee/fsm/registry/vehicle-details/"+t.original.registrationNumber},i.createElement("div",null,t.original.registrationNumber,i.createElement("br",null)))))}},{Header:u("ES_FSM_REGISTRY_INBOX_DATE_VEHICLE_CREATION"),accessor:"createdTime",Cell:function(e){var t,n,i,l,r=e.row;return d(null!==(t=r.original)&&void 0!==t&&null!==(n=t.auditDetails)&&void 0!==n&&n.createdTime?Digit.DateUtils.ConvertEpochToDate(null===(i=r.original)||void 0===i||null===(l=i.auditDetails)||void 0===l?void 0:l.createdTime):"")}},{Header:u("ES_FSM_REGISTRY_INBOX_VENDOR_NAME"),disableSortBy:!0,Cell:function(e){var t,n;return d((null===(t=e.row.original)||void 0===t||null===(n=t.vendor)||void 0===n?void 0:n.name)||"NA")}},{Header:u("ES_FSM_REGISTRY_INBOX_ENABLED"),disableSortBy:!0,Cell:function(n){var l,r=n.row;return i.createElement(t.ToggleSwitch,{style:{display:"flex",justifyContent:"left"},value:"DISABLED"!==(null===(l=r.original)||void 0===l?void 0:l.status),onChange:function(){return function(t){var n=t.original;delete n.vendor;var i={vehicle:c({},n,{status:"ACTIVE"===(null==n?void 0:n.status)?"DISABLED":"ACTIVE"})};A(i,{onError:function(e,t){S({key:"error",action:e}),setTimeout(R,5e3)},onSuccess:function(t,n){S({key:"success",action:"VEHICLE"}),T.invalidateQueries("FSM_VEICLES_SEARCH"),e.refetchVendor(),e.refetchData(),setTimeout(R,3e3)}})}(r)},name:"switch-"+r.id})}}];case"DRIVER":return[{Header:u("ES_FSM_REGISTRY_INBOX_DRIVER_NAME"),disableSortBy:!0,accessor:"tripDetails",Cell:function(e){var t=e.row;return i.createElement("div",null,i.createElement("span",{className:"link"},i.createElement(r.Link,{to:"/digit-ui/employee/fsm/registry/driver-details/"+t.original.id},i.createElement("div",null,t.original.name,i.createElement("br",null)))))}},{Header:u("ES_FSM_REGISTRY_INBOX_DATE_DRIVER_CREATION"),accessor:"createdTime",Cell:function(e){var t,n,i,l,r=e.row;return d(null!==(t=r.original)&&void 0!==t&&null!==(n=t.auditDetails)&&void 0!==n&&n.createdTime?Digit.DateUtils.ConvertEpochToDate(null===(i=r.original)||void 0===i||null===(l=i.auditDetails)||void 0===l?void 0:l.createdTime):"")}},{Header:u("ES_FSM_REGISTRY_INBOX_VENDOR_NAME"),Cell:function(n){var l=n.row;return i.createElement(t.Dropdown,{className:"fsm-registry-dropdown",selected:l.original.vendor,option:y,select:function(t){return function(t,n){var i=t.original,l=t.original.dsoDetails,r=null==i?void 0:i.vendor,a=n;if(delete i.vendor,i.vendorDriverStatus="ACTIVE",r){var o=null==r?void 0:r.drivers;o.splice(o.findIndex(function(e){return e.id===i.id}),1),c({},l,{drivers:o})}var u={vendor:c({},a,{drivers:a.drivers?[].concat(a.drivers,[i]):[i]})};N(u,{onError:function(e,t){S({key:"error",action:e}),setTimeout(R,5e3)},onSuccess:function(t,n){S({key:"success",action:"VENDOR"}),T.invalidateQueries("DSO_SEARCH"),e.refetchData(),setTimeout(R,3e3)}})}(l,t)},optionKey:"name",t:u})}},{Header:u("ES_FSM_REGISTRY_INBOX_ENABLED"),disableSortBy:!0,Cell:function(n){var l,r=n.row;return i.createElement(t.ToggleSwitch,{style:{display:"flex",justifyContent:"left"},value:"DISABLED"!==(null===(l=r.original)||void 0===l?void 0:l.status),onChange:function(){return function(t){var n,i,l,r,a=t.original,o={driver:c({},a,{status:"ACTIVE"===(null==a?void 0:a.status)?"DISABLED":"ACTIVE",owner:c({},a.owner,{gender:(null==a||null===(n=a.owner)||void 0===n?void 0:n.gender)||"OTHER",dob:(null==a||null===(i=a.owner)||void 0===i?void 0:i.dob)||new Date("1/1/1970").getTime(),emailId:(null==a||null===(l=a.owner)||void 0===l?void 0:l.emailId)||"abc@egov.com",relationship:(null==a||null===(r=a.owner)||void 0===r?void 0:r.relationship)||"OTHER"})})};O(o,{onError:function(e,t){S({key:"error",action:e}),setTimeout(R,5e3)},onSuccess:function(t,n){S({key:"success",action:"DRIVER"}),T.invalidateQueries("FSM_DRIVER_SEARCH"),e.refetchVendor(),e.refetchData(),setTimeout(R,3e3)}})}(r)},name:"switch-"+r.id})}}];default:return[]}},[e.selectedTab,y]);if(e.isLoading)L=i.createElement(t.Loader,null);else if(0===f.length){var F="",x="";"VENDOR"===e.selectedTab?(F="ES_FSM_REGISTRY_EMPTY_CARD_VENDOR",x="ES_FSM_REGISTRY_EMPTY_BUTTON_VENDOR"):"VEHICLE"===e.selectedTab?(F="ES_FSM_REGISTRY_EMPTY_CARD_VEHICLE",x="ES_FSM_REGISTRY_EMPTY_BUTTON_VEHICLE"):(F="ES_FSM_REGISTRY_EMPTY_CARD_DRIVER",x="ES_FSM_REGISTRY_EMPTY_BUTTON_DRIVER"),L=i.createElement(t.Card,{style:{display:"flex",justifyContent:"center",minHeight:"250px"}},i.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},i.createElement("div",{style:{marginTop:"50px",marginBottom:"25px"}},u(F)),i.createElement(t.SubmitBar,{className:"",label:u(x),onSubmit:function(){switch(e.selectedTab){case"VENDOR":return s.push("/digit-ui/employee/fsm/registry/new-vendor");case"VEHICLE":return s.push("/digit-ui/employee/fsm/registry/new-vehicle");case"DRIVER":return s.push("/digit-ui/employee/fsm/registry/new-driver")}}})))}else f.length>0&&(L=i.createElement(w,{className:"table registryTable",t:u,data:f,columns:P,getCellProps:function(e){return{style:{minWidth:e.column.Header===u("ES_INBOX_APPLICATION_NO")?"240px":"",padding:e.column.Header===u("ES_FSM_REGISTRY_INBOX_VENDOR_NAME")?"10px 18px":"20px 18px",fontSize:"16px"}}},onPageSizeChange:e.onPageSizeChange,currentPage:e.currentPage,onNextPage:e.onNextPage,onPrevPage:e.onPrevPage,pageSizeLimit:e.pageSizeLimit,onSort:e.onSort,disableSort:e.disableSort,sortParams:e.sortParams,totalRecords:e.totalRecords}));return i.createElement("div",{className:"inbox-container"},"FSM_EMP_FSTPO"!==e.userRole&&"FSM_ADMIN"!==e.userRole&&!e.isSearch&&i.createElement("div",{className:"filters-container"},i.createElement(k,{parentRoute:e.parentRoute}),i.createElement("div",{style:{marginTop:"24px"}},i.createElement(U,{searchParams:e.searchParams,paginationParms:e.paginationParms,applications:e.data,onFilterChange:e.onFilterChange,type:"desktop"}))),i.createElement("div",{style:{flex:1,marginLeft:"FSM_ADMIN"===e.userRole?"":"24px"}},i.createElement(_e,{onSearch:e.onSearch,type:"desktop",searchFields:e.searchFields,isInboxPage:!(null!=e&&e.isSearch),searchParams:e.searchParams,onTabChange:e.onTabChange,selectedTab:e.selectedTab}),i.createElement("div",{className:"result",style:{marginLeft:v||"FSM_ADMIN"===e.userRole||null!=e&&e.isSearch?"":"24px",flex:1}},L)),_&&i.createElement(t.Toast,{error:"error"===_.key,label:u("success"===_.key?"ES_FSM_REGISTRY_"+_.action+"_DISABLE_SUCCESS":_.action),onClose:R}))},ge=function(e){return i.createElement("div",{className:"confirmation_box"},i.createElement("span",null,(0,e.t)(""+e.title)," "))},ye=function(e){return i.createElement("h1",{className:"heading-m"},e.label)},he=function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},i.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),i.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}))},Te=function(e){return i.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},i.createElement(he,null))},Ie=require("@egovernments/digit-ui-react-components").DatePicker,De=function(e,t){return void 0===t&&(t=!1),[{head:"ES_FSM_REGISTRY_NEW_VENDOR_DETAILS",body:[{label:"ES_FSM_REGISTRY_NEW_VENDOR_NAME",isMandatory:!0,type:"text",disable:t,populators:{name:"vendorName",validation:{required:!0,pattern:/^[A-Za-z]/},error:e("FSM_REGISTRY_INVALID_NAME"),defaultValue:"",className:"payment-form-text-input-correction"}}]},{head:"ES_FSM_REGISTRY_PERSONAL_DETAILS",body:[{label:"ES_FSM_REGISTRY_NEW_GENDER",isMandatory:!0,type:"component",route:"select-gender",hideInEmployee:!1,key:"selectGender",component:"SelectGender",disable:t,texts:{headerCaption:"",header:"CS_COMMON_CHOOSE_GENDER",cardText:"CS_COMMON_SELECT_GENDER",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"}},{label:e("ES_FSM_REGISTRY_NEW_DOB"),isMandatory:!1,type:"custom",key:"dob",populators:{name:"dob",validation:{required:!0},component:function(e,t){return i.createElement(Ie,c({onChange:e.onChange,date:e.value},t,{max:f((new Date).setFullYear((new Date).getFullYear()))}))}}},{label:"ES_FSM_REGISTRY_NEW_EMAIL",isMandatory:!1,type:"text",key:"emailId",populators:{name:"emailId",validation:{required:!1,pattern:/^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9.-]+$/},error:e("FSM_REGISTRY_INVALID_EMAIL"),defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_NEW_VENDOR_PHONE",isMandatory:!0,type:"mobileNumber",key:"phone",disable:t,populators:{name:"phone",validation:{required:!0,pattern:/^[6-9]\d{9}$/},labelStyle:{border:"1px solid black",borderRight:"none"},error:e("FSM_REGISTRY_INVALID_PHONE"),defaultValue:"",className:"payment-form-text-input-correction"}}]},{head:"ES_FSM_REGISTRY_NEW_ADDRESS_DETAILS",body:[{label:"ES_FSM_REGISTRY_NEW_DOOR",isMandatory:!1,type:"text",key:"doorNo",populators:{name:"doorNo",defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_NEW_PLOT",isMandatory:!1,type:"text",key:"plotNo",populators:{name:"plotNo",defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_NEW_BUILDING_NAME",isMandatory:!1,type:"text",key:"buildingName",populators:{name:"buildingName",defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_NEW_STREET",isMandatory:!1,type:"text",key:"street",populators:{name:"street",defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_NEW_PINCODE",isMandatory:!1,type:"text",key:"pincode",populators:{name:"pincode",validation:{required:!1,pattern:/^[1-9][0-9]{5}$/},error:e("FSM_REGISTRY_INVALID_PINCODE"),defaultValue:"",className:"payment-form-text-input-correction"}},{route:"address",component:"FSMSelectAddress",withoutLabel:!0,texts:{headerCaption:"CS_FILE_APPLICATION_PROPERTY_LOCATION_LABEL",header:"CS_FILE_APPLICATION_PROPERTY_LOCATION_ADDRESS_TEXT",cardText:"CS_FILE_APPLICATION_PROPERTY_LOCATION_CITY_MOHALLA_TEXT",submitBarLabel:"CS_COMMON_NEXT"},key:"address",isMandatory:!0,type:"component"},{label:"ES_FSM_REGISTRY_NEW_LANDMARK",isMandatory:!1,type:"text",key:"landmark",populators:{name:"landmark",defaultValue:"",className:"payment-form-text-input-correction"}}]},{head:"",body:[{label:"ES_FSM_REGISTRY_NEW_VENDOR_ADDITIONAL_DETAILS",isMandatory:!1,type:"textarea",key:"additionalDetails",populators:{name:"additionalDetails",className:"payment-form-text-input-correction"}}]}]},Ce=function(e){return i.createElement("h1",{className:"heading-m"},e.label)},Ne=function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},i.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),i.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}))},Ae=function(e){return i.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},i.createElement(Ne,null))},Oe=require("@egovernments/digit-ui-react-components").DatePicker,Le=function(e,t){return void 0===t&&(t=!1),[{head:"ES_FSM_REGISTRY_VEHICLE_DETAILS",body:[{label:"ES_FSM_REGISTRY_VEHICLE_NUMBER",isMandatory:!0,type:"text",disable:t,populators:{name:"registrationNumber",ValidationRequired:!0,validation:{pattern:"[A-Z]{2}\\s{1}[0-9]{2}\\s{0,1}[A-Z]{1,2}\\s{1}[0-9]{4}",title:e("ES_FSM_VEHICLE_FORMAT_TIP")},error:e("FSM_REGISTRY_INVALID_REGISTRATION_NUMBER"),defaultValue:"",className:"payment-form-text-input-correction"}},{route:"vehicle",component:"SelectVehicle",withoutLabel:!0,key:"vehicle",isMandatory:!0,type:"component"},{label:"ES_FSM_REGISTRY_VEHICLE_POLLUTION_CERT",isMandatory:!1,type:"custom",key:"pollutionCert",populators:{name:"pollutionCert",validation:{required:!0},component:function(e,t){return i.createElement(Oe,c({onChange:e.onChange,date:e.value},t))}}},{label:"ES_FSM_REGISTRY_VEHICLE_INSURANCE",isMandatory:!1,type:"custom",key:"insurance",populators:{name:"insurance",validation:{required:!0},component:function(e,t){return i.createElement(Oe,c({onChange:e.onChange,date:e.value},t))}}},{label:"ES_FSM_REGISTRY_VEHICLE_ROAD_TAX",isMandatory:!1,type:"custom",key:"roadTax",populators:{name:"roadTax",validation:{required:!0},component:function(e,t){return i.createElement(Oe,c({onChange:e.onChange,date:e.value},t))}}},{label:"ES_FSM_REGISTRY_NEW_FITNESS",isMandatory:!1,type:"custom",key:"fitnessValidity",populators:{name:"fitnessValidity",validation:{required:!0},component:function(e,t){return i.createElement(Oe,c({onChange:e.onChange,date:e.value},t))}}},{label:"ES_FSM_REGISTRY_NEW_VEHICLE_OWNER_NAME",isMandatory:!0,type:"text",disable:t,populators:{name:"ownerName",validation:{required:!0,pattern:/^[A-Za-z]/},error:e("FSM_REGISTRY_INVALID_NAME"),defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_NEW_VEHICLE_OWNER_PHONE",isMandatory:!0,type:"mobileNumber",key:"phone",disable:t,populators:{name:"phone",validation:{required:!0,pattern:/^[6-9]\d{9}$/},error:e("FSM_REGISTRY_INVALID_PHONE"),defaultValue:"",className:"payment-form-text-input-correction",labelStyle:{border:"1px solid black",borderRight:"none"}}},{label:"ES_FSM_REGISTRY_NEW_VENDOR_ADDITIONAL_DETAILS",isMandatory:!1,type:"textarea",key:"additionalDetails",populators:{name:"additionalDetails",className:"payment-form-text-input-correction"}}]}]},Re=function(e){return i.createElement("h1",{className:"heading-m"},e.label)},Me=function(){return i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},i.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),i.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"}))},be=function(e){return i.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},i.createElement(Me,null))},Pe=require("@egovernments/digit-ui-react-components").DatePicker,Fe=function(e,t){return void 0===t&&(t=!1),[{head:"ES_FSM_REGISTRY_DRIVER_DETAILS",body:[{label:"ES_FSM_REGISTRY_DRIVER_NAME",isMandatory:!0,type:"text",disable:t,populators:{name:"driverName",validation:{required:!0,pattern:/^[A-Za-z]/},error:e("FSM_REGISTRY_INVALID_NAME"),defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_DRIVER_LICENSE",isMandatory:!0,type:"text",key:"license",populators:{name:"license",validation:{required:!0,pattern:/^[a-zA-Z-]{0,}[- ]{0,1}[ 0-9]{1,}/},error:e("FSM_REGISTRY_INVALID_DRIVER_LICENSE"),required:!1,defaultValue:"",className:"payment-form-text-input-correction"}}]},{head:"ES_FSM_REGISTRY_PERSONAL_DETAILS",body:[{label:"ES_FSM_REGISTRY_NEW_GENDER",isMandatory:!0,type:"component",route:"select-gender",hideInEmployee:!1,key:"selectGender",component:"SelectGender",texts:{headerCaption:"",header:"CS_COMMON_CHOOSE_GENDER",cardText:"CS_COMMON_SELECT_GENDER",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"}},{label:e("ES_FSM_REGISTRY_NEW_DOB"),isMandatory:!1,type:"custom",key:"dob",populators:{name:"dob",validation:{required:!0},component:function(e,t){return i.createElement(Pe,c({onChange:e.onChange,date:e.value},t,{max:f((new Date).setFullYear((new Date).getFullYear()))}))}}},{label:"ES_FSM_REGISTRY_NEW_EMAIL",isMandatory:!1,type:"text",key:"emailId",populators:{name:"emailId",validation:{required:!1,pattern:/^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9.-]+$/},error:e("FSM_REGISTRY_INVALID_EMAIL"),defaultValue:"",className:"payment-form-text-input-correction"}},{label:"ES_FSM_REGISTRY_DRIVER_PHONE",isMandatory:!0,type:"mobileNumber",key:"phone",disable:t,populators:{name:"phone",validation:{required:!0,pattern:/^[6-9]\d{9}$/},error:e("FSM_REGISTRY_INVALID_PHONE"),defaultValue:"",className:"payment-form-text-input-correction",labelStyle:{border:"1px solid black",borderRight:"none"}}}]}]},ke={SelectPropertySubtype:function(e){var l=e.config,a=e.onSelect,o=e.t,u=e.userType,s=e.formData,d=r.useLocation().pathname,v=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId()),m=Digit.Hooks.fsm.useMDMS(v,"FSM","PropertySubtype",{select:function(e){return e.map(function(e){return c({},e,{i18nKey:o(e.i18nKey)})})}}),f=m.isLoading,p=m.data,_=n.useState(),S=_[0],g=_[1],y=n.useState([]),h=y[0],T=y[1],I=(s||{}).propertyType;return n.useEffect(function(){if(!f&&p){var e=null==p?void 0:p.filter(function(e){var t;return e.code===((null==s||null===(t=s.subtype)||void 0===t?void 0:t.code)||(null==s?void 0:s.subtype))})[0];"string"==typeof I&&(null==e?void 0:e.code.split(".")[0])===I||(null==e?void 0:e.code.split(".")[0])===(null==I?void 0:I.code)?g(e):g(null)}},[I,null==s?void 0:s.subtype,p]),n.useEffect(function(){if(!f&&I){var e=p.filter(function(e){return e.propertyType===((null==I?void 0:I.code)||I)});T(e)}},[I,f,p]),f?i.createElement(t.Loader,null):"employee"===u?i.createElement(t.Dropdown,{option:h,optionKey:"i18nKey",id:"propertySubType",selected:S,select:function(e){a(l.key,e.code)},t:o,disable:!d.includes("/modify-application/")&&!d.includes("/new-application")}):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:l,onSelect:function(){sessionStorage.removeItem("Digit.total_amount"),a(l.key,S)},isDisabled:!S,t:o},i.createElement(t.CardLabel,null,o("CS_FILE_APPLICATION_PROPERTY_SUBTYPE_LABEL")+" *"),i.createElement(t.RadioOrSelect,{options:h,selectedOption:S,optionKey:"i18nKey",onSelect:function(e){g(e)},t:o})))},SelectPropertyType:function(e){var l=e.config,a=e.onSelect,o=e.t,u=e.userType,s=e.formData,d=r.useLocation().pathname,v=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId()),m=Digit.Hooks.fsm.useMDMS(v,"FSM","PropertyType",{select:function(e){return e.map(function(e){return c({},e,{i18nKey:o(e.i18nKey)})})}}),f=n.useState(),p=f[0],_=f[1];return n.useEffect(function(){if(!m.isLoading&&m.data){var e=m.data.filter(function(e){var t;return e.code===((null==s||null===(t=s.propertyType)||void 0===t?void 0:t.code)||(null==s?void 0:s.propertyType))})[0];_(e)}},[null==s?void 0:s.propertyType,m.data]),m.isLoading?i.createElement(t.Loader,null):"employee"===u?i.createElement(t.Dropdown,{option:m.data,optionKey:"i18nKey",id:"propertyType",selected:p,select:function(e){a(l.key,e.code)},t:o,disable:!d.includes("/modify-application/")&&!d.includes("/new-application")}):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:l,onSelect:function(){sessionStorage.removeItem("Digit.total_amount"),a(l.key,p)},isDisabled:!p,t:o},i.createElement(t.CardLabel,null,o("CS_FILE_APPLICATION_PROPERTY_LABEL")+" *"),i.createElement(t.RadioOrSelect,{options:m.data,selectedOption:p,optionKey:"i18nKey",onSelect:function(e){_(e)},t:o})),p&&i.createElement(t.CitizenInfoLabel,{info:o("CS_FILE_APPLICATION_INFO_LABEL"),text:o("CS_FILE_APPLICATION_INFO_TEXT",c({content:o("CS_DEFAULT_INFO_TEXT")},p))}))},FSMSelectAddress:function(e){var l,r=e.t,a=e.config,o=e.onSelect,u=e.userType,s=e.formData,d=Digit.Hooks.fsm.useTenants(),v=Digit.ULBService.getCurrentTenantId(),m=((null==s?void 0:s.address)||"").pincode,f="employee"===u?d.filter(function(e){return e.code===v}):m?d.filter(function(e){var t;return null==e||null===(t=e.pincode)||void 0===t?void 0:t.some(function(e){return e==m})}):d,p=n.useState(function(){var e;return(null==s||null===(e=s.address)||void 0===e?void 0:e.city)||Digit.SessionStorage.get("fsm.file.address.city")||null}),_=p[0],S=p[1],g=Digit.Hooks.useBoundaryLocalities(null==_?void 0:_.code,"revenue",{enabled:!!_},r).data,y=n.useState(),h=y[0],T=y[1],I=n.useState(),D=I[0],C=I[1];function N(e){C(null),T(null),Digit.SessionStorage.set("fsm.file.address.city",e),S(e)}function A(e){C(e),"employee"===u&&o(a.key,c({},s[a.key],{locality:e}))}return n.useEffect(function(){f&&1===f.length&&S(f[0])},[f]),n.useEffect(function(){if(_&&g){var e,t,n,i=g,l=[];null!=s&&null!==(e=s.address)&&void 0!==e&&e.locality&&C(s.address.locality),null!=s&&null!==(t=s.address)&&void 0!==t&&t.pincode&&(l=i.filter(function(e){var t;return null===(t=e.pincode)||void 0===t?void 0:t.find(function(e){return e==s.address.pincode})}),null!=s&&null!==(n=s.address)&&void 0!==n&&n.locality||C()),"employee"===u&&o(a.key,c({},s[a.key],{city:_})),T(function(){return l.length>0?l:i}),1===l.length&&(C(l[0]),"employee"===u&&o(a.key,c({},s[a.key],{locality:l[0]})))}},[_,null==s||null===(l=s.address)||void 0===l?void 0:l.pincode,g]),"employee"===u?i.createElement("div",null,i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},r("MYCITY_CODE_LABEL"),a.isMandatory?" * ":null),i.createElement(t.Dropdown,{className:"form-field",isMandatory:!0,selected:1===(null==f?void 0:f.length)?f[0]:_,disable:1===(null==f?void 0:f.length),option:f,select:N,optionKey:"code",t:r})),i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},r("ES_NEW_APPLICATION_LOCATION_MOHALLA"),a.isMandatory?" * ":null),i.createElement(t.Dropdown,{className:"form-field",isMandatory:!0,selected:D,option:h,select:A,optionKey:"i18nkey",t:r}))):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:a,onSelect:function(){o(a.key,{city:_,locality:D})},t:r,isDisabled:!D},i.createElement(t.CardLabel,null,r("MYCITY_CODE_LABEL")+" *"),i.createElement(t.RadioOrSelect,{options:f,selectedOption:_,optionKey:"i18nKey",onSelect:N,t:r}),_&&h&&i.createElement(t.CardLabel,null,r("CS_CREATECOMPLAINT_MOHALLA")+" *"),_&&h&&i.createElement(t.RadioOrSelect,{isMandatory:a.isMandatory,options:h,selectedOption:D,optionKey:"i18nkey",onSelect:A,t:r})))},FSMSelectStreet:function(e){var l,r,o=e.t,u=e.config,s=e.onSelect,d=e.userType,v=e.formData,m=e.formState,f=e.setError,p=e.clearErrors,_=n.useState({index:-1,type:""}),g=_[0],y=_[1],h=a.useForm(),T=h.control,I=h.formState,D=h.setValue,C=h.getValues,N=h.trigger,A=(0,h.watch)(),O=I.errors,L=(window.location.href.includes("tl/new-application")||window.location.href.includes("tl/renew-application-details")||window.location.href.includes("tl/edit-application-details/")||window.location.href.includes("/tl/tradelicence/new-application/street")||window.location.href.includes("/tl/tradelicence/renew-trade")||window.location.href.includes("/tl/tradelicence/edit-application"),window.location.href.includes("edit-application")||window.location.href.includes("tl/renew-application-details"),n.useState()),R=L[0],M=L[1],b=n.useState(),P=b[0],F=b[1];window.location.href.includes("tl")?(r=u.inputs,u.inputs[0].disable=window.location.href.includes("edit-application"),u.inputs[1].disable=window.location.href.includes("edit-application"),r[0].validation={minLength:0,maxLength:256},r[1].validation={minLength:0,maxLength:256}):r=[{label:"PT_PROPERTY_ADDRESS_STREET_NAME",type:"text",name:"street",validation:{pattern:"[a-zA-Z0-9 ]{1,255}",title:o("CORE_COMMON_STREET_INVALID")}},{label:"PT_PROPERTY_ADDRESS_HOUSE_NO",type:"text",name:"doorNo",validation:{pattern:"[A-Za-z0-9#,/ -]{1,63}",title:o("CORE_COMMON_DOOR_INVALID")}}];var k,w=function(e){var t=e.validation,n=e.name,i=e.messages;if(t){var l=t||{},r=l.pattern,a=l.maxlength,o=l.minlength,u=l.required;return{pattern:function(e){if(r){var t;if(r instanceof RegExp)return!!r.test(e)||(null==i?void 0:i.pattern)||n.toUpperCase()+"_PATTERN";if("string"==typeof r)return!(null===(t=new RegExp(r))||void 0===t||!t.test(e))||(null==i?void 0:i.pattern)||n.toUpperCase()+"_PATTERN"}return!0},required:function(e){return!u||!!e||(null==i?void 0:i.required)||n.toUpperCase()+"_REQUIRED"},minLength:function(e){return!o||(null==e?void 0:e.length)>=o||(null==i?void 0:i.minlength)||n.toUpperCase()+"_MINLENGTH"},maxLength:function(e){return!a||(null==e?void 0:e.length)<=a||(null==i?void 0:i.maxlength)||n.toUpperCase()+"_MAXLENGTH"}}}return{}};return n.useEffect(function(){var e,t,n,i,l,r,a;window.location.href.includes("employee/tl/")&&null!=v&&null!==(e=v.cpt)&&void 0!==e&&e.details&&(D("doorNo",null==v||null===(t=v.cpt)||void 0===t||null===(n=t.details)||void 0===n||null===(i=n.address)||void 0===i?void 0:i.doorNo),D("street",null==v||null===(l=v.cpt)||void 0===l||null===(r=l.details)||void 0===r||null===(a=r.address)||void 0===a?void 0:a.street))},[v]),n.useEffect(function(){N()},[]),n.useEffect(function(){var e,t,n,i;null!=v&&null!==(e=v.address)&&void 0!==e&&e.doorNo&&F(null==v||null===(t=v.address)||void 0===t?void 0:t.doorNo),null!=v&&null!==(n=v.address)&&void 0!==n&&n.street&&M(null==v||null===(i=v.address)||void 0===i?void 0:i.street)},[null==v?void 0:v.address]),n.useEffect(function(){var e,t,n,i;null!=v&&null!==(e=v.address)&&void 0!==e&&e.doorNo&&F(null==v||null===(t=v.address)||void 0===t?void 0:t.doorNo),null!=v&&null!==(n=v.address)&&void 0!==n&&n.street&&M(null==v||null===(i=v.address)||void 0===i?void 0:i.street)},[null==v?void 0:v.address]),n.useEffect(function(){var e,t,n,i;null!=v&&null!==(e=v.address)&&void 0!==e&&e.doorNo&&F(null==v||null===(t=v.address)||void 0===t?void 0:t.doorNo),null!=v&&null!==(n=v.address)&&void 0!==n&&n.street&&M(null==v||null===(i=v.address)||void 0===i?void 0:i.street)},[null==v?void 0:v.address]),n.useEffect(function(){var e;"employee"===d&&(Object.keys(O).length&&!S.isEqual((null===(e=m.errors[u.key])||void 0===e?void 0:e.type)||{},O)?f(u.key,{type:O}):!Object.keys(O).length&&m.errors[u.key]&&p(u.key))},[O]),n.useEffect(function(){var e=Object.keys(A),t={};e.forEach(function(e){var n;return t[e]=null===(n=v[u.key])||void 0===n?void 0:n[e]}),S.isEqual(A,t)||(s(u.key,c({},v[u.key],A)),N())},[A]),n.useEffect(function(){var e,t;null!=v&&null!==(e=v.cpt)&&void 0!==e&&e.details&&window.location.href.includes("tl")&&(null===(t=r)||void 0===t||t.map(function(e){var t,n,i,l,r,a,o,u,c,s,d,m,f,p;C(e.name)!==(null==v||null===(t=v.cpt)||void 0===t||null===(n=t.details)||void 0===n||null===(i=n.address)||void 0===i?void 0:i[e.name])&&D(e.name,null===(null==v||null===(l=v.cpt)||void 0===l||null===(r=l.details)||void 0===r||null===(a=r.address)||void 0===a?void 0:a[e.name])||""===(null==v||null===(o=v.cpt)||void 0===o||null===(u=o.details)||void 0===u||null===(c=u.address)||void 0===c?void 0:c[e.name])?null!=v&&null!==(s=v.address)&&void 0!==s&&s[e.name]?null==v||null===(d=v.address)||void 0===d?void 0:d[e.name]:"":null==v||null===(m=v.cpt)||void 0===m||null===(f=m.details)||void 0===f||null===(p=f.address)||void 0===p?void 0:p[e.name])}))},[null==v||null===(l=v.cpt)||void 0===l?void 0:l.details]),"employee"===d?null===(k=r)||void 0===k?void 0:k.map(function(e,n){var l,r,s,d;return i.createElement(t.LabelFieldPair,{key:n},i.createElement(t.CardLabel,{className:"card-label-smaller"},o(e.label),u.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(a.Controller,{control:T,defaultValue:(null==v||null===(l=v.cpt)||void 0===l||null===(r=l.details)||void 0===r||null===(s=r.address)||void 0===s?void 0:s[null==e?void 0:e.name])||(null==v||null===(d=v.address)||void 0===d?void 0:d[e.name]),name:e.name,rules:{validate:w(e)},render:function(l){var r,a,o,u,s,d,m,f,p,E,_,S,h,T,I,D;return i.createElement("div",{style:{display:"flex",alignItems:"baseline",marginRight:"unset"}},i.createElement(t.TextInput,c({id:e.name,key:e.name,value:l.value,onChange:function(e){y({index:n}),l.onChange(e.target.value)},onBlur:l.onBlur,disable:!(null==v||null===(r=v.cpt)||void 0===r||null===(a=r.details)||void 0===a||null===(o=a.address)||void 0===o||!o[e.name]),autoFocus:(null==g?void 0:g.index)==n},null==e?void 0:e.validation)),i.createElement("div",{style:{marginRight:"-50px",marginLeft:"10px"}},i.createElement(t.WrapUnMaskComponent,{unmaskField:function(e){l.onChange(e)},iseyevisible:!!(l.value?null===(u=l.value)||void 0===u?void 0:u.includes("*"):null==v||null===(s=v.cpt)||void 0===s||null===(d=s.details)||void 0===d||null===(m=d.address)||void 0===m||null===(f=m[e.name])||void 0===f?void 0:f.includes("*")),privacy:{uuid:null==v||null===(p=v.cpt)||void 0===p||null===(E=p.details)||void 0===E||null===(_=E.owners)||void 0===_||null===(S=_[0])||void 0===S?void 0:S.uuid,fieldName:[e.name],model:"Property",loadData:{serviceName:"/property-services/property/_search",requestBody:{},requestParam:{tenantId:null==v||null===(h=v.cpt)||void 0===h||null===(T=h.details)||void 0===T?void 0:T.tenantId,propertyIds:null==v||null===(I=v.cpt)||void 0===I||null===(D=I.details)||void 0===D?void 0:D.propertyId},jsonPath:"Properties[0].address."+e.name,isArray:!1}}})))}})))}):i.createElement(i.Fragment,null,window.location.href.includes("/tl")?i.createElement(E,{currentStep:2}):i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:c({},u,{inputs:r}),_defaultValues:{street:null==v?void 0:v.address.street,doorNo:null==v?void 0:v.address.doorNo},onChange:function(e){var t=e.target.value;"street"===e.target.name?M(t):F(t)},onSelect:function(e){return s(u.key,e)},onSkip:function(){return s()},isDisabled:!P&&!R,t:o}))},FSMSelectLandmark:function(e){var l,r=e.t,a=e.config,o=e.onSelect,u=e.formData,s=e.userType,d=n.useState(),v=d[0],m=d[1],f=n.useState(""),p=f[0],_=f[1],S=[{label:"ES_NEW_APPLICATION_LOCATION_LANDMARK",type:"textarea",name:"landmark",validation:{maxLength:1024}}];function g(e){e.target.value.length>1024?_("CS_COMMON_LANDMARK_MAX_LENGTH"):(_(null),m(e.target.value),"employee"===s&&o(a.key,c({},u[a.key],{landmark:e.target.value})))}return n.useEffect(function(){var e;m(null==u||null===(e=u.address)||void 0===e?void 0:e.landmark)},[null==u||null===(l=u.address)||void 0===l?void 0:l.landmark]),"employee"===s?null==S?void 0:S.map(function(e,n){return i.createElement(t.LabelFieldPair,{key:n},i.createElement(t.CardLabel,{className:"card-label-smaller"},r(e.label),a.isMandatory?" * ":null),i.createElement(t.TextArea,c({className:"form-field",id:e.name,value:v,onChange:g,name:e.name||""},e.validation)))}):i.createElement(i.Fragment,null,window.location.href.includes("/pt")?i.createElement(E,{currentStep:1,flow:"PT_APPLY"}):window.location.href.includes("/tl")?i.createElement(E,{currentStep:2}):i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:c({},a,{inputs:S}),value:v,onChange:g,onSelect:function(e){return o(a.key,c({},u[a.key],e))},onSkip:function(){return o()},t:r,forcedError:r(p),isDisabled:!v}))},FSMSelectPincode:function(e){var l,a,o,u=e.t,s=e.config,d=e.onSelect,v=e.formData,m=void 0===v?{}:v,f=e.userType,p=Digit.Hooks.fsm.useTenants(),_=n.useState((null==m||null===(l=m.address)||void 0===l?void 0:l.pincode)||""),S=_[0],g=_[1],y=n.useState(null),h=y[0],T=y[1],I=(r.useLocation().pathname.includes("modify"),[{label:"CORE_COMMON_PINCODE",type:"text",name:"pincode",validation:{minlength:6,maxlength:6,pattern:"^[1-9][0-9]*",max:"9999999",title:u("CORE_COMMON_PINCODE_INVALID")}}]);function D(e){if(g(e.target.value),T(null),"employee"===f)if(null==p?void 0:p.find(function(t){var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(function(t){return t.toString()===e.target.value})})){var t=p.filter(function(t){var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(function(t){return t==e.target.value})})[0];d(s.key,c({},m.address,{city:t,pincode:e.target.value,slum:null}))}else d(s.key,c({},m.address,{pincode:e.target.value})),T("CS_COMMON_PINCODE_NOT_SERVICABLE")}return n.useEffect(function(){var e;null!=m&&null!==(e=m.address)&&void 0!==e&&e.pincode&&g(m.address.pincode)},[null==m||null===(a=m.address)||void 0===a?void 0:a.pincode]),n.useEffect(function(){var e,t,n,i;(null==m||null===(e=m.address)||void 0===e||null===(t=e.locality)||void 0===t?void 0:t.pincode)!==S&&"employee"===f&&(g((null==m||null===(n=m.address)||void 0===n||null===(i=n.locality)||void 0===i?void 0:i.pincode)||""),T(null))},[null==m||null===(o=m.address)||void 0===o?void 0:o.locality]),n.useEffect(function(){"employee"===f&&S&&d(s.key,c({},m.address,{pincode:(null==S?void 0:S[0])||S}))},[S]),"employee"===f?null==I?void 0:I.map(function(e,l){return i.createElement(n.Fragment,null,i.createElement(t.LabelFieldPair,{key:l},i.createElement(t.CardLabel,{className:"card-label-smaller"},u(e.label),s.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(t.TextInput,c({key:e.name,value:S,onChange:D},e.validation)))),h&&i.createElement(t.CardLabelError,{style:{width:"70%",marginLeft:"30%",fontSize:"12px",marginTop:"-21px"}},u(h)))}):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{t:u,config:c({},s,{inputs:I}),onSelect:function(e){try{return(null==p?void 0:p.find(function(t){var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(function(t){return t==(null==e?void 0:e.pincode)})}))?d(s.key,{pincode:S}):T("CS_COMMON_PINCODE_NOT_SERVICABLE"),Promise.resolve()}catch(e){return Promise.reject(e)}},_defaultValues:{pincode:S},onChange:D,onSkip:function(){return d()},forcedError:u(h),isDisabled:!S}))},SelectTankSize:function(e){var l,r,a=e.config,o=e.onSelect,u=e.t,s=e.formData,d=void 0===s?{}:s,v=e.userType,m=Digit.ULBService.getCurrentTenantId(),f=null==d||null===(l=d.pitType)||void 0===l?void 0:l.dimension,p=n.useState(!0),_=p[0],S=p[1],g=n.useState((null==d||null===(r=d.pitDetail)||void 0===r?void 0:r.images)||null),y=g[0],h=g[1],T=n.useState(),I=T[0],D=T[1];return n.useEffect(function(){null!=d&&d.pitType||"employee"===v||o(a.key,{},!0)},[]),n.useEffect(function(){var e,t,n;!function(e){return"lbd"===e}(f)?D(c({},null==d?void 0:d.pitDetail,{length:0,width:0},0===(null==d||null===(t=d.pitDetail)||void 0===t?void 0:t.diameter)&&{height:0})):D(c({},null==d?void 0:d.pitDetail,{diameter:0},0===(null==d||null===(e=d.pitDetail)||void 0===e?void 0:e.length)&&{height:0})),d&&d.pitDetail&&h((null==d||null===(n=d.pitDetail)||void 0===n?void 0:n.images)||null)},[f]),n.useEffect(function(){y&&y.length&&S(!1)},[y]),"employee"===v?i.createElement(t.PitDimension,{sanitationType:d.pitType,size:I,handleChange:function(e){var t,n=e.target,i=n.name,l=n.value;isNaN(l)||(D(function(e){var t;return c({},e,((t={})[i]=l,t))}),"employee"===v&&setTimeout(o(a.key,c({},I,((t={})[i]=l,t)))))},t:u,disable:!(null!=d&&d.pitType)}):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:a,onSkip:function(){return o()},onSelect:function(){o(a.key,{images:y})},isDisabled:_,t:u},i.createElement(t.ImageUploadHandler,{tenantId:m,onPhotoChange:function(e){h(e)},uploadedImages:y})))},SelectPitType:function(e){var l=e.t,r=e.formData,a=e.config,o=e.onSelect,u=e.userType,c=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId()),s=n.useState(null==r?void 0:r.pitType),d=s[0],v=s[1],m=Digit.Hooks.fsm.useMDMS(c,"FSM","PitType"),f=m.data,p=function(e){v(e),"employee"===u&&(o(a.key,e),o("pitDetail",null))};return m.isLoading?i.createElement(t.Loader,null):"employee"===u?i.createElement(t.Dropdown,{isMandatory:!0,option:f,optionKey:"i18nKey",select:p,selected:d,t:l}):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{config:a,onSelect:function(){o(a.key,d)},onSkip:function(){o()},isDisabled:!d,t:l},i.createElement(t.CardLabel,null,l("CS_FILE_APPLICATION_PIT_TYPE_LABEL")),i.createElement(t.RadioOrSelect,{isMandatory:a.isMandatory,options:f,selectedOption:d,optionKey:"i18nKey",onSelect:p,t:l})))},SelectTripNo:function(e){var l,r,a=e.config,o=e.formData,u=e.t,s=e.onSelect,d=e.userType,v=Digit.ULBService.getStateId(),m=Digit.ULBService.getCurrentTenantId(),f=Digit.ULBService.getStateId(),p=Digit.Hooks.fsm.useMDMS(f,"FSM","TripNumber"),E=p.data,_=p.isLoading,S=Digit.Hooks.fsm.useDsoSearch(m,{limit:-1,status:"ACTIVE"}).data,g=Digit.Hooks.fsm.useMDMS(v,"Vehicle","VehicleType",{staleTime:Infinity}).data,y=n.useState(null==o?void 0:o.tripNo),h=y[0],T=y[1],I=n.useState(null==o?void 0:o.capacity),D=I[0],C=I[1],N=n.useState([]),A=N[0],O=N[1];return n.useEffect(function(){if(S&&g){var e=S.reduce(function(e,t){return t.vehicles&&t.vehicles.length?e.concat(t.vehicles):e},[]),t=Array.from(new Set(e.map(function(e){return e.capacity}))).map(function(t){return e.find(function(e){return e.capacity===t})});O(t)}},[S,g]),n.useEffect(function(){if(!_&&E){var e=E.filter(function(e){var t,n;return e.code===((null==o||null===(t=o.selectTripNo)||void 0===t||null===(n=t.tripNo)||void 0===n?void 0:n.code)||(null==o?void 0:o.selectTripNo))})[0];T(e||E.find(function(e){return 1===e.code}))}},[null==o||null===(l=o.selectTripNo)||void 0===l?void 0:l.tripNo,E]),n.useEffect(function(){if(!_&&A){var e=A.filter(function(e){var t,n;return e.capacity===(null==o||null===(t=o.selectTripNo)||void 0===t||null===(n=t.vehicleCapacity)||void 0===n?void 0:n.capacity)})[0],t=A.reduce(function(e,t){return e.capacity<t.capacity?e:t},0);C(e||t)}},[null==o||null===(r=o.selectTripNo)||void 0===r?void 0:r.vehicleCapacity,A]),_||0===A.length?i.createElement(t.Loader,null):"employee"===d?null:i.createElement(i.Fragment,null,i.createElement(t.FormStep,{config:a,onSelect:function(){h&&s(a.key,{tripNo:h,vehicleCapacity:D})},onSkip:function(){h&&s(a.key,{tripNo:h,vehicleCapacity:D})},isDisabled:!h&&!D,t:u},i.createElement(t.CardText,null," ",u("ES_FSM_NUMBER_OF_TRIPS")," "),i.createElement(t.RadioOrSelect,{options:E,selectedOption:h,optionKey:"i18nKey",onSelect:function(e){T(e)},optionCardStyles:{zIndex:"60"},t:u,isMandatory:a.isMandatory}),i.createElement(t.CardText,null," ",u("ES_VEHICLE CAPACITY")," "),i.createElement(t.RadioOrSelect,{options:null==A?void 0:A.map(function(e){return c({},e,{label:e.capacity})}).sort(function(e,t){return e.capacity-t.capacity}),selectedOption:D,optionKey:"capacity",onSelect:function(e){C(e)},optionCardStyles:{zIndex:"60"},t:u,isMandatory:a.isMandatory,isDropDown:!0})))},FSMSelectGeolocation:function(e){var l,r,a=e.t,o=e.config,u=e.onSelect,c=e.formData,s=void 0===c?{}:c,d=n.useState((null==s||null===(l=s.address)||void 0===l?void 0:l.pincode)||""),v=d[0],m=d[1],f=n.useState((null==s||null===(r=s.address)||void 0===r?void 0:r.geoLocation)||{}),p=f[0],_=f[1],S=Digit.Hooks.fsm.useTenants(),g=n.useState(null),y=g[0],h=g[1];return i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.LocationSearchCard,{header:a("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_HEADER"),cardText:a("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_TEXT"),nextText:a("CS_COMMON_NEXT"),skipAndContinueText:a("CORE_COMMON_SKIP_CONTINUE"),skip:function(){return u()},t:a,position:p,onSave:function(){return u(o.key,{geoLocation:p,pincode:v})},onChange:function(e,t){return function(e,t){h(null),(null==S?void 0:S.find(function(t){var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(function(t){return t==e})}))?(m(e),_(t)):(h("CS_COMMON_PINCODE_NOT_SERVICABLE"),m(""),_({}))}(e,t)},disabled:""===v,forcedError:a(y)}))},SelectSlumName:function(e){var l,r,a,o,u,s,d=e.config,v=e.onSelect,m=e.t,f=e.userType,p=e.formData,_=Digit.ULBService.getCurrentTenantId(),S=(Digit.ULBService.getStateId(),n.useState()),g=S[0],y=S[1],h=null!=p&&null!==(l=p.address)&&void 0!==l&&l.city?null==p||null===(r=p.address)||void 0===r?void 0:r.city.code:_,T=Digit.Hooks.fsm.useMDMS(h,"FSM","Slum"),I=T.data,D=T.isLoading,C=n.useState(),N=C[0],A=C[1];return n.useEffect(function(){var e,t;"employee"!==f&&!1===(null==p||null===(e=p.address)||void 0===e||null===(t=e.slumArea)||void 0===t?void 0:t.code)&&v(d.key,{slumData:null,slum:null},!0)},[null==p||null===(a=p.address)||void 0===a?void 0:a.slumArea]),n.useEffect(function(){if(N&&null!=p&&p.address){var e=N.filter(function(e){var t;return e.code===(null==p||null===(t=p.address)||void 0===t?void 0:t.slum)})[0];y(e)}},[null==p||null===(o=p.address)||void 0===o?void 0:o.slum,N]),n.useEffect(function(){var e,t,n=null==p||null===(e=p.address)||void 0===e||null===(t=e.locality)||void 0===t?void 0:t.code;if("employee"===f&&!D&&I){var i,l=[{code:null,active:!0,name:"Not residing in slum area",i18nKey:"ES_APPLICATION_NOT_SLUM_AREA"}].concat(I[n]?I[n]:Object.keys(I).map(function(e){return I[e]}).reduce(function(e,t){return[].concat(e,t)}));A(l),null!=p&&null!==(i=p.address)&&void 0!==i&&i.slum||(y({code:null,active:!0,name:"Not residing in slum area",i18nKey:"ES_APPLICATION_NOT_SLUM_AREA"}),v(d.key,c({},p[d.key],{slum:null})))}if("employee"!==f&&!D&&I){var r=Object.keys(I).map(function(e){return I[e]}).reduce(function(e,t){return[].concat(e,t)});A(I[n]?I[n]:r)}},[D,null==p||null===(u=p.address)||void 0===u||null===(s=u.locality)||void 0===s?void 0:s.code]),D?i.createElement(t.Loader,null):"employee"===f?i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},m("ES_NEW_APPLICATION_SLUM_NAME")),i.createElement(t.Dropdown,{t:m,option:N,className:"form-field",optionKey:"i18nKey",id:"slum",selected:g,select:function(e){y(e),v(d.key,c({},p[d.key],{slum:e.code}))}})):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{t:m,config:d,onSelect:function(){sessionStorage.removeItem("Digit.total_amount"),v(d.key,c({},p[d.key],{slum:g.code,slumData:g}))},onSkip:function(){v()}},i.createElement(t.Dropdown,{t:m,option:N,optionKey:"i18nKey",id:"i18nKey",selected:g,select:y})))},CheckSlum:function(e){var l,r,a,o=e.t,u=e.config,c=e.onSelect,s=e.formData,d=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId(),n.useState(null==s||null===(l=s.address)||void 0===l?void 0:l.slumArea)),v=d[0],m=d[1];return null==s||null===(r=s.address)||void 0===r||null===(a=r.locality)||void 0===a||a.code.split("_"),i.createElement(i.Fragment,null,i.createElement(E,{currentStep:1,flow:"APPLY"}),i.createElement(t.FormStep,{t:o,config:u,onSelect:function(){sessionStorage.removeItem("Digit.total_amount"),c(u.key,{slumArea:v})},onSkip:function(){return c()},isDisabled:!v},i.createElement(t.RadioOrSelect,{isMandatory:u.isMandatory,options:[{code:!0,i18nKey:"CS_COMMON_YES"},{code:!1,i18nKey:"CS_COMMON_NO"}],selectedOption:v,optionKey:"i18nKey",onSelect:m})))},FSMCard:function(){var e=l.useTranslation().t,n=(Digit.UserService.hasAccess(["FSM_DSO"]),Digit.UserService.hasAccess("FSM_COLLECTOR")||!1),r=Digit.UserService.hasAccess("FSM_ADMIN")||!1,a=Digit.UserService.hasAccess("FSM_EDITOR_EMP")||!1,o=Digit.UserService.hasAccess("FSM_CREATOR_EMP")||!1,u=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1,s=Digit.ULBService.getCurrentTenantId();if(!Digit.Utils.fsmAccess())return null;Digit.Hooks.fsm.useVehicleSearch({tenantId:s,filters:{applicationStatus:"WAITING_FOR_DISPOSAL"},config:{enabled:!!u,select:function(t){var n,i=t.vehicleTrip.reduce(function(t,n){var i=n.tripDetails.reduce(function(e,t){return t.volume+e},0);return t[e("ES_READY_FOR_DISPOSAL")]+=i/1e3,t},((n={})[e("ES_READY_FOR_DISPOSAL")]=0,n));return i[e("ES_READY_FOR_DISPOSAL")]="("+i[e("ES_READY_FOR_DISPOSAL")]+" KL)",i}}});var d=Digit.Hooks.fsm.useInbox(s,c({},{sortBy:"createdTime",sortOrder:"DESC",total:!0},{limit:10,offset:0},a||o||n||r?{uuid:{code:"ASSIGNED_TO_ALL",name:e("ES_INBOX_ASSIGNED_TO_ALL")}}:{uuid:{code:"ASSIGNED_TO_ME",name:e("ES_INBOX_ASSIGNED_TO_ME")}}),{enabled:!u}),v=d.data,m=d.isLoading,f={Icon:i.createElement(t.ShippingTruck,null),moduleName:e("ES_COMMON_FSTP_OPERATION"),links:[{label:e("ES_COMMON_INBOX"),link:"/digit-ui/employee/fsm/fstp-inbox"},{label:e("ES_FSM_ADD_NEW_BUTTON"),link:"/digit-ui/employee/fsm/fstp-add-vehicle"},{label:e("ES_FSM_VIEW_REPORTS_BUTTON"),link:"/employee/report/fsm/FSMFSTPPlantWithVehicleLogReport",hyperlink:!0}]},p=[{link:"/employee/report/fsm/FSMDailyDesludingReport",hyperlink:!0,label:e("ES_FSM_VIEW_REPORTS_BUTTON"),roles:["FSM_ADMIN"]},{label:e("ES_TITLE_FSM_REGISTRY"),link:"/digit-ui/employee/fsm/registry",roles:["FSM_ADMIN"]},{label:e("ES_TITLE_NEW_DESULDGING_APPLICATION"),link:"/digit-ui/employee/fsm/new-application",roles:["FSM_CREATOR_EMP","FSM_ADMIN"]},{label:e("ES_TITILE_SEARCH_APPLICATION"),link:"/digit-ui/employee/fsm/search"}];p=p.filter(function(e){return!e.roles||function(e){var t,n=Digit.ULBService.getCurrentTenantId(),i=Digit.UserService.getUser(),l=[];return null==i||null===(t=i.info)||void 0===t||t.roles.filter(function(t){for(var i=0;i<e.length;i++)t.code==e[i]&&t.tenantId===n&&l.push(!0)}),null==l?void 0:l.length}(e.roles)});var E={Icon:i.createElement(t.ShippingTruck,null),moduleName:e("ES_TITLE_FAECAL_SLUDGE_MGMT"),kpis:[{count:m?"-":null==v?void 0:v.totalCount,label:e("TOTAL_FSM"),link:"/digit-ui/employee/fsm/inbox"},{count:m?"-":null==v?void 0:v.nearingSlaCount,label:e("TOTAL_NEARING_SLA"),link:"/digit-ui/employee/fsm/inbox"}],links:[{count:m?"-":null==v?void 0:v.totalCount,link:"/digit-ui/employee/fsm/inbox",label:e("ES_COMMON_INBOX")}].concat(p)};return i.createElement(t.EmployeeModuleCard,u?f:c({},E,{longModuleName:!0,FsmHideCount:!1}))},FSMModule:function(e){var n=e.stateCode,l=e.userType,a=e.tenants,o=r.useRouteMatch(),u=o.path,c=o.url,s=Digit.StoreData.getCurrentLanguage();return Digit.Services.useStore({stateCode:n,moduleCode:"FSM",language:s}).isLoading?i.createElement(t.Loader,null):(Digit.SessionStorage.set("FSM_TENANTS",a),"citizen"===l?i.createElement(g,{path:u}):i.createElement(Z,{path:u,url:c,userType:l}))},FSMLinks:function(e){var a=e.matchPath,o=e.userType,u=l.useTranslation().t,c=Digit.Hooks.useSessionStorage("FSM_CITIZEN_FILE_PROPERTY",{})[2];if(n.useEffect(function(){c()},[]),"citizen"===o){var s=[{link:a+"/new-application",i18nKey:u("CS_HOME_APPLY_FOR_DESLUDGING")},{link:a+"/my-applications",i18nKey:u("CS_HOME_MY_APPLICATIONS")}];return[{role:"FSM_DSO",from:"/digit-ui/citizen/fsm/dso-dashboard",dashoardLink:"CS_LINK_DSO_DASHBOARD",loginLink:"CS_LINK_LOGIN_DSO"}].map(function(e){var t=e.from,n=e.loginLink,i=e.dashoardLink;Digit.UserService.hasAccess(e.role)?s.push({link:t,i18nKey:u(i)}):s.push({link:"/digit-ui/citizen/login",state:{role:"FSM_DSO",from:t},i18nKey:u(n)})}),i.createElement(t.CitizenHomeCard,{header:u("CS_HOME_FSM_SERVICES"),links:s,Icon:t.CitizenTruck})}return i.createElement("div",{className:"employee-app-container"},i.createElement("div",{className:"ground-container"},i.createElement("div",{className:"employeeCard"},i.createElement("div",{className:"complaint-links-container"},i.createElement("div",{className:"header"},i.createElement("span",{className:"logo"},i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},i.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),i.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"white"}))),i.createElement("span",{className:"text"},u("ES_TITLE_FSM"))),i.createElement("div",{className:"body"},i.createElement("span",{className:"link"},i.createElement(r.Link,{to:a+"/inbox"},u("ES_TITLE_INBOX"))),i.createElement("span",{className:"link"},i.createElement(r.Link,{to:a+"/new-application/"},u("ES_TITLE_NEW_DESULDGING_APPLICATION"))))))))},SelectChannel:function(e){var l=e.t,a=e.config,o=e.onSelect,u=e.formData,c=void 0===u?{}:u,s=Digit.ULBService.getCurrentTenantId(),d=r.useLocation().pathname.includes("/modify-application/"),v=Digit.Hooks.fsm.useMDMS(s,"FSM","EmployeeApplicationChannel").data,m=n.useState(null==c?void 0:c.channel),f=m[1];return v?i.createElement(t.Dropdown,{option:v,optionKey:"i18nKey",id:"channel",selected:m[0],select:function(e){f(e),o(a.key,e)},t:l,disable:d,autoFocus:!d}):i.createElement(t.Loader,null)},SelectName:function(e){var l=e.t,a=e.config,o=e.onSelect,u=e.formData,s=void 0===u?{}:u,d=e.errors,v=Digit.ULBService.getStateId(),m=Digit.Hooks.fsm.useMDMS(v,"common-masters","FSMGenderType"),f=m.data,p=m.isLoading,E=r.useLocation().pathname.includes("/modify-application/"),_=n.useState("")[1],S=n.useState([]),g=S[0],y=S[1],h=[{label:"ES_NEW_APPLICATION_APPLICANT_NAME",type:"text",name:"applicantName",validation:{isRequired:!0,pattern:"^[a-zA-Z]+( [a-zA-Z]+)*$",title:l("CORE_COMMON_APPLICANT_NAME_INVALID")},isMandatory:!0},{label:"ES_NEW_APPLICATION_APPLICANT_MOBILE_NO",type:"text",name:"mobileNumber",validation:{isRequired:!0,pattern:"[6-9]{1}[0-9]{9}",type:"tel",title:l("CORE_COMMON_APPLICANT_MOBILE_NUMBER_INVALID")},componentInFront:i.createElement("div",{className:"employee-card-input employee-card-input--front"},"+91"),isMandatory:!0},{label:"COMMON_APPLICANT_GENDER",type:"dropdown",name:"applicantGender",options:g,isMandatory:!1}];function T(e){_(e),o(a.key,c({},s[a.key],{applicantGender:e.code}))}return n.useEffect(function(){!p&&f&&y(f)},[f]),i.createElement("div",null,null==h?void 0:h.map(function(e,n){return i.createElement(i.Fragment,{key:n},"text"===e.type&&i.createElement(i.Fragment,null,d[e.name]&&i.createElement(t.CardLabelError,null,l(e.error)),i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},l(e.label),e.isMandatory?" * ":null),i.createElement("div",{className:"field",style:{display:"flex"}},e.componentInFront?e.componentInFront:null,i.createElement(t.TextInput,c({key:e.name,value:s&&s[a.key]?s[a.key][e.name]:null,onChange:function(t){return function(e,t){var n;o(a.key,c({},s[a.key],((n={})[t]=e,n)))}(t.target.value,e.name)},disable:E},e.validation))))),"dropdown"===e.type&&i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},l(e.label),e.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(t.Dropdown,{option:e.options,optionKey:"i18nKey",id:"dropdown",selected:s&&s[a.key]?e.options.find(function(t){return t.code===s[a.key][e.name]}):null,select:T,t:l,disable:E,autoFocus:!E}))))}))},SelectTripData:function(e){var l,a,o,u,s,d,v,m=e.t,f=e.config,p=e.onSelect,E=e.formData,_=void 0===E?{}:E,S=Digit.ULBService.getCurrentTenantId(),g=Digit.ULBService.getStateId(),y=(r.useLocation().pathname.includes("/modify-application/"),r.useParams().id),h=Digit.UserService.getUser(),T=(Digit.Hooks.fsm.useSearch(S,{applicationNos:y,uuid:h.uuid},{staleTime:Infinity}),r.useLocation().pathname.includes("modify"),n.useState({label:null==_||null===(l=_.tripData)||void 0===l?void 0:l.vehicleCapacity})),I=T[0],D=T[1],C=n.useState(!1),N=C[0],A=C[1],O=Digit.Hooks.fsm.useMDMS(g,"Vehicle","VehicleType",{staleTime:Infinity}),L=O.isLoading,R=O.data,M=Digit.Hooks.fsm.useDsoSearch(S,{limit:-1,status:"ACTIVE"}),b=M.data,P=M.isLoading,F=n.useState([])[1];n.useEffect(function(){if(b&&R){var e=b.reduce(function(e,t){return t.vehicles&&t.vehicles.length?e.concat(t.vehicles):e},[]),t=Array.from(new Set(e.map(function(e){return e.capacity}))).map(function(t){return e.find(function(e){return e.capacity===t})});F(t)}},[b,R]);var k=[{label:"ES_NEW_APPLICATION_AMOUNT_PER_TRIP",type:"text",name:"amountPerTrip",error:m("ES_NEW_APPLICATION_AMOUNT_INVALID"),validation:{isRequired:!0,pattern:"[0-9]{1,10}",title:m("ES_APPLICATION_BILL_SLAB_ERROR")},default:null==_||null===(a=_.tripData)||void 0===a?void 0:a.amountPerTrip,disable:!0,isMandatory:!0},{label:"ES_PAYMENT_DETAILS_TOTAL_AMOUNT",type:"text",name:"amount",validation:{isRequired:!0,title:m("ES_APPLICATION_BILL_SLAB_ERROR")},default:null==_||null===(o=_.tripData)||void 0===o?void 0:o.amount,disable:!0,isMandatory:!0}];function w(e){p(f.key,c({},_[f.key],e))}return n.useEffect(function(){!function(){try{var e,t,n;(null==_||null===(e=_.tripData)||void 0===e?void 0:e.vehicleType)!==I&&D({label:null==_||null===(t=_.tripData)||void 0===t||null===(n=t.vehicleType)||void 0===n?void 0:n.capacity});var i=function(){var e,t;if(null!=_&&_.propertyType&&null!=_&&_.subtype&&null!=_&&_.address&&null!=_&&null!==(e=_.tripData)&&void 0!==e&&null!==(t=e.vehicleType)&&void 0!==t&&t.capacity){var n,i=null==_||null===(n=_.tripData)||void 0===n?void 0:n.vehicleType.capacity;return Promise.resolve(Digit.FSMService.billingSlabSearch(S,{propertyType:null==_?void 0:_.subtype,capacity:i,slum:_.address.slum?"YES":"NO"})).then(function(e){var t,n=(null==e||null===(t=e.billingSlab)||void 0===t?void 0:t.length)&&(null==e?void 0:e.billingSlab[0]);null!=n&&n.price||0===(null==n?void 0:n.price)?(w({amountPerTrip:n.price,amount:n.price*_.tripData.noOfTrips}),A(!1)):(w({amountPerTrip:"",amount:""}),A(!0))})}}();i&&i.then&&i.then(function(){})}catch(e){Promise.reject(e)}}()},[null==_?void 0:_.propertyType,null==_?void 0:_.subtype,null==_||null===(u=_.address)||void 0===u?void 0:u.slum,null==_||null===(s=_.tripData)||void 0===s||null===(d=s.vehicleType)||void 0===d?void 0:d.capacity,null==_||null===(v=_.tripData)||void 0===v?void 0:v.noOfTrips]),L&&P?i.createElement(t.Loader,null):i.createElement("div",null,null==k?void 0:k.map(function(e,n){return i.createElement(t.LabelFieldPair,{key:n},i.createElement(t.CardLabel,{className:"card-label-smaller"},m(e.label)+" (₹)",e.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(t.TextInput,c({type:e.type,onChange:function(e){p(f.key,c({},_[f.key],{noOfTrips:e.target.value}))},key:e.name,value:e.default?e.default:_&&_[f.key]?_[f.key][e.name]:null},e.validation,{disable:e.disable}))))}),N?i.createElement(t.CardLabelError,{style:{width:"100%",textAlign:"center"}},m("ES_APPLICATION_BILL_SLAB_ERROR")):null)},SelectGender:function(e){var l=e.config,r=e.onSelect,a=e.t,o=e.userType,u=e.formData,c=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId()),s=Digit.Hooks.fsm.useMDMS(c,"common-masters","FSMGenderType"),d=s.data,v=s.isLoading,m=n.useState(null==u?void 0:u.genderType),f=m[0],p=m[1];n.useEffect(function(){if(!v&&d){var e=d.filter(function(e){var t;return e.code===((null==u||null===(t=u.selectGender)||void 0===t?void 0:t.code)||(null==u?void 0:u.selectGender))})[0];p(e)}},[null==u?void 0:u.selectGender,d]);var _=function(e){p(e),"employee"===o&&(r(l.key,e),r("genderDetail",null))};return v?i.createElement(t.Loader,null):"employee"===o?i.createElement("div",null,i.createElement(t.Dropdown,{className:"payment-form-text-input-correction",isMandatory:l.isMandatory,selected:f,option:d,select:_,optionKey:"i18nKey",disable:l.disable,t:a})):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:2,flow:"APPLY"}),i.createElement(t.FormStep,{config:l,onSelect:function(){r(l.key,f)},onSkip:function(){r()},isDisabled:!f,t:a},i.createElement(t.RadioOrSelect,{options:d,selectedOption:f,optionKey:"i18nKey",onSelect:_,t:a,isMandatory:l.isMandatory})))},SelectPaymentType:function(e){var l,a=e.t,o=e.config,u=e.onSelect,c=e.formData,s=void 0===c?{}:c,d=Digit.ULBService.getStateId(),v=Digit.Hooks.fsm.useMDMS(d,"FSM","PaymentType"),m=v.data,f=v.isLoading,p=r.useLocation().pathname.includes("/modify-application/"),E=n.useState(null),_=E[0],S=E[1],g=n.useState()[1],y=[{label:"Payment Preference",type:"RadioButton",name:"paymentPreference",options:m,isMandatory:!1}];function h(e){S(e),u(o.key,e.code)}return n.useEffect(function(){if(!f&&m){var e=m.filter(function(e){var t;return e.code===((null==s||null===(t=s.paymentPreference)||void 0===t?void 0:t.code)||(null==s?void 0:s.paymentPreference))})[0];S(e||m.find(function(e){return"POST_PAY"===e.code}))}},[s,null==s||null===(l=s.paymentPreference)||void 0===l?void 0:l.code,null==s?void 0:s.paymentPreference,m]),n.useEffect(function(){null!=s&&s.address&&g(!!s.address.slum)},[s]),i.createElement("div",null,null==y?void 0:y.map(function(e,n){var l;return i.createElement(i.Fragment,{key:n},0!==(null==s||null===(l=s.tripData)||void 0===l?void 0:l.amountPerTrip)&&"RadioButton"===e.type&&i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},a(e.label),e.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(t.RadioButtons,{selectedOption:_,onSelect:h,style:{display:"flex",marginBottom:0},innerStyles:{marginLeft:"10px"},options:e.options,optionsKey:"i18nKey",disabled:p}))))}))},SelectPaymentPreference:function(e){var l,r,a,o,u=e.config,s=e.formData,d=e.t,v=e.onSelect,m=e.userType,f=Digit.ULBService.getCitizenCurrentTenant(),p=(Digit.ULBService.getStateId(),n.useState(null)),_=p[0],S=p[1],g=n.useState(null),y=g[0],h=g[1],T=n.useState(null),I=T[0],D=T[1],C=n.useState(!1)[1],N=[{label:"ES_NEW_APPLICATION_ADVANCE_COLLECTION",type:"number",name:"advanceAmount",validation:{isRequired:!0},disable:y===I,default:null==s||null===(l=s.selectPaymentPreference)||void 0===l?void 0:l.advanceAmount,isMandatory:!0}],A=function(){v(u.key,{advanceAmount:y})};if(n.useEffect(function(){!function(){try{var e=function(){var e;if(null!=s&&s.propertyType&&null!=s&&s.subtype&&null!=s&&s.address&&null!=s&&null!==(e=s.selectTripNo)&&void 0!==e&&e.vehicleCapacity.capacity){var t,n,i=null==s||null===(t=s.selectTripNo)||void 0===t?void 0:t.vehicleCapacity.capacity;return Promise.resolve(Digit.FSMService.billingSlabSearch(f,{propertyType:null==s||null===(n=s.subtype)||void 0===n?void 0:n.code,capacity:i,slum:s.address.slum?"YES":"NO"})).then(function(e){var t,n=(null==e||null===(t=e.billingSlab)||void 0===t?void 0:t.length)&&(null==e?void 0:e.billingSlab[0]);Digit.SessionStorage.set("amount_per_trip",n.price);var i=function(){if(null!=n&&n.price){var e,t,i=n.price*(null==s||null===(e=s.selectTripNo)||void 0===e||null===(t=e.tripNo)||void 0===t?void 0:t.code);return Promise.resolve(Digit.FSMService.advanceBalanceCalculate(f,{totalTripAmount:i})).then(function(e){var t,n,l=e.advanceAmount;h(l),D(i),Digit.SessionStorage.set("total_amount",i),Digit.SessionStorage.set("advance_amount",l),null!=s&&null!==(t=s.selectPaymentPreference)&&void 0!==t&&t.advanceAmount?S(null==s||null===(n=s.selectPaymentPreference)||void 0===n?void 0:n.advanceAmount):S(l),C(!1)})}0===(null==n?void 0:n.price)?(Digit.SessionStorage.set("total_amount",0),A()):(sessionStorage.removeItem("Digit.total_amount"),sessionStorage.removeItem("Digit.advance_amount"),C(!0))}();if(i&&i.then)return i.then(function(){})})}}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[null==s?void 0:s.propertyType,null==s?void 0:s.subtype,null==s?void 0:s.address,null==s||null===(r=s.selectTripNo)||void 0===r?void 0:r.vehicleCapacity.capacity,null==s||null===(a=s.selectTripNo)||void 0===a||null===(o=a.tripNo)||void 0===o?void 0:o.code]),"employee"===m)return null;var O=_,L=Digit.SessionStorage.get("total_amount"),R=Digit.SessionStorage.get("advance_amount");return null===_?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement(E,{currentStep:3,flow:"APPLY"}),i.createElement(t.FormStep,{config:u,onSelect:function(){v(u.key,{advanceAmount:_})},onSkip:A,isDisabled:O>L||O<R,t:d},i.createElement(t.KeyNote,{keyValue:d("ADV_TOTAL_AMOUNT")+" (₹)",note:L}),i.createElement(t.KeyNote,{keyValue:d("FSM_ADV_MIN_PAY")+" (₹)",note:R}),null==N?void 0:N.map(function(e,n){return i.createElement(i.Fragment,{key:n},i.createElement(t.LabelFieldPair,{key:n},i.createElement(t.CardLabel,null,d(e.label)+" (₹)",e.isMandatory?" * ":null),i.createElement("div",null,i.createElement(t.TextInput,c({type:e.type,key:e.name,disable:e.disable,onChange:function(e){S(e.target.value)},value:_},e.validation)),O>L&&i.createElement(t.CardLabelError,{style:{width:"100%",marginTop:"-15px",fontSize:"14px",marginBottom:"0px"}},d("FSM_ADVANCE_AMOUNT_MAX")),O<R&&i.createElement(t.CardLabelError,{style:{width:"100%",marginTop:"-15px",fontSize:"14px",marginBottom:"0px"}},d("FSM_ADVANCE_AMOUNT_MIN")))))})))},FSMEmpInbox:function(e){var r,a,u,s,d,v,m,f,p=e.parentRoute,E=e.isSearch,_=void 0!==E&&E,S=e.isInbox,g=void 0!==S&&S,y=Digit.ULBService.getCurrentTenantId(),h=Digit.UserService.getUser().info.roles,T=Digit.UserService.hasAccess(["FSM_DSO"])||!1,I=Digit.UserService.hasAccess("FSM_EMP_FSTPO")||!1,D=l.useTranslation().t,C=o.useQueryClient(),N=n.useState(!1),A=N[0],O=N[1],L=n.useState(0),R=L[0],M=L[1],b=n.useState(10),P=b[0],F=b[1],k=n.useState([{id:"createdTime",desc:!0}]),w=k[0],x=k[1],H=g?"fsm/inbox/searchParams":"fsm/search/searchParams",V=g?{applicationStatus:[],locality:[],uuid:T||I?{code:"ASSIGNED_TO_ME",name:D("ES_INBOX_ASSIGNED_TO_ME")}:{code:"ASSIGNED_TO_ALL",name:D("ES_INBOX_ASSIGNED_TO_ALL")}}:{},U=Digit.Hooks.useSessionStorage(H,V),B=U[0],Y=U[1];n.useEffect(function(){ae(B)},[]);var z=window.Digit.Utils.browser.isMobile(),W=z?{limit:100,offset:0,sortBy:null==w||null===(r=w[0])||void 0===r?void 0:r.id,sortOrder:null!=w&&null!==(a=w[0])&&void 0!==a&&a.desc?"DESC":"ASC"}:{limit:P,offset:R,sortBy:null==w||null===(u=w[0])||void 0===u?void 0:u.id,sortOrder:null!=w&&null!==(s=w[0])&&void 0!==s&&s.desc?"DESC":"ASC"},j=Digit.Hooks.fsm.useInbox(y,c({},B,W,{fromDate:null!=B&&B.fromDate?new Date(null==B?void 0:B.fromDate).getTime():void 0,toDate:null!=B&&B.toDate?new Date(null==B?void 0:B.toDate).getTime():void 0}),{enabled:g},!!T),X=j.data,q=j.isLoading,Z=j.isIdle,Q=T?(null==X||null===(d=X.statuses.filter(function(e){return"DSO_INPROGRESS"===e.applicationstatus})[0])||void 0===d?void 0:d.count)+(null==X||null===(v=X.statuses.filter(function(e){return"PENDING_DSO_APPROVAL"===e.applicationstatus})[0])||void 0===v?void 0:v.count):null==X?void 0:X.totalCount,$=Digit.Hooks.fsm.useSearchAll(y,c({limit:P,offset:R},B,{applicationStatus:null==B||null===(m=B.applicationStatus)||void 0===m?void 0:m.code,fromDate:null!=B&&B.fromDate?new Date(null==B?void 0:B.fromDate).getTime():void 0,toDate:null!=B&&B.toDate?new Date(null==B?void 0:B.toDate).getTime():void 0}),null,{enabled:A&&_}),J=$.isLoading,ee=$.data,te=void 0===ee?{}:ee,ne=te.data,ie=te.totalCount;n.useEffect(function(){M(0)},[B]);var le=function(e){var t=e.delete,n=c({},B);t&&t.forEach(function(e){return delete n[e]}),Y(c({},n,e))},re=n.useCallback(function(e){0!==(null==e?void 0:e.length)&&x(e)},[]),ae=function(e){var t;void 0===e&&(e={}),_?(0===(null===(t=Object.keys(e))||void 0===t?void 0:t.length)?(O(!1),C.resetQueries("FSM_CITIZEN_SEARCH")):O(!0),Y(c({},e))):Y(function(t){return c({applicationStatus:t.applicationStatus,locality:t.locality,uuid:t.uuid},e)})},oe=function(e){return _?[{label:D("ES_SEARCH_APPLICATION_APPLICATION_NO"),name:"applicationNos"},{label:D("ES_SEARCH_APPLICATION_MOBILE_NO"),name:"mobileNumber",maxlength:10,pattern:"[6-9][0-9]{9}",title:D("ES_SEARCH_APPLICATION_MOBILE_INVALID")},{label:D("ES_INBOX_STATUS"),name:"applicationStatus",type:"status"},{label:D("ES_SEARCH_FROM_DATE"),name:"fromDate",type:"date"},{label:D("ES_SEARCH_TO_DATE"),name:"toDate",type:"date"}]:e.find(function(e){return"FSM_EMP_FSTPO"===e.code})?[{label:D("ES_SEARCH_APPLICATION_APPLICATION_NO"),name:"applicationNos"},{label:D("ES_FSTP_OPERATOR_VEHICLE_NO"),name:"vehicleNo"},{label:D("ES_FSTP_DSO_NAME"),name:"name"}]:[{label:D("ES_SEARCH_APPLICATION_APPLICATION_NO"),name:"applicationNos"},{label:D("ES_SEARCH_APPLICATION_MOBILE_NO"),name:"mobileNumber",maxlength:10}]};if(n.useEffect(function(){var e,t=["CITIZEN_FEEDBACK_PENDING"];null==X||null===(e=X.table)||void 0===e||e.map(function(e){t.includes(e.status)&&(e.sla="-")})},[X]),null!==(null==X||null===(f=X.table)||void 0===f?void 0:f.length))return z?i.createElement("div",null,!_&&i.createElement(t.Header,null,D("ES_COMMON_INBOX")),i.createElement(K,{data:g?X:ne,isLoading:g?q||Z:J,isSearch:_,searchFields:oe(h),onFilterChange:le,onSearch:ae,onSort:re,parentRoute:p,searchParams:B,sortParams:w,removeParam:function(e){void 0===e&&(e={});var t=c({},B);Object.keys(e).forEach(function(e){return delete t[e]}),Y(t)},linkPrefix:p+"/"+(T?"dso-application-details":"application-details")+"/"})):i.createElement("div",null,!_&&i.createElement(t.Header,null,D("ES_COMMON_INBOX"),Number(Q)?i.createElement("p",{className:"inbox-count"},Number(Q)):null),i.createElement(G,{data:g?X:ne,isLoading:g?q||Z:J,isSearch:_,shouldSearch:A,onFilterChange:le,searchFields:oe(h),onSearch:ae,onSort:re,onNextPage:function(){M(function(e){return e+P})},onPrevPage:function(){M(function(e){return e-P})},currentPage:Math.floor(R/P),pageSizeLimit:P,disableSort:!1,searchParams:B,onPageSizeChange:function(e){F(Number(e.target.value))},parentRoute:p,paginationParms:W,sortParams:w,totalRecords:g?Number(Q):ie}))},FSMFstpInbox:function(){var e,r,a,o,u,s,d,v,m,f,p=l.useTranslation().t,E=Digit.ULBService.getCurrentTenantId(),_=n.useState({applicationStatus:"WAITING_FOR_DISPOSAL"}),S=_[0],g=_[1],y=n.useState([{id:"createdTime",desc:!0}]),h=y[0],T=y[1],I=n.useState(0),D=I[0],C=I[1],N=n.useState(10),A=N[0],O=N[1],L=Digit.Hooks.fsm.useVehiclesSearch({tenantId:E,filters:{registrationNumber:null==S?void 0:S.registrationNumber},config:{enabled:(null==S||null===(e=S.registrationNumber)||void 0===e?void 0:e.length)>0}}).data,R=Digit.UserService.getUser(),M=window.Digit.Utils.browser.isMobile(),b=M?{limit:100,offset:0,sortOrder:null!=h&&null!==(r=h[0])&&void 0!==r&&r.desc?"DESC":"ASC"}:{limit:A,offset:D,sortOrder:null!=h&&null!==(a=h[0])&&void 0!==a&&a.desc?"DESC":"ASC"},P=Digit.Hooks.fsm.useSearch(E,{applicationNos:null==S?void 0:S.refernceNos,uuid:R.uuid},{staleTime:Infinity}).data,F=Digit.Hooks.fsm.useDsoSearch(E,{name:null==S?void 0:S.name,status:"ACTIVE"},{enabled:(null==S||null===(o=S.name)||void 0===o?void 0:o.length)>1}).data,k=c({businessService:"FSM_VEHICLE_TRIP",refernceNos:void 0!==P&&(null==S||null===(u=S.refernceNos)||void 0===u?void 0:u.length)>0?(null==P?void 0:P.applicationNo)||"null":"",vehicleIds:void 0!==L&&(null==S||null===(s=S.registrationNumber)||void 0===s?void 0:s.length)>0?(null==L||null===(d=L.vehicle)||void 0===d||null===(v=d[0])||void 0===v?void 0:v.id)||"null":"",tripOwnerIds:void 0!==F&&(null==S||null===(m=S.name)||void 0===m?void 0:m.length)>0?(null==F||null===(f=F[0])||void 0===f?void 0:f.ownerId)||"null":"",applicationStatus:null==S?void 0:S.applicationStatus},b);null==P&&(k={responseInfo:{apiId:"Rainmaker",ver:null,ts:null,resMsgId:"uief87324",msgId:"1645827148736|en_IN",status:"successful"},vehicle:[],totalCount:0});var w=Digit.Hooks.fsm.useVehicleSearch({tenantId:E,filters:k,config:ce,options:{searchWithDSO:!0}}),x=w.isLoading,H=w.data,V=void 0===H?{}:H,U=V.totalCount,B=V.vehicleLog,Y=function(e){void 0===e&&(e={}),g(c({applicationStatus:"WAITING_FOR_DISPOSAL"},e))},z=function(){},W=[{label:p("ES_SEARCH_APPLICATION_APPLICATION_NO"),name:"refernceNos"},{label:p("ES_FSTP_OPERATOR_VEHICLE_NO"),name:"registrationNumber"},{label:p("ES_FSTP_DSO_NAME"),name:"name"}],j=n.useCallback(function(e){0!==(null==e?void 0:e.length)&&T(e)},[]);return M?i.createElement("div",null,i.createElement(t.Header,null,p("ES_COMMON_INBOX")),i.createElement(K,{onFilterChange:z,vehicleLog:B,isLoading:x,userRole:"FSM_EMP_FSTPO",linkPrefix:"/digit-ui/employee/fsm/fstp-operator-details/",onSearch:Y,searchFields:W,onSort:j,sortParams:h})):i.createElement(i.Fragment,null,i.createElement("div",{style:{marginLeft:"20px"}},i.createElement(t.Header,null,p("ES_COMMON_INBOX"))),i.createElement(G,{data:{table:B},isLoading:x,onSort:j,disableSort:!1,sortParams:h,userRole:"FSM_EMP_FSTPO",onFilterChange:z,searchFields:W,onSearch:Y,onNextPage:function(){C(function(e){return e+A})},onPrevPage:function(){C(function(e){return e-A})},currentPage:Math.floor(D/A),pageSizeLimit:A,onPageSizeChange:function(e){O(Number(e.target.value))},totalRecords:U||0}))},FSMNewApplicationEmp:function(e){var a=Digit.ULBService.getCurrentTenantId(),o=Digit.ULBService.getStateId(),u=Digit.Hooks.fsm.useMDMS(o,"FSM","CommonFieldsConfig"),s=u.data,d=u.isLoading,v=Digit.Hooks.fsm.useMDMS(o,"FSM","PreFieldsConfig"),m=v.data,f=v.isLoading,p=Digit.Hooks.fsm.useMDMS(o,"FSM","PostFieldsConfig").isLoading,E=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],_=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],S=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2];n.useEffect(function(){E(!1),S(),_()},[]);var g=l.useTranslation().t,y=r.useHistory(),h=n.useState(!1),T=h[0],I=h[1];if(d||p||f)return i.createElement(t.Loader,null);var D=[].concat(m,s);return i.createElement(i.Fragment,null,i.createElement("div",{style:{marginLeft:"15px"}},i.createElement(t.Header,null,g("ES_TITLE_NEW_DESULDGING_APPLICATION"))),i.createElement(t.FormComposer,{isDisabled:!T,label:g("ES_COMMON_APPLICATION_SUBMIT"),config:D.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},formCardStyle:!0,onSubmit:function(e){var t,n,i,l,r,o,u,s,d,v,m,f,p,E,_,S,g,h,T,I,D,C,N,A,O,L=e.channel,R=null==e||null===(t=e.pitType)||void 0===t?void 0:t.code,M=null==e?void 0:e.pitDetail,b=e.applicationData.applicantName,P=e.applicationData.mobileNumber,F=null==e||null===(n=e.address)||void 0===n?void 0:n.pincode,k=null==e||null===(i=e.address)||void 0===i||null===(l=i.street)||void 0===l?void 0:l.trim(),w=null==e||null===(r=e.address)||void 0===r||null===(o=r.doorNo)||void 0===o?void 0:o.trim(),x=null==e||null===(u=e.address)||void 0===u?void 0:u.slum,H=null==e||null===(s=e.address)||void 0===s||null===(d=s.landmark)||void 0===d?void 0:d.trim(),V=null==e||null===(v=e.tripData)||void 0===v?void 0:v.noOfTrips,U=e.tripData.amountPerTrip,B=null==e||null===(m=e.address)||void 0===m||null===(f=m.city)||void 0===f?void 0:f.code,Y=null==e||null===(p=e.address)||void 0===p||null===(E=p.city)||void 0===E?void 0:E.name,G=null==e||null===(_=e.address)||void 0===_||null===(S=_.city)||void 0===S?void 0:S.state,z=null==e||null===(g=e.address)||void 0===g||null===(h=g.locality)||void 0===h?void 0:h.code,W=null==e||null===(T=e.address)||void 0===T||null===(I=T.locality)||void 0===I?void 0:I.name,j=0===U?null:null!=e&&e.paymentPreference?null==e?void 0:e.paymentPreference:null,K=0===U?null:null==e||null===(D=e.advancepaymentPreference)||void 0===D?void 0:D.advanceAmount,X={fsm:{citizen:{name:b,mobileNumber:P,gender:e.applicationData.applicantGender},tenantId:a,sanitationtype:R,source:L.code,additionalDetails:{tripAmount:U},propertyUsage:null==e?void 0:e.subtype,vehicleCapacity:null==e||null===(C=e.tripData)||void 0===C||null===(N=C.vehicleType)||void 0===N?void 0:N.capacity,pitDetail:c({},M,{distanceFromRoad:null==e?void 0:e.distanceFromRoad}),address:{tenantId:B,landmark:H,doorNo:w,street:k,city:Y,state:G,pincode:F,slumName:x,locality:{code:z,name:W},geoLocation:{latitude:null==e||null===(A=e.address)||void 0===A?void 0:A.latitude,longitude:null==e||null===(O=e.address)||void 0===O?void 0:O.longitude}},noOfTrips:V,paymentPreference:j,advanceAmount:K},workflow:null};window.Digit.SessionStorage.set("propertyType",null),window.Digit.SessionStorage.set("subType",null),Digit.SessionStorage.set("city_property",null),Digit.SessionStorage.set("selected_localities",null),Digit.SessionStorage.set("locality_property",null),y.push("/digit-ui/employee/fsm/response",X)},defaultValues:{tripData:{noOfTrips:1,amountPerTrip:null,amount:null}},onFormValueChange:function(e,t){var n,i,l,r,a;if(null!=t&&t.propertyType&&null!=t&&t.subtype&&null!=t&&null!==(n=t.address)&&void 0!==n&&null!==(i=n.locality)&&void 0!==i&&i.code&&null!=t&&null!==(l=t.tripData)&&void 0!==l&&l.vehicleType&&null!=t&&t.channel&&(null!=t&&null!==(r=t.tripData)&&void 0!==r&&r.amountPerTrip||0===(null==t||null===(a=t.tripData)||void 0===a?void 0:a.amountPerTrip))){var o,u,c,s;I(!0);var d,v,m=null!=t&&t.pitDetail?Object.values(null==t?void 0:t.pitDetail).filter(function(e){return e>0}):null,f=Digit.SessionStorage.get("total_amount"),p=Digit.SessionStorage.get("advance_amount");null!=t&&t.pitType&&(null===m||0===(null==m?void 0:m.length)||me(null==t||null===(d=t.pitType)||void 0===d?void 0:d.dimension)&&(null==m?void 0:m.length)>=3||!me(null==t||null===(v=t.pitType)||void 0===v?void 0:v.dimension)&&(null==m?void 0:m.length)>=2?I(!0):I(!1)),0!==(null==t||null===(o=t.tripData)||void 0===o?void 0:o.amountPerTrip)&&((null==t||null===(u=t.advancepaymentPreference)||void 0===u?void 0:u.advanceAmount)<p||(null==t||null===(c=t.advancepaymentPreference)||void 0===c?void 0:c.advanceAmount)>f||""===(null==t||null===(s=t.advancepaymentPreference)||void 0===s?void 0:s.advanceAmount))&&I(!1)}else I(!1)},noBreakLine:!0,fms_inline:!0}))},FSMEditApplication:function(e){var t=Digit.ULBService.getCurrentTenantId(),n=Digit.ULBService.getStateId(),l=r.useParams().id,a=Digit.UserService.getUser(),o=Digit.Hooks.fsm.useSearch(t,{applicationNos:l,uuid:a.uuid},{staleTime:Infinity}),u=o.isLoading,c=o.data,s=Digit.Hooks.fsm.useMDMS(n,"Vehicle","VehicleType",{staleTime:Infinity}),d=s.isLoading,v=s.data,m=Digit.Hooks.fsm.useMDMS(t,"FSM","ApplicationChannel"),f=m.isLoading,p=m.data,E=Digit.Hooks.fsm.useMDMS(n,"FSM","PitType"),_=E.data;return c&&!u&&v&&!d&&p&&!f&&!E.isLoading&&_?i.createElement(ue,{applicationData:c,vehicleMenu:v,channelMenu:p,sanitationMenu:_,tenantId:t}):null},FSMEmployeeApplicationDetails:function(e){var a,u,c,s,d,v,m,f,p,E,_,S,g,y,h,T,I,D,C,A,O,L,R,M,b,P,F,k,w,x,H,V,U=Digit.ULBService.getCurrentTenantId(),B=Digit.ULBService.getStateId(),Y=l.useTranslation().t,G=r.useHistory(),z=o.useQueryClient(),W=r.useParams().id,j=n.useState(!1),K=j[0],X=j[1],q=n.useState(null),Z=q[0],Q=q[1],$=(n.useState({}),n.useState(!1)),J=$[0],ee=$[1],te=n.useState(null),ne=te[0],ie=te[1],le=n.useState(null),oe=le[0],ue=le[1],ce=Digit.UserService.hasAccess(["FSM_DSO"])||!1,se=Digit.Hooks.fsm.useApplicationDetail(Y,U,W,{},e.userType),de=se.isLoading,ve=se.data,me=Digit.Hooks.fsm.useSearch(U,{applicationNos:W},{staleTime:Infinity}),fe=me.isLoading,pe=me.data,Ee=Digit.Hooks.fsm.useApplicationActions(U).mutate,_e=Digit.Hooks.useWorkflowDetails({tenantId:(null==ve?void 0:ve.tenantId)||U,id:W,moduleCode:"POST_PAY"===(null==pe?void 0:pe.paymentPreference)?"FSM_POST_PAY_SERVICE":0===(null==pe?void 0:pe.advanceAmount)?"PAY_LATER_SERVICE":(null==pe?void 0:pe.advanceAmount)>0?"FSM_ADVANCE_PAY_SERVICE":null===(null==pe?void 0:pe.paymentPreference)&&0===(null==pe||null===(a=pe.additionalDetails)||void 0===a?void 0:a.tripAmount)&&null===(null==pe?void 0:pe.advanceAmount)?"FSM_ZERO_PAY_SERVICE":"FSM",role:ce?"FSM_DSO":"FSM_EMPLOYEE",serviceData:ve,getTripData:!ce});function Se(e){Q(e),X(!1)}n.useEffect(function(){ne&&_e.revalidate()},[ne]),n.useEffect(function(){switch(Z){case ce&&"SCHEDULE":case"DSO_ACCEPT":case"ACCEPT":case"ASSIGN":case"GENERATE_DEMAND":case"FSM_GENERATE_DEMAND":case"REASSIGN":case"COMPLETE":case"COMPLETED":case"CANCEL":case"SENDBACK":case"DSO_REJECT":case"REJECT":case"DECLINE":case"REASSING":case"UPDATE":return ee(!0);case"SUBMIT":case"FSM_SUBMIT":case!ce&&"SCHEDULE":return G.push("/digit-ui/employee/fsm/modify-application/"+W);case"PAY":case"FSM_PAY":case"ADDITIONAL_PAY_REQUEST":return G.push("/digit-ui/employee/payment/collect/FSM.TRIP_CHARGES/"+W+"?workflow=FSM")}},[Z]);var ge=function(){Q(null),ee(!1)},ye=function(){ie(null)};function he(e,t){ue(e)}var Te=function(e){var n,l=null==e||null===(n=e.comment)||void 0===n?void 0:n.split("~"),a=l?l[0]:null,o=l?l[1]:null;if("CREATED"===e.status){var u,c,s={date:null==e||null===(u=e.auditDetails)||void 0===u?void 0:u.created,name:null==e?void 0:e.assigner,mobileNumber:null==pe||null===(c=pe.citizen)||void 0===c?void 0:c.mobileNumber,source:(null==pe?void 0:pe.source)||""};return i.createElement(N,{data:s})}if("PENDING_APPL_FEE_PAYMENT"===e.status||"DSO_REJECTED"===e.status||"CANCELED"===e.status||"REJECTED"===e.status){var d,v={date:null==e||null===(d=e.auditDetails)||void 0===d?void 0:d.created,name:null==e?void 0:e.assigner,comment:a?Y("ES_ACTION_REASON_"+a):null,otherComment:o||null};return i.createElement(N,{data:v})}if("DSO_INPROGRESS"===e.status){var m,f={name:null==e?void 0:e.assigner,mobileNumber:null==e||null===(m=e.assigner)||void 0===m?void 0:m.mobileNumber,date:Y("CS_FSM_EXPECTED_DATE")+" "+Digit.DateUtils.ConvertTimestampToDate(null==pe?void 0:pe.possibleServiceDate)};return i.createElement(N,{data:f})}if("COMPLETED"===e.status)return i.createElement("div",null,i.createElement(t.Rating,{withText:!0,text:Y("ES_FSM_YOU_RATED"),currentRating:e.rating}),i.createElement(r.Link,{to:"/digit-ui/employee/fsm/rate-view/"+W},i.createElement(t.ActionLinks,null,Y("CS_FSM_RATE_VIEW"))));if("WAITING_FOR_DISPOSAL"===e.status||"DISPOSAL_IN_PROGRESS"===e.status||"DISPOSED"===e.status||"CITIZEN_FEEDBACK_PENDING"===e.status){var p,E,_={date:null==e||null===(p=e.auditDetails)||void 0===p?void 0:p.created,name:null==e?void 0:e.assigner,mobileNumber:null==e||null===(E=e.assigner)||void 0===E?void 0:E.mobileNumber};return null!=e&&e.numberOfTrips&&(_.comment=Y("NUMBER_OF_TRIPS")+": "+(null==e?void 0:e.numberOfTrips)),i.createElement(N,{data:_})}};return de?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,de?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement(t.Header,{style:{marginBottom:"16px"}},Y("ES_TITLE_APPLICATION_DETAILS")),i.createElement(t.Card,{className:"fsm",style:{position:"relative"}},null==ve?void 0:ve.applicationDetails.map(function(e,n){var l;return i.createElement(i.Fragment,{key:n},0===n?null:i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},Y(e.title)),i.createElement(t.StatusTable,null,null==e||null===(l=e.values)||void 0===l?void 0:l.map(function(n,l){var r;if(null!==n)return i.createElement(t.Row,!0===n.map&&"N/A"!==n.value?{key:Y(n.title),label:Y(n.title),text:i.createElement("img",{src:Y(n.value),alt:""})}:{key:Y(n.title),label:Y(n.title),text:Y(n.value)||"N/A",last:l===(null==e||null===(r=e.values)||void 0===r?void 0:r.length)-1,caption:n.caption,className:"border-none"})})))}),(null==pe||null===(u=pe.pitDetail)||void 0===u||null===(c=u.additionalDetails)||void 0===c||null===(s=c.fileStoreId)||void 0===s||null===(d=s.CITIZEN)||void 0===d?void 0:d.length)&&i.createElement(n.Fragment,null,i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},Y("ES_FSM_SUB_HEADING_CITIZEN_UPLOADS")),i.createElement(ae,{fileStoreIds:null==pe||null===(v=pe.pitDetail)||void 0===v||null===(m=v.additionalDetails)||void 0===m||null===(f=m.fileStoreId)||void 0===f?void 0:f.CITIZEN,tenantId:B,onClick:function(e,t){return he(e)}})),(null==pe||null===(p=pe.pitDetail)||void 0===p||null===(E=p.additionalDetails)||void 0===E||null===(_=E.fileStoreId)||void 0===_||null===(S=_.FSM_DSO)||void 0===S?void 0:S.length)&&i.createElement(n.Fragment,null,i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},Y("ES_FSM_SUB_HEADING_DSO_UPLOADS")),i.createElement(ae,{fileStoreIds:null==pe||null===(g=pe.pitDetail)||void 0===g||null===(y=g.additionalDetails)||void 0===y||null===(h=y.fileStoreId)||void 0===h?void 0:h.FSM_DSO,tenantId:U,onClick:function(e,t){return he(e)}})),oe?i.createElement(t.ImageViewer,{imageSrc:oe,onClose:function(){ue(null)}}):null,i.createElement(t.BreakLine,null),((null==_e?void 0:_e.isLoading)||fe)&&i.createElement(t.Loader,null),!(null!=_e&&_e.isLoading)&&!fe&&i.createElement(n.Fragment,null,i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},Y("ES_APPLICATION_DETAILS_APPLICATION_TIMELINE")),null!=_e&&null!==(T=_e.data)&&void 0!==T&&T.timeline&&1===(null==_e||null===(I=_e.data)||void 0===I||null===(D=I.timeline)||void 0===D?void 0:D.length)?i.createElement(t.CheckPoint,{isCompleted:!0,label:Y("CS_COMMON_"+(null==_e||null===(C=_e.data)||void 0===C||null===(A=C.timeline[0])||void 0===A?void 0:A.status)),customChild:Te(null==_e||null===(O=_e.data)||void 0===O?void 0:O.timeline[0])}):i.createElement(t.ConnectingCheckPoints,null,(null==_e||null===(L=_e.data)||void 0===L?void 0:L.timeline)&&(null==_e||null===(R=_e.data)||void 0===R?void 0:R.timeline.map(function(e,n,l){return i.createElement(i.Fragment,{key:n},i.createElement(t.CheckPoint,{keyValue:n,isCompleted:0===n,label:Y("CS_COMMON_FSM_"+("UPDATE"===e.performedAction?"UPDATE_":"")+e.status),customChild:Te(e)}))}))))),J?i.createElement(re,{t:Y,action:Z,tenantId:U,state:B,id:W,closeModal:ge,submitAction:function(e){Ee(e,{onError:function(e,t){ie({key:"error",action:e}),setTimeout(ye,5e3)},onSuccess:function(e,t){ie({key:"success",action:Z}),setTimeout(ye,5e3),z.invalidateQueries("FSM_CITIZEN_SEARCH");var n=z.getQueryData("FUNCTION_RESET_INBOX");null==n||n.revalidate()}}),ge()},actionData:null==_e||null===(M=_e.data)||void 0===M?void 0:M.timeline,module:null==_e||null===(b=_e.data)||void 0===b?void 0:b.applicationBusinessService}):null,ne&&i.createElement(t.Toast,{error:"error"===ne.key,label:Y("success"===ne.key?"ES_FSM_"+ne.action+"_UPDATE_SUCCESS":ne.action),onClose:ye}),!(null!=_e&&_e.isLoading)&&1===(null==_e||null===(P=_e.data)||void 0===P||null===(F=P.nextActions)||void 0===F?void 0:F.length)&&i.createElement(t.ActionBar,{style:{zIndex:"19"}},i.createElement(t.SubmitBar,{label:Y("ES_FSM_"+(null==_e||null===(k=_e.data)||void 0===k?void 0:k.nextActions[0].action)),onSubmit:function(){var e;return Se(null==_e||null===(e=_e.data)||void 0===e?void 0:e.nextActions[0].action)}})),!(null!=_e&&_e.isLoading)&&(null==_e||null===(w=_e.data)||void 0===w||null===(x=w.nextActions)||void 0===x?void 0:x.length)>1&&i.createElement(t.ActionBar,{style:{zIndex:"19"}},K&&null!=_e&&null!==(H=_e.data)&&void 0!==H&&H.nextActions?i.createElement(t.Menu,{localeKeyPrefix:"ES_FSM",options:null==_e||null===(V=_e.data)||void 0===V?void 0:V.nextActions.map(function(e){return e.action}),t:Y,onSelect:Se}):null,i.createElement(t.SubmitBar,{label:Y("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return X(!K)}}))))},FSMFstpOperatorDetails:function(){var e,a,u,c,s,d,v,m,f,p,E,_,S,g,y,h=Digit.ULBService.getStateId(),T=window.Digit.Utils.browser.isMobile(),I=l.useTranslation().t,D=r.useHistory(),C=o.useQueryClient(),N=Digit.ULBService.getCurrentTenantId(),A=Digit.ULBService.getStateId(),O=r.useParams().id,L=n.useState(null!=O?{applicationNos:O}:{applicationNos:"null"})[0],R=n.useState(!1),M=R[0],b=R[1],P=n.useState({}),F=P[0],k=P[1],w=n.useState(null),x=w[0],H=w[1],V=n.useState(null),U=V[0],B=V[1],Y=n.useState({}),G=Y[0],z=Y[1],W=n.useState(null),j=W[0],K=W[1],X=n.useState(function(){var e=new Date;return(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()}),q=X[0],Z=X[1],Q=n.useState(!1),$=Q[0],J=Q[1],ee=n.useState(null),te=ee[0],ne=ee[1],ie=n.useState(!1),le=ie[0],ae=ie[1],oe=n.useState(),ue=oe[0],ce=oe[1],me=n.useState(),fe=me[0],pe=me[1],Ee=n.useState(),_e=Ee[0],Se=Ee[1],ge=n.useState(),ye=ge[0],he=ge[1],Te=n.useRef(),Ie=n.useRef(),De=n.useRef(),Ce=(n.useState(),n.useState(null)[1]),Ne=n.useState(Array),Ae=Ne[0],Oe=Ne[1],Le=(n.useState(null),n.useState(O)),Re=Le[0],Me=Le[1],be=n.useState(null),Pe=be[0],Fe=be[1],ke=n.useState(null),we=ke[0],xe=ke[1],He=n.useState(),Ve=He[0],Ue=He[1],Be=r.useLocation(),Ye=Digit.Hooks.fsm.useVehicleSearch({tenantId:N,totalconfig:ve}),Ge=Ye.isSuccess,ze=Ye.data,We=Digit.Hooks.fsm.useVehicleSearch({tenantId:N,filters:L,config:de}),je=We.isLoading,Ke=We.isSuccess,Xe=We.data,qe=Digit.Hooks.fsm.useSearchAll(N,F,null,{enabled:!!M}),Ze=qe.isLoading,Qe=qe.isIdle,$e=qe.data,Je=(void 0===$e?{}:$e).data,et=(void 0===Je?{}:Je).table;n.useEffect(function(){he(0==(null==_e?void 0:_e.length)?1:ue-(null==_e?void 0:_e.length)+1)},[ue,_e,ze,Ge,Ke]);var tt=Digit.Hooks.useWorkflowDetails({tenantId:N,id:Be.pathname.includes("fstp-operator-details")?O:null,moduleCode:"FSM_VEHICLE_TRIP",role:"FSM_EMP_FSTPO"}),nt=Digit.Hooks.fsm.useVehicleUpdate(N),it=Digit.Hooks.fsm.useVehicleTripCreate(N);n.useEffect(function(){if(Ke){var e,t;B(null==Xe||null===(e=Xe.vehicle)||void 0===e?void 0:e.tankCapacity);var n=null==Xe||null===(t=Xe.tripDetails)||void 0===t?void 0:t.map(function(e){return e.referenceNo}).join(",");k(n?{applicationNos:n}:{applicationNos:"null"}),b(!0)}},[Ke]),n.useEffect(function(){var e,t;Qe||Ze||!et||(ce(null===(e=et[0])||void 0===e?void 0:e.noOfTrips),pe(null===(t=et[0])||void 0===t?void 0:t.applicationNo))},[Ze,Qe,et]),n.useEffect(function(){switch(te){case"DECLINEVEHICLE":return ae(!0);case"DISPOSE":case"READY_FOR_DISPOSAL":ne(null),D.location.pathname.includes("new")?rt():lt();default:ne(),console.debug("default case")}},[te]),n.useEffect(function(){if(Ge){var e,t=null==ze||null===(e=ze.vehicleTrip)||void 0===e?void 0:e.filter(function(e,t,n){var i;return(null==e||null===(i=e.tripDetails[0])||void 0===i?void 0:i.referenceNo)===fe&&"WAITING_FOR_DISPOSAL"===(null==e?void 0:e.applicationStatus)});Se(t)}},[Ge,ze,Ke,Qe,fe]);var lt=function(){var e=et.reduce(function(e,t){return e+t.volume},0);if(O&&(!U||U>e||U>Xe.vehicle.tankCapacity))return z({wasteRecieved:"ES_FSTP_INVALID_WASTE_AMOUNT"}),void Te.current.scrollIntoView({behavior:"smooth",block:"center"});if(null===j)return z({tripStartTime:"ES_FSTP_INVALID_START_TIME"}),void Ie.current.scrollIntoView({behavior:"smooth",block:"center"});if(null===q)return z({tripTime:"ES_FSTP_INVALID_TRIP_TIME"}),void De.current.scrollIntoView({behavior:"smooth",block:"center"});if(j===q||j>q)return z({tripTime:"ES_FSTP_INVALID_TRIP_TIME"}),void De.current.scrollIntoView({behavior:"smooth",block:"center"});z({});var t=new Date,n=Date.parse(new Date(t.toString().split(":")[0].slice(0,-2)+q))/1e3,i=Date.parse(new Date(t.toString().split(":")[0].slice(0,-2)+j))/1e3,l={tripNo:ye};Xe.tripStartTime=i,Xe.fstpEntryTime=i,Xe.tripEndTime=n,Xe.fstpExitTime=n,Xe.volumeCarried=U,Xe.tripDetails[0].additionalDetails=l,Xe.additionalDetails={fileStoreId:Ae,comments:Ve},nt.mutate({vehicleTrip:[Xe],workflow:{action:"DISPOSE"}},{onSuccess:ot,onError:ut})},rt=function(){var e,t,n;if(!new RegExp("^[A-Z]{2}\\s{1}[0-9]{2}\\s{0,1}[A-Z]{1,2}\\s{1}[0-9]{4}$").test(Re))return H({key:"error",action:"ES_FSM_VEHICLE_FORMAT_TIP"}),void setTimeout(function(){at()},5e3);if(null===we||0===(null==we||null===(e=we.trim())||void 0===e?void 0:e.length))return H({key:"error",action:"ES_FSTP_INVALID_DSO_NAME"}),void setTimeout(function(){at()},2e3);if(null===Pe||0===(null==Pe||null===(t=Pe.trim())||void 0===t?void 0:t.length))return H({key:"error",action:"ES_FSTP_INVALID_LOCALITY"}),void setTimeout(function(){at()},2e3);if(null===j)return z({tripStartTime:"ES_FSTP_INVALID_START_TIME"}),void Ie.current.scrollIntoView({behavior:"smooth",block:"center"});if(!U||0===(null==U||null===(n=U.trim())||void 0===n?void 0:n.length))return H({key:"error",action:"ES_FSTP_INVALID_WASTE_AMOUNT"}),void setTimeout(function(){at()},2e3);if(null===q)return z({tripTime:"ES_FSTP_INVALID_TRIP_TIME"}),void De.current.scrollIntoView({behavior:"smooth",block:"center"});if(j===q||j>q)return z({tripTime:"ES_FSTP_INVALID_TRIP_TIME"}),void De.current.scrollIntoView({behavior:"smooth",block:"center"});z({});var i={},l=new Date,r=Date.parse(new Date(l.toString().split(":")[0].slice(0,-2)+q))/1e3,a=Date.parse(new Date(l.toString().split(":")[0].slice(0,-2)+j))/1e3;i.tenantId=N,i.status="ACTIVE",i.tripStartTime=a,i.tripEndTime=r,i.volumeCarried=U,i.additionalDetails={vehicleNumber:Re||O,dsoName:we,locality:Pe,fileStoreId:Ae,comments:Ve},i.businessService="FSM_VEHICLE_TRIP",i.tripDetails=[{tenantId:N,status:"ACTIVE"}],it.mutate({vehicleTrip:[i]},{onSuccess:ot,onError:ut})},at=function(){H(null)},ot=function(){"DECLINEVEHICLE"===te&&ae(!1),C.invalidateQueries("FSM_VEHICLE_DATA"),H({key:"success",action:"ES_FSM_DISPOSE_UPDATE_SUCCESS"}),setTimeout(function(){at(),D.push("/digit-ui/employee/fsm/fstp-operations")},5e3)},ut=function(){"DECLINEVEHICLE"===te&&(ae(!1),ne(null)),C.invalidateQueries("FSM_VEHICLE_DATA"),H({key:"error",action:"ES_FSM_DISPOSE_UPDATE_FAILURE"}),setTimeout(function(){at()},5e3)};if(je)return i.createElement(t.Loader,null);var ct=[{title:I("ES_INBOX_VEHICLE_NO")+" *",value:(null==Xe||null===(e=Xe.vehicle)||void 0===e?void 0:e.registrationNumber)||O||i.createElement(t.TextInput,{onChange:function(e){Me(e.target.value)},value:Re})},{title:I("ES_INBOX_DSO_NAME")+" *",value:(null==Xe||null===(a=Xe.tripOwner)||void 0===a?void 0:a.name)||i.createElement(t.TextInput,{onChange:function(e){xe(e.target.value)},value:we})},{title:I("ES_INBOX_LOCALITY")+" *",value:et&&(null===(u=et[0])||void 0===u||null===(c=u.address)||void 0===c||null===(s=c.locality)||void 0===s?void 0:s.name)||i.createElement(t.TextInput,{onChange:function(e){Fe(e.target.value)},value:Pe})}],st=function(e,t){"string"==typeof e&&t(e)};function dt(e){ne(e),J(!1)}return i.createElement("div",null,i.createElement(t.Header,{styles:{marginLeft:"16px"}},I("ES_INBOX_VEHICLE_LOG")),i.createElement(t.Card,null,i.createElement(t.StatusTable,null,null==ct?void 0:ct.map(function(e,n){return i.createElement(t.Row,{rowContainerStyle:T&&D.location.pathname.includes("new-vehicle-entry")?{display:"block"}:{justifyContent:"space-between"},textStyle:T&&D.location.pathname.includes("new-vehicle-entry")?{width:"100%"}:{},key:e.title,label:e.title,text:e.value||"N/A",last:!1,labelStyle:{fontWeight:"normal"}})}),i.createElement("div",{ref:Ie},i.createElement(t.CardLabelError,null,I(G.tripStartTime))),i.createElement("form",null,i.createElement(t.Row,{key:I("ES_VEHICLE_IN_TIME"),label:I("ES_VEHICLE_IN_TIME")+" * ",labelStyle:{minWidth:"fit-content",fontWeight:"normal"},textStyle:T?{width:"100%"}:{},rowContainerStyle:T?{display:"block"}:{justifyContent:"space-between"},text:i.createElement("div",null,i.createElement(se,{name:"tripStartTime",onChange:function(e){return st(e,K)},value:j}))}),i.createElement("div",{ref:Te},i.createElement(t.CardLabelError,null,I(G.wasteRecieved))),i.createElement(t.Row,{key:I("ES_VEHICLE_SEPTAGE_DUMPED"),label:I("ES_VEHICLE_SEPTAGE_DUMPED")+" * ",labelStyle:{minWidth:"fit-content",fontWeight:"normal"},textStyle:T?{width:"100%"}:{},text:i.createElement("div",null,i.createElement(t.TextInput,{type:"number",name:"wasteRecieved",value:U,onChange:function(e){var t=e.target,n=t.name,i=t.value;"tripTime"===n?Z(i):"wasteRecieved"===n&&B(i)}})),rowContainerStyle:T?{display:"block"}:{justifyContent:"space-between"}}),i.createElement("div",{ref:De},i.createElement(t.CardLabelError,null,I(G.tripTime))),i.createElement(t.Row,{key:I("ES_VEHICLE_OUT_TIME"),label:I("ES_VEHICLE_OUT_TIME")+" * ",labelStyle:{minWidth:"fit-content",fontWeight:"normal"},textStyle:T?{width:"100%"}:{},rowContainerStyle:T?{display:"block"}:{justifyContent:"space-between"},text:i.createElement("div",null,i.createElement(se,{name:"tripTime",onChange:function(e){return st(e,Z)},value:q}))}),i.createElement("div",{className:!T&&"row",style:T?{}:{diplay:"flex",justifyContent:"space-between",alignItems:"center"}},i.createElement(t.CardLabel,{style:{fontWeight:"normal"}}," ",I("ES_FSM_ADDITIONAL_DETAILS")," "),i.createElement(t.TextArea,{className:"form-field",onChange:function(e){e.target.value.length>1024||Ue(e.target.value)},style:T?{width:"100%"}:{width:"100%",marginLeft:"35%"}})),i.createElement(t.Row,{key:I("ES_FSM_ATTACHMENTS"),label:""+I("ES_FSM_ATTACHMENT"),labelStyle:{minWidth:"fit-content",fontWeight:"normal"},textStyle:T?{width:"100%"}:{},rowContainerStyle:T?{display:"block"}:{justifyContent:"space-between",alignItems:"center"},text:i.createElement(t.MultiUploadWrapper,{t:I,module:"fsm",tenantId:h,getFormState:function(e){return function(e){var t=Object.fromEntries(e),n=Object.values(t);!function(e){if(e){var t,n=[].concat(Ae,[null==e||null===(t=e.fileStoreId)||void 0===t?void 0:t.fileStoreId]);Oe(n),e&&Ce(e.file)}}(n[n.length-1])}(e)}})}),!(null!=tt&&tt.isLoading)&&(null==tt||null===(d=tt.data)||void 0===d||null===(v=d.nextActions)||void 0===v?void 0:v.length)>0&&(1===(null==tt||null===(m=tt.data)||void 0===m||null===(f=m.nextActions)||void 0===f?void 0:f.length)?i.createElement(t.ActionBar,null,i.createElement(t.SubmitBar,{label:I("CS_ACTION_"+(null==tt||null===(p=tt.data)||void 0===p||null===(E=p.nextActions)||void 0===E||null===(_=E[0])||void 0===_?void 0:_.action)),onSubmit:function(){var e,t,n;return dt(null==tt||null===(e=tt.data)||void 0===e||null===(t=e.nextActions)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.action)}})):i.createElement(t.ActionBar,null,$&&null!=tt&&null!==(S=tt.data)&&void 0!==S&&S.nextActions?i.createElement(t.Menu,{localeKeyPrefix:"",options:null==tt||null===(g=tt.data)||void 0===g?void 0:g.nextActions.map(function(e){return e.action}),t:I,onSelect:dt}):null,i.createElement(t.SubmitBar,{label:I("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return J(!$)}})))),le?i.createElement(re,{t:I,action:te,tenantId:N,state:A,id:O,closeModal:function(){ne(null),ae(!1)},submitAction:function(e){var t,n;Xe.additionalDetails={comments:null==e||null===(t=e.workflow)||void 0===t?void 0:t.comments,vehicleDeclineReason:null==e||null===(n=e.workflow)||void 0===n?void 0:n.fstpoRejectionReason},nt.mutate({vehicleTrip:[Xe],workflow:{action:"DECLINEVEHICLE"}},{onSuccess:ot,onError:ut})},actionData:null==tt||null===(y=tt.data)||void 0===y?void 0:y.timeline}):null)),x&&i.createElement(t.Toast,{error:"error"===x.key,label:I(x.action),onClose:at}))},FSMResponse:function(e){var a,u,s,d,v,m,f,p,E,_,S,g,y,h,T=r.useHistory(),D=n.useState(null),C=D[0],N=D[1],A=l.useTranslation().t,O=o.useQueryClient(),L=Digit.UserService.hasAccess("FSM_COLLECTOR"),R=Digit.UserService.hasAccess("FSM_EDITOR_EMP")||!1,M=Digit.UserService.hasAccess("CITIZEN")||window.location.pathname.includes("citizen")||!1,b=Digit.ULBService.getCurrentTenantId(),P=Digit.ULBService.getStateId(),F=e.location.state,k="update"===F.key?Digit.Hooks.fsm.useApplicationActions(b):Digit.Hooks.fsm.useDesludging(b),w=(Digit.Hooks.useStore.getInitData().data||{}).tenants,x=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1),H=x[0],V=x[1],U=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1),B=U[0],Y=U[1],G=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1),z=G[0],W=G[1],j=n.useState(!1),K=j[0],X=j[1],q=n.useState(null),Z=q[0],Q=q[1],$=function(e,t){var n,i,l;Y((null==e||null===(n=e.response)||void 0===n||null===(i=n.data)||void 0===i||null===(l=i.Errors[0])||void 0===l?void 0:l.code)||(null==e?void 0:e.message)||"ERROR"),V(!0)};n.useEffect(function(){k.data&&W(k.data)},[k.data]);var J=null==k||null===(a=k.data)||void 0===a||null===(u=a.fsm)||void 0===u||null===(s=u[0].address)||void 0===s||null===(d=s.locality)||void 0===d?void 0:d.code,ee=null==k||null===(v=k.data)||void 0===v||null===(m=v.fsm)||void 0===m||null===(f=m[0].address)||void 0===f?void 0:f.slumName,te=Digit.Hooks.fsm.useSlum(null==k||null===(p=k.data)||void 0===p||null===(E=p.fsm)||void 0===E||null===(_=E[0])||void 0===_?void 0:_.tenantId,ee,J,{enabled:!!ee,retry:!!ee}),ne=Digit.Hooks.fsm.useMDMS(P,"Vehicle","VehicleType",{staleTime:Infinity}).data,ie=(null==k?void 0:k.data)||z,le=function(e,t){return(null==e?void 0:e.i18nKey)&&(null==e?void 0:e.capacity)&&t(e.i18nKey)+" - "+e.capacity+" "+t("CS_COMMON_CAPACITY_LTRS")||null}(null==ne?void 0:ne.find(function(e){var t,n;return(null==ie||null===(t=ie.fsm)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.vehicleType)===(null==e?void 0:e.code)}),A),re=null===(S=ie.fsm)||void 0===S?void 0:S[0].applicationNo,ae=Digit.Hooks.fsm.usePaymentHistory(b,re).data,oe=function(){N(null)};function ue(e){Q(e),X(!1)}if(n.useEffect(function(){H||B||k.mutate("update"===F.key?{fsm:F.applicationData,workflow:c({action:F.action},F.actionData)}:F,{onError:$,onSuccess:function(){O.clear(),V(!0),window.history.replaceState({},"FSM_CREATE_RESPONSE")}})},[]),n.useEffect(function(){switch(Z){case"GO_TO_HOME":return T.push(M?"/digit-ui/citizen":"/digit-ui/employee");case"ASSIGN_TO_DSO":return T.push("/digit-ui/employee/fsm/application-details/"+re);case"PAY":return void("POST_PAY"===(null==ie||null===(e=ie.fsm)||void 0===e?void 0:e[0].paymentPreference)?(N({key:"error",action:"ES_FSM_PAYMENT_BEFORE_SCHEDULE_FAILURE"}),setTimeout(function(){oe()},5e3)):T.push("/digit-ui/employee/payment/collect/FSM.TRIP_CHARGES/"+((null==F||null===(t=F.applicationData)||void 0===t?void 0:t.applicationNo)||(null==ie||null===(n=ie.fsm)||void 0===n?void 0:n[0].applicationNo))))}var e,t,n},[Z]),k.isLoading||k.isIdle&&!H)return i.createElement(t.Loader,null);var ce=["GO_TO_HOME"];"PENDING_APPL_FEE_PAYMENT"===(null==ie||null===(g=ie.fsm)||void 0===g?void 0:g[0].applicationStatus)&&L?ce=[].concat(ce,["PAY"]):"ASSING_DSO"===(null==ie||null===(y=ie.fsm)||void 0===y?void 0:y[0].applicationStatus)&&R&&(ce=[].concat(ce,["ASSIGN_TO_DSO"]));var se,de,ve,me,pe=!!z||(null==k?void 0:k.isSuccess);return i.createElement(t.Card,null,i.createElement(Ee,{t:A,data:ie,action:F.action,isSuccess:pe,isLoading:k.isIdle&&!H||(null==k?void 0:k.isLoading),isEmployee:e.parentRoute.includes("employee"),errorInfo:B}),i.createElement(t.CardText,null,function(e,t,n,i,l){return fe("DISPLAY",e,t,n,i,l)}(F.action,pe,e.parentRoute.includes("employee"),A,null==ie||null===(h=ie.fsm)||void 0===h?void 0:h[0])),pe&&i.createElement(t.LinkButton,{label:i.createElement("div",{className:"response-download-button"},i.createElement("span",null,i.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"#f47738"},i.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}))),i.createElement("span",{className:"download-button"},"COMPLETED"===(null==ie||null===(ve=ie.fsm)||void 0===ve?void 0:ve[0].applicationStatus)&&null!==(null==ie||null===(me=ie.fsm)||void 0===me?void 0:me[0].advanceAmount)?A("CS_COMMON_PAYMENT_RECEIPT"):A("CS_COMMON_DOWNLOAD")," ")),style:{width:"100px"},onClick:"COMPLETED"===(null==ie||null===(se=ie.fsm)||void 0===se?void 0:se[0].applicationStatus)&&null!==(null==ie||null===(de=ie.fsm)||void 0===de?void 0:de[0].advanceAmount)?function(){try{var e,t={filestoreIds:[null===(e=ae.Payments[0])||void 0===e?void 0:e.fileStoreId]},n=null!=t&&null!==(i=t.fileStoreIds)&&void 0!==i&&i[0]?Promise.resolve(Digit.PaymentService.printReciept(P,{fileStoreIds:t.filestoreIds[0]})).then(function(e){window.open(e[t.filestoreIds[0]],"_blank"),setShowOptions(!1)}):Promise.resolve(Digit.PaymentService.generatePdf(P,{Payments:[ae.Payments[0]]},"fsm-receipt")).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(P,{fileStoreIds:e.filestoreIds[0]})).then(function(t){window.open(t[e.filestoreIds[0]],"_blank"),setShowOptions(!1)})});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}var i}:function(){var e=(k.data||z).fsm,t=e[0],n=(e.slice(1),w.find(function(e){return e.code===t.tenantId})),i=I(c({},t,{slum:te,pdfVehicleType:le}),n,A);Digit.Utils.pdf.generate(i)}}),i.createElement(t.ActionBar,null,K?i.createElement(t.Menu,{localeKeyPrefix:"ES_COMMON",options:ce,t:A,onSelect:ue}):null,i.createElement(t.SubmitBar,1===ce.length?{label:A("ES_COMMON_"+ce[0]),onSubmit:function(){return ue(ce[0])}}:{label:A("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return X(!K)}})),C&&i.createElement(t.Toast,{error:"error"===C.key,label:A("success"===C.key?C.action:"ES_FSM_PAYMENT_BEFORE_SCHEDULE_FAILURE"),onClose:oe}))},FSMApplicationAudit:function(e){var n,a,o,u=l.useTranslation().t,c=r.useParams().id,s=Digit.UserService.getUser().info.tenantId,d=Digit.Hooks.fsm.useApplicationAudit(s,{applicationNo:c}),v=d.data,m=d.isLoading,f=i.useMemo(function(){return[{Header:u("ES_AUDIT_WHEN"),accessor:"when"},{Header:u("ES_AUDIT_WHO"),accessor:"who"},{Header:u("ES_AUDIT_WHAT"),accessor:"what"}]},[]),p=null==v||null===(n=v.fsmAudit)||void 0===n?void 0:n.map(function(e){return new Date(e.when).toLocaleString()}),E=null==v||null===(a=v.fsmAudit)||void 0===a?void 0:a.map(function(e){return e.who}),_=Digit.Hooks.useUserSearch(null,{uuid:E},{},{enabled:!!E}),S=null==v||null===(o=v.fsmAudit)||void 0===o?void 0:o.map(function(e,n){var l,a,o,s,d=(l=e.who,null!=(o=null==_||null===(a=_.data)||void 0===a?void 0:a.user)&&o.length?o.filter(function(e){return e.uuid===l})[0]:null);return{when:p[n],who:(null==d?void 0:d.name)+" ("+(null==d?void 0:d.type)+")",what:0===n?i.createElement("p",null,"New Request"," ",i.createElement(r.Link,{to:"/digit-ui/employee/fsm/application-details/"+c},i.createElement(t.LinkButton,{label:u("ES_VIEW_APPLICATION"),style:{color:"#1671ba",marginLeft:"8px"}}))):i.createElement(i.Fragment,null,(s=e.what,Object.keys(s).map(function(e,t){return i.createElement("p",{key:t},i.createElement("span",null,e)," : ",i.createElement("span",null,s[e]))})))}});return m||_.isLoading?i.createElement(t.Loader,null):i.createElement("div",{style:{overflow:"auto"}},i.createElement(t.Header,null,u("ES_TITLE_APPLICATION_AUDIT")),i.createElement(t.Table,{t:u,data:S||[],columns:f,getCellProps:function(e){return{style:{padding:"20px 18px",fontSize:"16px"}}}}))},FSMRateView:function(e){var n,a,o,u=l.useTranslation().t,c=Digit.ULBService.getCurrentTenantId(),s=r.useParams().id,d=Digit.Hooks.fsm.useSearch(c,{applicationNos:s}),v=d.isLoading,m=d.data,f=Digit.Hooks.useWorkflowDetails({tenantId:null==m?void 0:m.tenantId,id:s,moduleCode:"FSM",config:{enabled:d.isSuccess&&!!m}}),p=f.data;return v||f.isLoading?i.createElement(t.Loader,null):i.createElement(t.Card,null,i.createElement(t.CardHeader,null,u("CS_RATE_HELP_US")),i.createElement(t.KeyNote,{keyValue:u("CS_FSM_YOU_RATED")},i.createElement(t.Rating,{currentRating:null==p||null===(n=p.timeline[0])||void 0===n?void 0:n.rating})),m.additionalDetails.CheckList.map(function(e){return i.createElement(t.KeyNote,{keyValue:u(e.code),note:e.value.split(",").map(function(e){return u(e)}).join(", ")})}),i.createElement(t.KeyNote,{keyValue:u("CS_COMMON_COMMENTS"),note:(null==p||null===(a=p.timeline[0])||void 0===a||null===(o=a.wfComment)||void 0===o?void 0:o[0])||"N/A"}))},FSMNewApplicationCitizen:function(e){var a=e.parentRoute,u=o.useQueryClient(),s=r.useRouteMatch(),d=l.useTranslation().t,v=r.useLocation().pathname,m=r.useHistory(),f=(Digit.ULBService.getCurrentTenantId(),Digit.ULBService.getStateId()),p=[],E=[],_=Digit.Hooks.useSessionStorage("FSM_CITIZEN_FILE_PROPERTY",{}),S=_[0],g=_[1],y=_[2],h=Digit.Hooks.fsm.useMDMS(f,"FSM","CommonFieldsConfig"),T=h.data,I=h.isLoading,D=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],C=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],N=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2];function A(e,t,n){var i;g(c({},S,((i={})[e]=c({},S[e],t),i),{source:"ONLINE"})),function(e){var t=v.split("/").pop(),n=E.find(function(e){return e.route===t}).nextStep,i=m.push;if(e&&(i=m.replace),null===n)return i(a+"/new-application/check");i(s.path+"/"+n)}(n)}n.useEffect(function(){null!=v&&v.includes("new-application/response")||(D(!1),N(),C())},[]);var O=function(){};return I?i.createElement(t.Loader,null):(T.forEach(function(e){p=p.concat(e.body.filter(function(e){return!e.hideInCitizen}))}),(E=[].concat(p)).indexRoute="select-trip-number",i.createElement(r.Switch,null,E.map(function(e,t){var n=e.component,l=e.texts,a=e.inputs,o=e.key,u="string"==typeof n?Digit.ComponentRegistryService.getComponent(n):n;return i.createElement(r.Route,{path:s.path+"/"+e.route,key:t},i.createElement(u,{config:{texts:l,inputs:a,key:o},onSelect:A,onSkip:O,t:d,formData:S}))}),i.createElement(r.Route,{path:s.path+"/check"},i.createElement(R,{onSubmit:function(){try{return m.push(a+"/new-application/response"),Promise.resolve()}catch(e){return Promise.reject(e)}},value:S})),i.createElement(r.Route,{path:s.path+"/response"},i.createElement(b,{data:S,onSuccess:function(){y(),u.invalidateQueries("FSM_CITIZEN_SEARCH"),D(!0)}})),i.createElement(r.Route,null,i.createElement(r.Redirect,{to:s.path+"/"+E.indexRoute}))))},FSMMyApplications:function(){var e=l.useTranslation().t,n=Digit.ULBService.getCurrentTenantId(),r=Digit.UserService.getUser(),a=Digit.Hooks.fsm.useSearchAll(n,{uuid:r.info.uuid,limit:100}),o=a.data,u=(void 0===o?{}:o).data,c=(void 0===u?{}:u).table;return a.isLoading?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,e("CS_FSM_APPLICATION_TITLE_MY_APPLICATION")),(null==c?void 0:c.length)>0&&c.map(function(e,t){return i.createElement("div",{key:t},i.createElement(O,{application:e}))})))},FSMCitizenApplicationDetails:function(){var e,a,o,u=l.useTranslation().t,s=r.useParams().id,d=r.useHistory(),v=r.useLocation().state,m=(null==v?void 0:v.tenantId)||Digit.ULBService.getCurrentTenantId(),f=Digit.ULBService.getStateId(),p=Digit.Hooks.fsm.useApplicationDetail(u,m,s,{},"CITIZEN"),E=p.isLoading,_=p.data,S=Digit.Hooks.fsm.usePaymentHistory(m,s).data,g=(Digit.Hooks.useStore.getInitData().data||{}).tenants,y=n.useState(!1),h=y[0],T=y[1];if(E||!_)return i.createElement(t.Loader,null);0===(null==_||null===(e=_.applicationDetails)||void 0===e?void 0:e.length)&&d.goBack();var D=function(){try{var e=g.find(function(e){return e.code===(null==_?void 0:_.tenantId)}),t=I(c({},null==_?void 0:_.pdfData),e,u);return Digit.Utils.pdf.generate(t),T(!1),Promise.resolve()}catch(e){return Promise.reject(e)}},C=(null==S||null===(a=S.Payments)||void 0===a?void 0:a.length)>0?[{label:u("CS_COMMON_APPLICATION_ACKNOWLEDGEMENT"),onClick:D},{label:u("CS_COMMON_PAYMENT_RECEIPT"),onClick:function(){try{var e,t={filestoreIds:[null===(e=S.Payments[0])||void 0===e?void 0:e.fileStoreId]},n=null!=t&&null!==(i=t.fileStoreIds)&&void 0!==i&&i[0]?Promise.resolve(Digit.PaymentService.printReciept(f,{fileStoreIds:t.filestoreIds[0]})).then(function(e){window.open(e[t.filestoreIds[0]],"_blank"),T(!1)}):Promise.resolve(Digit.PaymentService.generatePdf(f,{Payments:[S.Payments[0]]},"fsm-receipt")).then(function(e){return Promise.resolve(Digit.PaymentService.printReciept(f,{fileStoreIds:e.filestoreIds[0]})).then(function(t){window.open(t[e.filestoreIds[0]],"_blank"),T(!1)})});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}var i}}]:[{label:u("CS_COMMON_APPLICATION_ACKNOWLEDGEMENT"),onClick:D}];return i.createElement(i.Fragment,null,i.createElement("div",{className:"cardHeaderWithOptions"},i.createElement(t.Header,null,u("CS_FSM_APPLICATION_DETAIL_TITLE_APPLICATION_DETAILS")),i.createElement(t.MultiLink,{className:"multilinkWrapper",onHeadClick:function(){return T(!h)},displayOptions:h,options:C})),i.createElement(t.Card,{style:{position:"relative"}},null==_||null===(o=_.applicationDetails)||void 0===o?void 0:o.map(function(e,n){var l=e.value,r=e.child,a=e.caption,o=e.map;return i.createElement(t.KeyNote,{key:n,keyValue:u(e.title),note:u(l)||(!o||!r)&&"N/A",caption:u(a)},r&&"object"==typeof r?i.createElement(r.element,c({},r)):r)}),i.createElement(A,{application:null==_?void 0:_.pdfData,id:s})))},FSMSelectRating:function(e){var a,o=e.parentRoute,u=l.useTranslation().t,s=Digit.ULBService.getCurrentTenantId(),d=r.useHistory(),v=r.useParams(),m=Digit.Hooks.fsm.useSearch(s,{applicationNos:v.id}).data,f=Digit.Hooks.fsm.useMDMS(s,"FSM","Checklist"),p=f.isLoading,E=f.data,_=(Digit.Hooks.fsm.useApplicationUpdate(s),n.useState({})),S=_[0],g=_[1],y=n.useState(!1),h=y[0],T=y[1],I=n.useState(!1),D=I[0],C=I[1],N=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],A=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],O=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2];if(n.useEffect(function(){N(!1),O(),A()},[]),p)return i.createElement(t.Loader,null);var L=function(e){switch(e){case"SINGLE_SELECT":return"radio";case"MULTI_SELECT":return"checkbox";case"DROP_DOWN":return"dropDown";default:return"checkbox"}},R=function(e,t){if("DROP_DOWN"===e){var n=[];return t.map(function(e){n.push({active:!0,citizenOnly:!1,code:e,i18nKey:e,name:e})}),n}return t},M=function(e,t,n){switch(e){case"SINGLE_SELECT":return S[t];case"DROP_DOWN":return n.find(function(e){return e.code===S[t]});default:return null}},b=null==E||null===(a=E.FSM)||void 0===a?void 0:a.CheckList.map(function(e){return{type:L(e.type),checkLabels:R(e.type,e.options),onSelect:"SINGLE_SELECT"===e.type||"DROP_DOWN"===e.type?(n=e.type,l=e.code,"DROP_DOWN"===n?function(e){var t;g(c({},S,((t={})[l]=e.code,t)))}:function(e){var t;g(c({},S,((t={})[l]=e,t)))}):null,selectedOption:M(e.type,e.code,R(e.type,e.options)),name:e.code,label:"SPILLAGE"===e.code?u("CS_FSM_APPLICATION_RATE_HELP_TEXT"):e.code,error:D?i.createElement(t.CardLabelError,null,u("CS_FEEDBACK_SELECT_ERROR")):null,className:"hhh"};var n,l}),P={texts:{header:u("CS_APPLICATION_DETAILS_RATE_US"),submitBarLabel:u("CS_COMMON_SUBMIT")},inputs:[{type:"rate",maxRating:5,label:u("CS_FSM_APPLICATION_RATE_TEXT"),error:h?i.createElement(t.CardLabelError,null,u("CS_FEEDBACK_ENTER_RATING_ERROR")):null}].concat(b,[{type:"textarea",label:u("CS_COMMON_COMMENTS"),name:"comments",className:"Hello"}])};return i.createElement("div",{className:"fsm-citizen-rating-wrapper"},i.createElement(t.RatingCard,{config:P,t:u,onSelect:function(e){var t=e.rating,n=e.comments,i=e.SAFETY_GEARS_USED;if(0===t||0===i.length)return T(0===t),void C(0===i.length);var l=c({},e,S),r=Object.keys(l).reduce(function(e,t){return"comments"===t||"rating"===t||e.push({code:t,value:Array.isArray(l[t])?l[t].join(","):l[t]}),e},[]);m.additionalDetails=c({},m.additionalDetails,{CheckList:r}),d.push(o+"/response",{applicationData:m,key:"update",action:"RATE",actionData:{rating:t,comments:n}})}})," ")},FSMDsoDashboard:function(){var e,r,a=Digit.ULBService.getCurrentTenantId(),o=l.useTranslation().t,u=n.useState("-"),s=u[0],d=u[1],v=n.useState(!0),m=v[0],f=v[1],p=n.useState(!1),E=p[0],_=p[1],S={limit:10,offset:0,uuid:{code:"ASSIGNED_TO_ME",name:o("ES_INBOX_ASSIGNED_TO_ME")},sortBy:"createdTime",sortOrder:"DESC",total:!0},g=Digit.Hooks.fsm.useVendorDetail().data;n.useEffect(function(){null!=g&&g.vendor&&(Digit.UserService.setExtraRoleDetails(g.vendor[0]),_(!0))},[g]);var y=Digit.Hooks.fsm.useInbox(a,c({},S),{enabled:E},!0).data,h=n.useMemo(function(){var e,t,n;return(n={})[o("ES_COMPLETION_PENDING")]=(null==y||null===(e=y.statuses.filter(function(e){return"DSO_INPROGRESS"===e.applicationstatus})[0])||void 0===e?void 0:e.count)||0,n[o("ES_VEHICLE_ASSIGNMENT_PENDING")]=(null==y||null===(t=y.statuses.filter(function(e){return"PENDING_DSO_APPROVAL"===e.applicationstatus})[0])||void 0===t?void 0:t.count)||0,n},[null==y?void 0:y.totalCount]),T=n.useMemo(function(){return[{link:"/digit-ui/citizen/fsm/inbox",label:o("ES_TITLE_INBOX"),count:s}]},[s]);if(n.useEffect(function(){if(y){var e,t,n=(null==y||null===(e=y.statuses.filter(function(e){return"DSO_INPROGRESS"===e.applicationstatus})[0])||void 0===e?void 0:e.count)+(null==y||null===(t=y.statuses.filter(function(e){return"PENDING_DSO_APPROVAL"===e.applicationstatus})[0])||void 0===t?void 0:t.count);d(n),Object.keys(h).length&&f(!1)}},[h,y]),m)return i.createElement(t.Loader,null);var I={Icon:i.createElement(t.ShippingTruck,null),moduleName:o("ES_TITLE_FAECAL_SLUDGE_MGMT"),kpis:[{count:(null==y||null===(e=y.statuses.filter(function(e){return"DSO_INPROGRESS"===e.applicationstatus})[0])||void 0===e?void 0:e.count)||0,label:o("ES_COMPLETION_PENDING"),link:"/digit-ui/citizen/fsm/inbox"},{count:(null==y||null===(r=y.statuses.filter(function(e){return"PENDING_DSO_APPROVAL"===e.applicationstatus})[0])||void 0===r?void 0:r.count)||0,label:o("ES_VEHICLE_ASSIGNMENT_PENDING"),link:"/digit-ui/citizen/fsm/inbox"}],links:T};return i.createElement("div",{className:"ground-container moduleCardWrapper"},i.createElement(t.EmployeeModuleCard,I))},FSMRegistry:function(){var e,r,a=l.useTranslation().t,o=Digit.ULBService.getCurrentTenantId(),u=n.useState({}),s=u[0],d=u[1],v=n.useState([{id:"createdTime",desc:!0}]),m=v[0],f=v[1],p=n.useState(0),E=p[0],_=p[1],S=n.useState(10),g=S[0],y=S[1],h=n.useState("VENDOR"),T=h[0],I=h[1],D=n.useState(""),C=D[0],N=D[1],A=n.useState(""),O=A[0],L=A[1],R=n.useState([]),M=R[0],b=R[1],P=(Digit.UserService.getUser(),{limit:g,offset:E,sortBy:null==m||null===(e=m[0])||void 0===e?void 0:e.id,sortOrder:null!=m&&null!==(r=m[0])&&void 0!==r&&r.desc?"DESC":"ASC"}),F="VEHICLE"===T?Digit.Hooks.fsm.useVehiclesSearch({tenantId:o,filters:c({},P,{registrationNumber:null==s?void 0:s.registrationNumber,status:"ACTIVE,DISABLED"}),config:{enabled:!1}}):"DRIVER"===T?Digit.Hooks.fsm.useDriverSearch({tenantId:o,filters:c({},P,{name:null==s?void 0:s.name,status:"ACTIVE,DISABLED"}),config:{enabled:!1}}):Digit.Hooks.fsm.useVendorSearch({tenantId:o,filters:c({},P,{name:null==s?void 0:s.name,status:"ACTIVE,DISABLED"}),config:{enabled:!1}}),k=F.data,w=F.isLoading,x=F.refetch,H=Digit.Hooks.fsm.useDsoSearch(o,{vehicleIds:C,driverIds:O,status:"ACTIVE"},{enabled:!1}),V=H.data,U=H.isLoading,B=H.refetch,Y=(null==k?void 0:k.totalCount)||50;n.useEffect(function(){x()},[]),n.useEffect(function(){x()},[s,m,E,g]),n.useEffect(function(){if(null!=k&&k.vehicle&&"VEHICLE"===T){var e="";k.vehicle.map(function(t){e+=t.id+","}),N(e),b(k.vehicle)}if(null!=k&&k.driver&&"DRIVER"===T){var t="";k.driver.map(function(e){t+=e.id+","}),L(t),b(null==k?void 0:k.driver)}if(null!=k&&k.vendor&&"VENDOR"===T){var n=k.vendor.map(function(e){var t,n,i,l;return{mobileNumber:null===(t=e.owner)||void 0===t?void 0:t.mobileNumber,name:e.name,id:e.id,auditDetails:e.auditDetails,drivers:e.drivers,activeDrivers:null===(n=e.drivers)||void 0===n?void 0:n.filter(function(e){return"ACTIVE"===e.status}),allVehicles:e.vehicles,dsoDetails:e,vehicles:null===(i=e.vehicles)||void 0===i||null===(l=i.filter(function(e){return"ACTIVE"===e.status}))||void 0===l?void 0:l.map(function(e){return{id:e.id,registrationNumber:null==e?void 0:e.registrationNumber,type:e.type,i18nKey:"FSM_VEHICLE_TYPE_"+e.type,capacity:e.tankCapacity,suctionType:e.suctionType,model:e.model}})}});b(n)}},[k]),n.useEffect(function(){""===C&&""===O||B()},[C,O]),n.useEffect(function(){if(V){if("VEHICLE"===T){var e=null==k?void 0:k.vehicle.map(function(e){var t=V.find(function(t){var n,i;return null===(n=t.dsoDetails)||void 0===n||null===(i=n.vehicles)||void 0===i?void 0:i.find(function(t){return t.id===e.id})});return t&&(e.vendor=t.dsoDetails),e});b(e),N("")}if("DRIVER"===T){var t=null==k?void 0:k.driver.map(function(e){var t=V.find(function(t){var n,i;return null===(n=t.dsoDetails)||void 0===n||null===(i=n.drivers)||void 0===i?void 0:i.find(function(t){return t.id===e.id})});return t&&(e.vendor=t.dsoDetails),e});b(t),L("")}}},[V,k]);var G="VEHICLE"===T?[{label:a("ES_FSM_REGISTRY_SEARCH_VEHICLE_NUMBER"),name:"registrationNumber",pattern:"[A-Z]{2}\\s{1}[0-9]{2}\\s{0,1}[A-Z]{1,2}\\s{1}[0-9]{4}",title:a("ES_FSM_VEHICLE_FORMAT_TIP")}]:"DRIVER"===T?[{label:a("ES_FSM_REGISTRY_SEARCH_DRIVER_NAME"),name:"name"}]:[{label:a("ES_FSM_REGISTRY_SEARCH_VENDOR_NAME"),name:"name"}],z=n.useCallback(function(e){0!==(null==e?void 0:e.length)&&f(e)},[]);return n.useEffect(function(){x(),B()},[]),i.createElement("div",null,i.createElement(t.Header,null,a("ES_FSM_REGISTRY")),i.createElement(Se,{data:{table:M},isLoading:w||U,onSort:z,disableSort:!1,sortParams:m,userRole:"FSM_ADMIN",onFilterChange:function(){},searchFields:G,onSearch:function(e){void 0===e&&(e={}),d(c({},e))},onNextPage:function(){_(function(e){return e+g})},onPrevPage:function(){_(function(e){return e-g})},currentPage:Math.floor(E/g),pageSizeLimit:g,onPageSizeChange:function(e){y(Number(e.target.value))},totalRecords:Y||0,onTabChange:function(e){I(e)},selectedTab:T,refetchData:function(){x()},refetchVendor:function(){B()}}))},VendorDetails:function(e){var a,u,s=Digit.ULBService.getCurrentTenantId(),d=(Digit.ULBService.getStateId(),l.useTranslation().t),v=r.useHistory(),m=o.useQueryClient(),f=r.useParams().id,p=n.useState(!1),E=p[0],_=p[1],S=n.useState(null),g=S[0],y=S[1],h=(n.useState({}),n.useState(!1)),T=h[0],I=h[1],D=n.useState(null),C=D[0],N=D[1],A=n.useState([]),O=A[0],L=A[1],R=n.useState([]),M=R[0],b=R[1],P=n.useState({}),F=P[0],k=P[1],w=Digit.Hooks.fsm.useDsoSearch(s,{ids:f},{staleTime:Infinity}),x=w.data,H=w.isLoading,V=w.refetch,U=Digit.Hooks.fsm.useVehiclesSearch({tenantId:s,filters:{status:"ACTIVE",sortBy:"registrationNumber",sortOrder:"ASC",vehicleWithNoVendor:!0}}),B=U.data,Y=U.refetch,G=Digit.Hooks.fsm.useDriverSearch({tenantId:s,filters:{sortBy:"name",sortOrder:"ASC",status:"ACTIVE",driverWithNoVendor:!0}}),z=G.data,W=G.refetch,j=Digit.Hooks.fsm.useVendorUpdate(s).mutate;function K(e){_(!1),y(e)}n.useEffect(function(){switch(g){case"DELETE":case"ADD_VEHICLE":case"ADD_DRIVER":return I(!0);case"EDIT":return v.push("/digit-ui/employee/fsm/registry/modify-vendor/"+f)}},[g]),n.useEffect(function(){B&&L((null==B?void 0:B.vehicle)||[])},[B]),n.useEffect(function(){z&&b((null==z?void 0:z.driver)||[])},[z]);var X=function(){N(null)},q=function(){y(null),k({}),I(!1)},Z=window.Digit.Utils.browser.isMobile();return H?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,H?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement(t.Header,{style:{marginBottom:"16px"}},d("ES_FSM_REGISTRY_VENDOR_DETAILS")),i.createElement("div",{style:Z?{}:{marginLeft:"-15px"}},i.createElement(t.Card,{style:{position:"relative"}},null==x||null===(a=x[0])||void 0===a||null===(u=a.employeeResponse)||void 0===u?void 0:u.map(function(e,n){var l,r;return i.createElement(i.Fragment,{key:n},n>0&&i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},d(e.title)),i.createElement("div",{style:Z?{}:{marginLeft:"-15px"}},i.createElement(t.StatusTable,null,null==e||null===(l=e.values)||void 0===l?void 0:l.map(function(n,l){var r;return i.createElement(t.Row,{key:d(n.title),label:d(n.title),text:d(n.value)||"N/A",last:l===(null==e||null===(r=e.values)||void 0===r?void 0:r.length)-1,caption:n.caption,className:"border-none "+(Z?"":"vendor-details-row")})}),null==e||null===(r=e.child)||void 0===r?void 0:r.map(function(n,l){var r;return i.createElement(t.Card,{className:"card-with-background"},i.createElement("div",{className:"card-head"},i.createElement("h2",null,d(e.type)," ",l+1),i.createElement("div",{style:{display:"flex"}},i.createElement("span",{onClick:function(){return function(e,t,n){if("ES_FSM_REGISTRY_DETAILS_TYPE_DRIVER"===t)v.push("/digit-ui/employee/fsm/registry/modify-driver/"+n);else{var i,l,r=null==e||null===(i=e.values)||void 0===i||null===(l=i.find(function(e){return"ES_FSM_REGISTRY_VEHICLE_NUMBER"===e.title}))||void 0===l?void 0:l.value;v.push("/digit-ui/employee/fsm/registry/modify-vehicle/"+r)}}(n,e.type,n.id)}},i.createElement(t.EditIcon,{style:{cursor:"pointer",marginRight:"20px"},className:"edit",fill:"#f47738"})),i.createElement("span",{onClick:function(){return function(e,t,n){var i={};if("ES_FSM_REGISTRY_DETAILS_TYPE_DRIVER"===t){var l,r=null==x||null===(l=x[0])||void 0===l?void 0:l.dsoDetails,a=null==r?void 0:r.drivers;i={vendor:c({},r,{drivers:a=a.map(function(e){return e.id===n&&(e.vendorDriverStatus="INACTIVE"),e})})}}else{var o,u,s,d=null==x||null===(o=x[0])||void 0===o?void 0:o.dsoDetails,v=null==d?void 0:d.vehicles,f=null==e||null===(u=e.values)||void 0===u||null===(s=u.find(function(e){return"ES_FSM_REGISTRY_VEHICLE_NUMBER"===e.title}))||void 0===s?void 0:s.value;i={vendor:c({},d,{vehicles:v=v.map(function(e){return e.registrationNumber===f&&(e.vendorVehicleStatus="INACTIVE"),e})})}}j(i,{onError:function(e,t){N({key:"error",action:e}),setTimeout(X,5e3)},onSuccess:function(e,n){N({key:"success",action:"ES_FSM_REGISTRY_DETAILS_TYPE_DRIVER"===t?"DELETE_DRIVER":"DELETE_VEHICLE"}),m.invalidateQueries("DSO_SEARCH"),V(),Y(),W(),setTimeout(function(){X()},5e3)}})}(n,e.type,n.id)}},i.createElement(t.DeleteIcon,{style:{cursor:"pointer"},className:"delete",fill:"#f47738"})))),null==n||null===(r=n.values)||void 0===r?void 0:r.map(function(n,l){var r;return i.createElement(t.Row,{key:d(n.title),label:d(n.title),text:d(n.value)||"N/A",last:l===(null==e||null===(r=e.values)||void 0===r?void 0:r.length)-1,caption:n.caption,className:"border-none",textStyle:"ACTIVE"===n.value?{color:"green"}:{}})}))}),e.type&&i.createElement("div",{style:{color:"#f47738",cursor:"pointer",marginLeft:"16px"},onClick:function(){return K("ES_FSM_REGISTRY_DETAILS_TYPE_DRIVER"===e.type?"ADD_DRIVER":"ADD_VEHICLE")}},d(e.type+"_ADD")))))}))),T&&i.createElement(t.Modal,{headerBarMain:i.createElement(ye,{label:d("DELETE"===g?"ES_FSM_REGISTRY_DELETE_POPUP_HEADER":"ADD_VEHICLE"===g?"ES_FSM_REGISTRY_ADD_VEHICLE_POPUP_HEADER":"ES_FSM_REGISTRY_ADD_DRIVER_POPUP_HEADER")}),headerBarEnd:i.createElement(Te,{onClick:q}),actionCancelLabel:d("CS_COMMON_CANCEL"),actionCancelOnSubmit:q,actionSaveLabel:d("DELETE"===g?"ES_EVENT_DELETE":"CS_COMMON_SUBMIT"),actionSaveOnSubmit:function(){var e,t=null==x||null===(e=x[0])||void 0===e?void 0:e.dsoDetails,n={};if("DELETE"===g&&(n={vendor:c({},t,{status:"INACTIVE"})}),"ADD_VEHICLE"===g){var i=F;i.vendorVehicleStatus="ACTIVE",n={vendor:c({},t,{vehicles:t.vehicles?[].concat(t.vehicles,[i]):[i]})}}if("ADD_DRIVER"===g){var l=F;l.vendorDriverStatus="ACTIVE",n={vendor:c({},t,{drivers:t.drivers?[].concat(t.drivers,[l]):[l]})}}j(n,{onError:function(e,t){N({key:"error",action:e}),setTimeout(X,5e3)},onSuccess:function(e,t){N({key:"success",action:"DELETE"===g?"DELETE_VENDOR":g}),m.invalidateQueries("DSO_SEARCH"),V(),Y(),W(),setTimeout(function(){X(),"DELETE"===g&&v.push("/digit-ui/employee/fsm/registry")},5e3)}}),I(!1),y(null)}},i.createElement(t.Card,{style:{boxShadow:"none"}},"DELETE"===g?i.createElement(ge,{t:d,title:"ES_FSM_REGISTRY_DELETE_TEXT"}):"ADD_VEHICLE"===g?i.createElement(n.Fragment,null,i.createElement(t.CardText,null,d("ES_FSM_REGISTRY_SELECT_VEHICLE")),i.createElement(t.Dropdown,{t:d,option:O,value:F,selected:F,select:k,optionKey:"registrationNumber"})):"ADD_DRIVER"===g?i.createElement(n.Fragment,null,i.createElement(t.CardText,null,d("ES_FSM_REGISTRY_SELECT_DRIVER")),i.createElement(t.Dropdown,{t:d,option:M,value:F,selected:F,select:k,optionKey:"name"})):void 0)),C&&i.createElement(t.Toast,{error:"error"===C.key,label:d("success"===C.key?"ES_FSM_REGISTRY_"+C.action+"_SUCCESS":C.action),onClose:X}),i.createElement(t.ActionBar,{style:{zIndex:"19"}},E?i.createElement(t.Menu,{localeKeyPrefix:"ES_FSM_REGISTRY_ACTION",options:["EDIT","DELETE"],t:d,onSelect:K}):null,i.createElement(t.SubmitBar,{label:d("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return _(!E)}}))))},AddVendor:function(e){var a=Digit.ULBService.getCurrentTenantId(),u=Digit.ULBService.getStateId(),s=n.useState(null),d=s[0],v=s[1],m=r.useHistory(),f=o.useQueryClient(),p=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],E=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],_=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2],S=Digit.Hooks.fsm.useVendorCreate(a).mutate;n.useEffect(function(){p(!1),_(),E()},[]);var g=l.useTranslation().t,y=De(g),h=n.useState(!1),T=h[0],I=h[1],D=function(){v(null)},C=window.Digit.Utils.browser.isMobile();return i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,g("ES_FSM_REGISTRY_TITLE_NEW_VENDOR"))),i.createElement("div",{style:C?{}:{marginLeft:"-15px"}},i.createElement(t.FormComposer,{isDisabled:!T,label:g("ES_COMMON_APPLICATION_SUBMIT"),config:y.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},onSubmit:function(e){var t,n,i,l,r,o,c,s,d,p,E,_,g,y,h,T,I,C,N,A,O,L,R=null==e?void 0:e.vendorName,M=null==e?void 0:e.pincode,b=null==e||null===(t=e.street)||void 0===t?void 0:t.trim(),P=null==e||null===(n=e.doorNo)||void 0===n?void 0:n.trim(),F=null==e||null===(i=e.plotNo)||void 0===i?void 0:i.trim(),k=null==e||null===(l=e.landmark)||void 0===l?void 0:l.trim(),w=null==e||null===(r=e.address)||void 0===r||null===(o=r.city)||void 0===o?void 0:o.name,x=null==e||null===(c=e.address)||void 0===c||null===(s=c.city)||void 0===s?void 0:s.state,H=null==e||null===(d=e.address)||void 0===d||null===(p=d.city)||void 0===p?void 0:p.name,V=null==e||null===(E=e.address)||void 0===E||null===(_=E.city)||void 0===_?void 0:_.name,U=null==e||null===(g=e.buildingName)||void 0===g?void 0:g.trim(),B=null==e||null===(y=e.address)||void 0===y||null===(h=y.locality)||void 0===h?void 0:h.code,Y=null==e||null===(T=e.address)||void 0===T||null===(I=T.locality)||void 0===I?void 0:I.name,G=null==e||null===(C=e.address)||void 0===C||null===(N=C.locality)||void 0===N?void 0:N.area,z=null==e||null===(A=e.selectGender)||void 0===A?void 0:A.code,W=null==e?void 0:e.emailId,j=null==e?void 0:e.phone,K=new Date(""+e.dob).getTime()||new Date("1/1/1970").getTime(),X={vendor:{tenantId:a,name:R,agencyType:"ULB",paymentPreference:"post-service",address:{tenantId:a,landmark:k,doorNo:P,plotNo:F,street:b,city:w,district:H,region:V,state:x,country:"in",pincode:M,buildingName:U,locality:{code:B||"",name:Y||"",label:"Locality",area:G||""},geoLocation:{latitude:(null==e||null===(O=e.address)||void 0===O?void 0:O.latitude)||0,longitude:(null==e||null===(L=e.address)||void 0===L?void 0:L.longitude)||0}},owner:{tenantId:u,name:R,fatherOrHusbandName:R,relationship:"OTHER",gender:z,dob:K,emailId:W||"abc@egov.com",mobileNumber:j},additionalDetails:{description:null==e?void 0:e.additionalDetails},vehicle:[],drivers:[],source:"WhatsApp"}};S(X,{onError:function(e,t){v({key:"error",action:e}),setTimeout(D,5e3)},onSuccess:function(e,t){v({key:"success",action:"ADD_VENDOR"}),setTimeout(D,5e3),f.invalidateQueries("DSO_SEARCH"),setTimeout(function(){D(),m.push("/digit-ui/employee/fsm/registry")},5e3)}})},defaultValues:{tripData:{noOfTrips:1,amountPerTrip:null,amount:null}},onFormValueChange:function(e,t){var n;null!=t&&t.vendorName&&null!=t&&t.phone&&null!=t&&null!==(n=t.address)&&void 0!==n&&n.locality&&null!=t&&t.selectGender?I(!0):I(!1)},noBreakLine:!0}),d&&i.createElement(t.Toast,{error:"error"===d.key,label:g("success"===d.key?"ES_FSM_REGISTRY_"+d.action+"_SUCCESS":d.action),onClose:D})))},EditVendor:function(e){var a=Digit.ULBService.getCurrentTenantId(),u=(Digit.ULBService.getStateId(),r.useParams().id),s=n.useState(null),d=s[0],v=s[1],m=n.useState(!1),f=m[0],p=m[1],E=n.useState({}),_=E[0],S=E[1],g=n.useState({}),y=g[0],h=g[1],T=o.useQueryClient(),I=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],D=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],C=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2],N=Digit.Hooks.fsm.useDsoSearch(a,{ids:u},{staleTime:Infinity}),A=N.data,O=N.isLoading,L=Digit.Hooks.fsm.useVendorUpdate(a).mutate;n.useEffect(function(){I(!1),C(),D()},[]),n.useEffect(function(){if(A&&A[0]){var e,t,n,i,l,r,a,o,u,s,d,v,m,f,p,E,_,g,y,T,I,D,C,N,O,L,R,M,b,P,F,k,w,x,H,V,U,B,Y=A[0];h(null==Y?void 0:Y.dsoDetails);var G={vendorName:null==Y?void 0:Y.name,street:null==Y||null===(e=Y.dsoDetails)||void 0===e||null===(t=e.address)||void 0===t?void 0:t.street,doorNo:null==Y||null===(n=Y.dsoDetails)||void 0===n||null===(i=n.address)||void 0===i?void 0:i.doorNo,plotNo:null==Y||null===(l=Y.dsoDetails)||void 0===l||null===(r=l.address)||void 0===r?void 0:r.plotNo,landmark:null==Y||null===(a=Y.dsoDetails)||void 0===a||null===(o=a.address)||void 0===o?void 0:o.landmark,pincode:null==Y||null===(u=Y.dsoDetails)||void 0===u||null===(s=u.address)||void 0===s?void 0:s.pincode,buildingName:null==Y||null===(d=Y.dsoDetails)||void 0===d||null===(v=d.address)||void 0===v?void 0:v.buildingName,address:{pincode:null==Y||null===(m=Y.dsoDetails)||void 0===m||null===(f=m.address)||void 0===f?void 0:f.pincode,locality:c({},null==Y||null===(p=Y.dsoDetails)||void 0===p||null===(E=p.address)||void 0===E?void 0:E.locality,{i18nkey:(null==Y||null===(_=Y.dsoDetails)||void 0===_?void 0:_.tenantId.toUpperCase().split(".").join("_"))+"_REVENUE_"+(null==Y||null===(g=Y.dsoDetails)||void 0===g?void 0:g.address.locality.code)})},phone:null==Y?void 0:Y.mobileNumber,ownerName:null==Y||null===(y=Y.dsoDetails)||void 0===y||null===(T=y.owner)||void 0===T?void 0:T.name,fatherOrHusbandName:null==Y||null===(I=Y.dsoDetails)||void 0===I||null===(D=I.owner)||void 0===D?void 0:D.fatherOrHusbandName,relationship:null==Y||null===(C=Y.dsoDetails)||void 0===C||null===(N=C.owner)||void 0===N?void 0:N.relationship,selectGender:null==Y||null===(O=Y.dsoDetails)||void 0===O||null===(L=O.owner)||void 0===L?void 0:L.gender,dob:(null==Y||null===(R=Y.dsoDetails)||void 0===R||null===(M=R.owner)||void 0===M?void 0:M.dob)&&Digit.DateUtils.ConvertTimestampToDate(null==Y||null===(b=Y.dsoDetails)||void 0===b||null===(P=b.owner)||void 0===P?void 0:P.dob,"yyyy-MM-dd"),emailId:"abc@egov.com"===(null==Y||null===(F=Y.dsoDetails)||void 0===F||null===(k=F.owner)||void 0===k?void 0:k.emailId)?"":null==Y||null===(w=Y.dsoDetails)||void 0===w||null===(x=w.owner)||void 0===x?void 0:x.emailId,correspondenceAddress:null==Y||null===(H=Y.dsoDetails)||void 0===H||null===(V=H.owner)||void 0===V?void 0:V.correspondenceAddress,additionalDetails:null==Y||null===(U=Y.dsoDetails)||void 0===U||null===(B=U.additionalDetails)||void 0===B?void 0:B.description};S(G)}},[A]);var R=l.useTranslation().t,M=r.useHistory(),b=De(R,!0),P=function(){v(null)},F=window.Digit.Utils.browser.isMobile();return O||0==Object.keys(_).length?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,R("ES_FSM_REGISTRY_TITLE_EDIT_VENDOR"))),i.createElement("div",{style:F?{}:{marginLeft:"-15px"}},i.createElement(t.FormComposer,{isDisabled:!f,label:R("ES_COMMON_APPLICATION_SUBMIT"),config:b.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},onSubmit:function(e){var t,n,i,l,r,a,o,s,d,m,f,p,E,_,S,g,h,I,D,C,N,A,O,R,b=null==e?void 0:e.vendorName,F=null==e?void 0:e.pincode,k=null==e||null===(t=e.street)||void 0===t?void 0:t.trim(),w=null==e||null===(n=e.doorNo)||void 0===n?void 0:n.trim(),x=null==e||null===(i=e.plotNo)||void 0===i?void 0:i.trim(),H=null==e||null===(l=e.landmark)||void 0===l?void 0:l.trim(),V=null==e||null===(r=e.address)||void 0===r||null===(a=r.city)||void 0===a?void 0:a.name,U=null==e||null===(o=e.address)||void 0===o||null===(s=o.city)||void 0===s?void 0:s.state,B=null==e||null===(d=e.address)||void 0===d||null===(m=d.city)||void 0===m?void 0:m.name,Y=null==e||null===(f=e.address)||void 0===f||null===(p=f.city)||void 0===p?void 0:p.name,G=null==e||null===(E=e.buildingName)||void 0===E?void 0:E.trim(),z=null==e||null===(_=e.address)||void 0===_||null===(S=_.locality)||void 0===S?void 0:S.code,W=null==e||null===(g=e.address)||void 0===g||null===(h=g.locality)||void 0===h?void 0:h.name,j=null==e||null===(I=e.address)||void 0===I||null===(D=I.locality)||void 0===D?void 0:D.area,K=null==e?void 0:e.additionalDetails,X=null==e||null===(C=e.selectGender)||void 0===C?void 0:C.code,q=null==e?void 0:e.emailId,Z=new Date(""+e.dob).getTime()||new Date("1/1/1970").getTime(),Q={vendor:c({},y,{name:b,address:c({},y.address,{landmark:H,doorNo:w,plotNo:x,street:k,city:V,district:B,region:Y,state:U,country:"in",pincode:F,buildingName:G,locality:c({},y.address.locality,{code:z||"",name:W||"",label:"Locality",area:j||""}),geoLocation:c({},y.address.geoLocation,{latitude:(null==e||null===(N=e.address)||void 0===N?void 0:N.latitude)||0,longitude:(null==e||null===(A=e.address)||void 0===A?void 0:A.longitude)||0})}),owner:c({},y.owner,{gender:X||(null===(O=y.owner)||void 0===O?void 0:O.gender)||"OTHER",dob:Z,emailId:q||"abc@egov.com",relationship:(null===(R=y.owner)||void 0===R?void 0:R.relationship)||"OTHER"}),additionalDetails:c({},y.additionalDetails,{description:K})})};L(Q,{onError:function(e,t){v({key:"error",action:e}),setTimeout(P,5e3)},onSuccess:function(e,t){v({key:"success",action:"UPDATE_VENDOR"}),setTimeout(P,5e3),T.invalidateQueries("DSO_SEARCH"),setTimeout(function(){P(),M.push("/digit-ui/employee/fsm/registry/vendor-details/"+u)},5e3)}})},defaultValues:_,onFormValueChange:function(e,t){var n;null!=t&&t.phone&&null!=t&&null!==(n=t.address)&&void 0!==n&&n.locality?p(!0):p(!1)},noBreakLine:!0}),d&&i.createElement(t.Toast,{error:"error"===d.key,label:R("success"===d.key?"ES_FSM_REGISTRY_"+d.action+"_SUCCESS":d.action),onClose:P})))},VehicleDetails:function(e){var a,u,s=Digit.ULBService.getCurrentTenantId(),d=(Digit.ULBService.getStateId(),l.useTranslation().t),v=r.useHistory(),m=o.useQueryClient(),f=r.useParams().id,p=n.useState(!1),E=p[0],_=p[1],S=n.useState(null),g=S[0],y=S[1],h=(n.useState({}),n.useState(!1)),T=h[0],I=h[1],D=n.useState(null),C=D[0],N=D[1],A=n.useState([]),O=A[0],L=A[1],R=n.useState({}),M=R[0],b=R[1],P=n.useState(null),F=P[0],k=P[1],w=Digit.Hooks.fsm.useVehicleDetails(s,{registrationNumber:f},{staleTime:Infinity}),x=w.data,H=w.isLoading,V=w.refetch;n.useEffect(function(){var e,t;!H&&x&&k(null==x||null===(e=x[0])||void 0===e||null===(t=e.vehicleData)||void 0===t?void 0:t.id)},[x,H]);var U=Digit.Hooks.fsm.useDsoSearch(s,{sortBy:"name",sortOrder:"ASC",status:"ACTIVE"},{}).data;n.useEffect(function(){if(U){var e=U.map(function(e){return e.dsoDetails});L(e)}},[U]);var B=Digit.Hooks.fsm.useUpdateVehicle(s).mutate,Y=Digit.Hooks.fsm.useVendorUpdate(s).mutate;function G(e){_(!1),y(e)}n.useEffect(function(){V()},[]),n.useEffect(function(){switch(g){case"DELETE":case"ADD_VENDOR":case"EDIT_VENDOR":case"DELETE_VENDOR":return I(!0);case"EDIT":return v.push("/digit-ui/employee/fsm/registry/modify-vehicle/"+f)}},[g]);var z=function(){N(null)},W=function(){y(null),b({}),I(!1)},j=function(){return"DELETE"===g||"DELETE_VENDOR"===g?i.createElement(ge,{t:d,title:"ES_FSM_REGISTRY_DELETE_TEXT"}):"ADD_VENDOR"===g||"EDIT_VENDOR"===g?i.createElement(n.Fragment,null,i.createElement(t.CardText,null,d("ES_FSM_REGISTRY_SELECT_VENODOR")),i.createElement(t.Dropdown,{t:d,option:O,value:M,selected:M,select:b,optionKey:"name"})):void 0},K=window.Digit.Utils.browser.isMobile();return H?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,H?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement(t.Header,{style:{marginBottom:"16px"}},d("ES_FSM_REGISTRY_VEHICLE_DETAILS")),i.createElement("div",{style:K?{}:{marginLeft:"-15px"}},i.createElement(t.Card,{style:{position:"relative"}},null==x||null===(a=x[0])||void 0===a||null===(u=a.employeeResponse)||void 0===u?void 0:u.map(function(e,l){var r;return i.createElement(i.Fragment,{key:l},l>0&&i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},d(e.title)),i.createElement(t.StatusTable,null,null==e||null===(r=e.values)||void 0===r?void 0:r.map(function(l,r){var a,o;return"custom"===(null==l?void 0:l.type)?i.createElement(n.Fragment,null,i.createElement("div",{className:(r===(null==e||null===(a=e.values)||void 0===a?void 0:a.length)-1?"row last":"row")+" border-none"},i.createElement("h2",null,d(l.title)),i.createElement("div",{className:"value",style:{color:"#f47738",display:"flex"}},d(l.value)||"N/A","ES_FSM_REGISTRY_DETAILS_ADD_VENDOR"===l.value&&i.createElement("span",{onClick:function(){return G("ADD_VENDOR")}},i.createElement(t.AddIcon,{className:"",fill:"#f47738",styles:{cursor:"pointer",marginLeft:"20px",height:"24px"}})),"ES_FSM_REGISTRY_DETAILS_ADD_VENDOR"!=l.value&&i.createElement("span",{onClick:function(){return G("EDIT_VENDOR")}},i.createElement(t.EditIcon,{style:{cursor:"pointer",marginLeft:"20px"}})),"ES_FSM_REGISTRY_DETAILS_ADD_VENDOR"!=l.value&&i.createElement("span",{onClick:function(){return G("DELETE_VENDOR")}},i.createElement(t.DeleteIcon,{className:"delete",fill:"#f47738",style:{cursor:"pointer",marginLeft:"20px"}}))))):i.createElement(t.Row,{key:d(l.title),label:d(l.title),text:d(l.value)||"N/A",last:r===(null==e||null===(o=e.values)||void 0===o?void 0:o.length)-1,caption:l.caption,className:"border-none",textStyle:"ACTIVE"===l.value?{color:"green"}:{}})})))}))),T&&i.createElement(t.Modal,{headerBarMain:i.createElement(Ce,{label:d(function(){switch(g){case"DELETE":case"DELETE_VENDOR":return"ES_FSM_REGISTRY_DELETE_POPUP_HEADER";case"ADD_VENDOR":case"EDIT_VENDOR":return"ES_FSM_REGISTRY_ADD_VENDOR_POPUP_HEADER"}}())}),headerBarEnd:i.createElement(Ae,{onClick:W}),actionCancelLabel:d("CS_COMMON_CANCEL"),actionCancelOnSubmit:W,actionSaveLabel:d("DELETE"===g||"DELETE_VENDOR"===g?"ES_EVENT_DELETE":"CS_COMMON_SUBMIT"),actionSaveOnSubmit:function(){switch(g){case"DELETE":return function(){var e,t={vehicle:c({},null==x||null===(e=x[0])||void 0===e?void 0:e.vehicleData,{status:"INACTIVE"})};B(t,{onError:function(e,t){N({key:"error",action:e}),setTimeout(z,5e3)},onSuccess:function(e,t){N({key:"success",action:"DELETE_VEHICLE"}),m.invalidateQueries("FSM_VEICLES_SEARCH"),setTimeout(function(){v.push("/digit-ui/employee/fsm/registry")},5e3)}}),I(!1)}();case"DELETE_VENDOR":return i={vendor:c({},l=null==x||null===(e=x[0])||void 0===e||null===(t=e.vendorDetails)||void 0===t||null===(n=t.vendor)||void 0===n?void 0:n[0],{vehicles:(null==l?void 0:l.vehicles).map(function(e){return e.id===F&&(e.vendorVehicleStatus="INACTIVE"),e})})},Y(i,{onError:function(e,t){N({key:"error",action:e}),setTimeout(z,5e3)},onSuccess:function(e,t){N({key:"success",action:"DELETE_VENDOR"}),m.invalidateQueries("FSM_VENDOR_SEARCH"),V(),setTimeout(z,5e3)}}),void I(!1);case"ADD_VENDOR":return function(){var e,t=M,n=null==x||null===(e=x[0])||void 0===e?void 0:e.vehicleData;n.vendorVehicleStatus="ACTIVE";var i={vendor:c({},t,{vehicles:t.vehicles?[].concat(t.vehicles,[n]):[n]})};Y(i,{onError:function(e,t){N({key:"error",action:e}),setTimeout(z,5e3)},onSuccess:function(e,t){N({key:"success",action:"EDIT_VENDOR"}),V(),m.invalidateQueries("DSO_SEARCH"),setTimeout(z,5e3)}}),I(!1),y(null)}();case"EDIT_VENDOR":return function(){var e,t=M,n=null==x||null===(e=x[0])||void 0===e?void 0:e.vehicleData;n.vendorVehicleStatus="ACTIVE";var i={vendor:c({},t,{vehicles:t.vehicles?[].concat(t.vehicles,[n]):[n]})};Y(i,{onError:function(e,t){N({key:"error",action:e}),setTimeout(z,5e3)},onSuccess:function(e,t){N({key:"success",action:"EDIT_VENDOR"}),V(),m.invalidateQueries("DSO_SEARCH"),setTimeout(z,5e3)}}),I(!1),y(null)}()}var e,t,n,i,l}},"DELETE"===g||"DELETE_VENDOR"===g?j():i.createElement(t.Card,{style:{boxShadow:"none"}},j())),C&&i.createElement(t.Toast,{error:"error"===C.key,label:d("success"===C.key?"ES_FSM_REGISTRY_"+C.action+"_SUCCESS":C.action),onClose:z}),i.createElement(t.ActionBar,{style:{zIndex:"19"}},E?i.createElement(t.Menu,{localeKeyPrefix:"ES_FSM_REGISTRY_ACTION",options:["EDIT","DELETE"],t:d,onSelect:G}):null,i.createElement(t.SubmitBar,{label:d("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return _(!E)}}))))},AddVehicle:function(e){var a=Digit.ULBService.getCurrentTenantId(),u=Digit.ULBService.getStateId(),s=n.useState(null),d=s[0],v=s[1],m=r.useHistory(),f=o.useQueryClient(),p=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],E=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],_=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2],S=Digit.Hooks.fsm.useVehicleCreate(a).mutate;n.useEffect(function(){p(!1),_(),E()},[]);var g=l.useTranslation().t,y=Le(g),h=n.useState(!1),T=h[0],I=h[1],D=function(){v(null)},C=window.Digit.Utils.browser.isMobile();return i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,g("ES_FSM_REGISTRY_TITLE_NEW_VEHICLE"))),i.createElement("div",{style:C?{}:{marginLeft:"-15px"}},i.createElement(t.FormComposer,{isDisabled:!T,label:g("ES_COMMON_APPLICATION_SUBMIT"),config:y.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},onSubmit:function(e){var t,n,i,l,r,o,c=null==e?void 0:e.registrationNumber,s=null==e||null===(t=e.vehicle)||void 0===t||null===(n=t.type)||void 0===n?void 0:n.code,d=null==e||null===(i=e.vehicle)||void 0===i||null===(l=i.modal)||void 0===l?void 0:l.code,p=null==e||null===(r=e.vehicle)||void 0===r||null===(o=r.type)||void 0===o?void 0:o.capacity,E=new Date(""+(null==e?void 0:e.pollutionCert)).getTime(),_=new Date(""+(null==e?void 0:e.insurance)).getTime(),g=new Date(""+(null==e?void 0:e.roadTax)).getTime(),y=new Date(""+(null==e?void 0:e.fitnessValidity)).getTime(),h=null==e?void 0:e.ownerName,T=null==e?void 0:e.phone,I=null==e?void 0:e.additionalDetails,C={vehicle:{tenantId:a,registrationNumber:c,model:d,type:s,tankCapacity:p,suctionType:"SEWER_SUCTION_MACHINE",pollutionCertiValidTill:E,InsuranceCertValidTill:_,fitnessValidTill:y,roadTaxPaidTill:g,gpsEnabled:!0,source:"Municipal records",owner:{tenantId:u,name:h,fatherOrHusbandName:h,relationship:"OTHER",gender:"OTHERS",dob:new Date("1/1/1970").getTime(),emailId:"abc@egov.com",correspondenceAddress:"",mobileNumber:T},additionalDetails:{description:I}}};S(C,{onError:function(e,t){v({key:"error",action:e}),setTimeout(D,5e3)},onSuccess:function(e,t){v({key:"success",action:"ADD_VEHICLE"}),setTimeout(D,5e3),f.invalidateQueries("FSM_VEICLES_SEARCH"),setTimeout(function(){D(),m.push("/digit-ui/employee/fsm/registry")},5e3)}})},defaultValues:{tripData:{noOfTrips:1,amountPerTrip:null,amount:null}},onFormValueChange:function(e,t){var n,i;null!=t&&t.registrationNumber&&null!=t&&t.ownerName&&null!=t&&t.phone&&null!=t&&null!==(n=t.vehicle)&&void 0!==n&&n.modal&&null!=t&&null!==(i=t.vehicle)&&void 0!==i&&i.type?I(!0):I(!1)},noBreakLine:!0}),d&&i.createElement(t.Toast,{error:"error"===d.key,label:g("success"===d.key?"ES_FSM_REGISTRY_"+d.action+"_SUCCESS":d.action),onClose:D})))},EditVehicle:function(e){var a=Digit.ULBService.getCurrentTenantId(),u=(Digit.ULBService.getStateId(),r.useParams().id),s=n.useState(null),d=s[0],v=s[1],m=n.useState(!1),f=m[0],p=m[1],E=n.useState({}),_=E[0],S=E[1],g=n.useState({}),y=g[0],h=g[1],T=o.useQueryClient(),I=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],D=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],C=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2],N=Digit.Hooks.fsm.useVehicleDetails(a,{registrationNumber:u},{staleTime:Infinity}),A=N.data,O=N.isLoading,L=Digit.Hooks.fsm.useUpdateVehicle(a).mutate;n.useEffect(function(){I(!1),C(),D()},[]),n.useEffect(function(){if(A&&A[0]){var e,t,n,i,l,r,a,o,u,c,s,d,v,m,f,p,E,_,g=A[0];h(null==g?void 0:g.vehicleData);var y={registrationNumber:null==g||null===(e=g.vehicleData)||void 0===e?void 0:e.registrationNumber,vehicle:{type:null==g||null===(t=g.vehicleData)||void 0===t?void 0:t.type,modal:null==g||null===(n=g.vehicleData)||void 0===n?void 0:n.model,tankCapacity:null==g||null===(i=g.vehicleData)||void 0===i?void 0:i.tankCapacity},pollutionCert:(null==g||null===(l=g.vehicleData)||void 0===l?void 0:l.pollutionCertiValidTill)&&Digit.DateUtils.ConvertTimestampToDate(null==g||null===(r=g.vehicleData)||void 0===r?void 0:r.pollutionCertiValidTill,"yyyy-MM-dd"),insurance:(null==g||null===(a=g.vehicleData)||void 0===a?void 0:a.InsuranceCertValidTill)&&Digit.DateUtils.ConvertTimestampToDate(null==g||null===(o=g.vehicleData)||void 0===o?void 0:o.InsuranceCertValidTill,"yyyy-MM-dd"),roadTax:(null==g||null===(u=g.vehicleData)||void 0===u?void 0:u.roadTaxPaidTill)&&Digit.DateUtils.ConvertTimestampToDate(null==g||null===(c=g.vehicleData)||void 0===c?void 0:c.roadTaxPaidTill,"yyyy-MM-dd"),fitnessValidity:(null==g||null===(s=g.vehicleData)||void 0===s?void 0:s.fitnessValidTill)&&Digit.DateUtils.ConvertTimestampToDate(null==g||null===(d=g.vehicleData)||void 0===d?void 0:d.fitnessValidTill,"yyyy-MM-dd"),phone:null==g||null===(v=g.vehicleData)||void 0===v||null===(m=v.owner)||void 0===m?void 0:m.mobileNumber,ownerName:null==g||null===(f=g.vehicleData)||void 0===f||null===(p=f.owner)||void 0===p?void 0:p.name,additionalDetails:null==g||null===(E=g.vehicleData)||void 0===E||null===(_=E.additionalDetails)||void 0===_?void 0:_.description};S(y)}},[A]);var R=l.useTranslation().t,M=r.useHistory(),b=Le(R,!0),P=function(){v(null)},F=window.Digit.Utils.browser.isMobile();return O||0==Object.keys(_).length?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,R("ES_FSM_REGISTRY_TITLE_EDIT_VEHICLE"))),i.createElement("div",{style:F?{}:{marginLeft:"-15px"}},i.createElement(t.FormComposer,{isDisabled:!f,label:R("ES_COMMON_APPLICATION_SUBMIT"),config:b.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},onSubmit:function(e){var t,n,i,l,r,a,o,s,d,m=(null==e||null===(t=e.vehicle)||void 0===t||null===(n=t.type)||void 0===n?void 0:n.code)||(null==e||null===(i=e.vehicle)||void 0===i?void 0:i.type),f=(null==e||null===(l=e.vehicle)||void 0===l||null===(r=l.modal)||void 0===r?void 0:r.code)||(null==e||null===(a=e.vehicle)||void 0===a?void 0:a.modal),p=(null==e||null===(o=e.vehicle)||void 0===o||null===(s=o.type)||void 0===s?void 0:s.capacity)||(null==e||null===(d=e.vehicle)||void 0===d?void 0:d.tankCapacity),E=new Date(""+(null==e?void 0:e.pollutionCert)).getTime(),_=new Date(""+(null==e?void 0:e.insurance)).getTime(),S=new Date(""+(null==e?void 0:e.roadTax)).getTime(),g=new Date(""+(null==e?void 0:e.fitnessValidity)).getTime(),h={vehicle:c({},y,{model:f,type:m,tankCapacity:p,pollutionCertiValidTill:E,InsuranceCertValidTill:_,fitnessValidTill:g,roadTaxPaidTill:S,additionalDetails:c({},y.additionalDetails,{description:null==e?void 0:e.additionalDetails})})};L(h,{onError:function(e,t){v({key:"error",action:e}),setTimeout(P,5e3)},onSuccess:function(e,t){v({key:"success",action:"UPDATE_VEHICLE"}),setTimeout(P,5e3),T.invalidateQueries("DSO_SEARCH"),setTimeout(function(){P(),M.push("/digit-ui/employee/fsm/registry/vehicle-details/"+u)},5e3)}})},defaultValues:_,onFormValueChange:function(e,t){var n,i;null!=t&&t.registrationNumber&&null!=t&&t.ownerName&&null!=t&&t.phone&&null!=t&&null!==(n=t.vehicle)&&void 0!==n&&n.modal&&null!=t&&null!==(i=t.vehicle)&&void 0!==i&&i.type?p(!0):p(!1)},noBreakLine:!0}),d&&i.createElement(t.Toast,{error:"error"===d.key,label:R("success"===d.key?"ES_FSM_REGISTRY_"+d.action+"_SUCCESS":d.action),onClose:P})))},SelectVehicle:function(e){var l,r=e.t,a=e.config,o=e.onSelect,u=e.formData,s=e.setValue,d=Digit.ULBService.getStateId(),v=Digit.Hooks.fsm.useMDMS(d,"Vehicle","VehicleMakeModel").data,m=(Digit.ULBService.getCurrentTenantId(),n.useState([])),f=m[0],p=m[1],E=n.useState({}),_=E[0],S=E[1],g=n.useState([]),y=g[0],h=g[1],T=n.useState({}),I=T[0],D=T[1],C=n.useState(""),N=C[0],A=C[1];return n.useEffect(function(){if(v){var e,t=v.filter(function(e){var t,n,i;return e.code===((null==u||null===(t=u.vehicle)||void 0===t||null===(n=t.modal)||void 0===n?void 0:n.code)||(null==u||null===(i=u.vehicle)||void 0===i?void 0:i.modal))}),n=v.filter(function(e){var t,n,i;return e.code===((null==u||null===(t=u.vehicle)||void 0===t||null===(n=t.type)||void 0===n?void 0:n.code)||(null==u||null===(i=u.vehicle)||void 0===i?void 0:i.type))});S.apply(void 0,t),D.apply(void 0,n),A(null==u||null===(e=u.vehicle)||void 0===e?void 0:e.tankCapacity)}},[null==u?void 0:u.vehicle,v]),n.useEffect(function(){var e;null!=_&&_.code&&(null==_?void 0:_.code)!==(null==u||null===(e=u.vehicle)||void 0===e?void 0:e.modal)&&(D(""),A(""),s("additionalDetails",""),s("pollutionCert",void 0),s("insurance",void 0),s("roadTax",void 0),s("fitnessValidity",void 0))},[null==u||null===(l=u.vehicle)||void 0===l?void 0:l.modal]),n.useEffect(function(){if(v){var e=v.filter(function(e){return void 0===e.make});p(e)}},[v]),i.createElement("div",null,i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},r("ES_FSM_REGISTRY_VEHICLE_MODEL"),a.isMandatory?" * ":null),i.createElement(t.Dropdown,{className:"form-field",isMandatory:!0,selected:_,disable:!1,option:f,select:function(e){var t=v.filter(function(t){return t.make===e.code});h(t),S(e),o(a.key,c({},u[a.key],{modal:e,type:""}))},optionKey:"name",t:r})),i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},r("ES_FSM_REGISTRY_VEHICLE_TYPE"),a.isMandatory?" * ":null),i.createElement(t.Dropdown,{className:"form-field",isMandatory:!0,selected:I,option:y,select:function(e){A(e.capacity),D(e),o(a.key,c({},u[a.key],{type:e}))},optionKey:"name",t:r})),i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},r("ES_FSM_REGISTRY_VEHICLE_CAPACITY"),a.isMandatory?" * ":null),i.createElement(t.TextInput,{className:"",textInputStyle:{width:"50%"},value:N,onChange:function(){},disable:!0})))},AddDriver:function(e){var a=Digit.ULBService.getCurrentTenantId(),u=Digit.ULBService.getStateId(),s=n.useState(null),d=s[0],v=s[1],m=r.useHistory(),f=o.useQueryClient(),p=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],E=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],_=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2],S=Digit.Hooks.fsm.useDriverCreate(a).mutate;n.useEffect(function(){p(!1),_(),E()},[]);var g=l.useTranslation().t,y=Fe(g),h=n.useState(!1),T=h[0],I=h[1],D=function(){v(null)},C=window.Digit.Utils.browser.isMobile();return i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,g("ES_FSM_REGISTRY_TITLE_NEW_DRIVER"))),i.createElement("div",{style:C?{}:{marginLeft:"-15px"}},i.createElement(t.FormComposer,{isDisabled:!T,label:g("ES_COMMON_APPLICATION_SUBMIT"),config:y.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},onSubmit:function(e){var t,n=null==e?void 0:e.driverName,i=null==e?void 0:e.license,l=null==e||null===(t=e.selectGender)||void 0===t?void 0:t.code,r=null==e?void 0:e.emailId,o=null==e?void 0:e.phone,c=new Date(""+e.dob).getTime()||new Date("1/1/1970").getTime();S({driver:{tenantId:a,name:n,licenseNumber:i,additionalDetails:null==e?void 0:e.additionalDetails,status:"ACTIVE",owner:{tenantId:u,name:n,fatherOrHusbandName:n,relationship:"OTHER",gender:l,dob:c,emailId:r||"abc@egov.com",mobileNumber:o},vendorDriverStatus:"INACTIVE"}},{onError:function(e,t){v({key:"error",action:e}),setTimeout(D,5e3)},onSuccess:function(e,t){v({key:"success",action:"ADD_DRIVER"}),setTimeout(D,5e3),f.invalidateQueries("FSM_DRIVER_SEARCH"),setTimeout(function(){D(),m.push("/digit-ui/employee/fsm/registry")},5e3)}})},defaultValues:{tripData:{noOfTrips:1,amountPerTrip:null,amount:null}},onFormValueChange:function(e,t){I(!!(null!=t&&t.driverName&&null!=t&&t.phone&&null!=t&&t.selectGender))},noBreakLine:!0}),d&&i.createElement(t.Toast,{error:"error"===d.key,label:g("success"===d.key?"ES_FSM_"+d.action+"_SUCCESS":d.action),onClose:D})))},DriverDetails:function(e){var a,u,s=Digit.ULBService.getCurrentTenantId(),d=(Digit.ULBService.getStateId(),l.useTranslation().t),v=r.useHistory(),m=o.useQueryClient(),f=r.useParams().id,p=n.useState(!1),E=p[0],_=p[1],S=n.useState(null),g=S[0],y=S[1],h=(n.useState({}),n.useState(!1)),T=h[0],I=h[1],D=n.useState(null),C=D[0],N=D[1],A=n.useState([]),O=A[0],L=A[1],R=n.useState({}),M=R[0],b=R[1],P=Digit.Hooks.fsm.useDriverDetails(s,{ids:f},{staleTime:Infinity}),F=P.data,k=P.isLoading,w=P.refetch,x=Digit.Hooks.fsm.useDsoSearch(s,{sortBy:"name",sortOrder:"ASC",status:"ACTIVE"},{}).data,H=Digit.Hooks.fsm.useDriverUpdate(s).mutate,V=Digit.Hooks.fsm.useVendorUpdate(s).mutate;function U(e){y(e),_(!1)}n.useEffect(function(){if(x){var e=x.map(function(e){return e.dsoDetails});L(e)}},[x]),n.useEffect(function(){w()},[]),n.useEffect(function(){switch(g){case"DELETE":case"ADD_VENDOR":case"EDIT_VENDOR":case"DELETE_VENDOR":return I(!0);case"EDIT":return v.push("/digit-ui/employee/fsm/registry/modify-driver/"+f)}},[g]);var B=function(){N(null)},Y=function(){y(null),b({}),I(!1)},G=function(){return"DELETE"===g||"DELETE_VENDOR"===g?i.createElement(ge,{t:d,title:"ES_FSM_REGISTRY_DELETE_TEXT"}):"ADD_VENDOR"===g||"EDIT_VENDOR"===g?i.createElement(n.Fragment,null,i.createElement(t.CardText,null,d("ES_FSM_REGISTRY_SELECT_VENODOR")),i.createElement(t.Dropdown,{t:d,option:O,value:M,selected:M,select:b,optionKey:"name"})):void 0},z=window.Digit.Utils.browser.isMobile();return k?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,k?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement(t.Header,{style:{marginBottom:"16px"}},d("ES_FSM_REGISTRY_DRIVER_DETAILS")),i.createElement("div",{style:z?{}:{marginLeft:"-15px"}},i.createElement(t.Card,{style:{position:"relative"}},null==F||null===(a=F[0])||void 0===a||null===(u=a.employeeResponse)||void 0===u?void 0:u.map(function(e,l){var r;return i.createElement(i.Fragment,{key:l},l>0&&i.createElement(t.CardSectionHeader,{style:{marginBottom:"16px",marginTop:"32px"}},d(e.title)),i.createElement(t.StatusTable,null,null==e||null===(r=e.values)||void 0===r?void 0:r.map(function(l,r){var a,o;return"custom"===(null==l?void 0:l.type)?i.createElement(n.Fragment,null,i.createElement("div",{className:(r===(null==e||null===(a=e.values)||void 0===a?void 0:a.length)-1?"row last":"row")+" border-none"},i.createElement("h2",null,d(l.title)),i.createElement("div",{className:"value",style:{color:"#f47738",display:"flex"}},d(l.value)||"N/A","ES_FSM_REGISTRY_DETAILS_ADD_VENDOR"===l.value&&i.createElement("span",{onClick:function(){return U("ADD_VENDOR")}},i.createElement(t.AddIcon,{className:"",fill:"#f47738",styles:{cursor:"pointer",marginLeft:"20px",height:"24px"}})),"ES_FSM_REGISTRY_DETAILS_ADD_VENDOR"!=l.value&&i.createElement("span",{onClick:function(){return U("EDIT_VENDOR")}},i.createElement(t.EditIcon,{style:{cursor:"pointer",marginLeft:"20px"}})),"ES_FSM_REGISTRY_DETAILS_ADD_VENDOR"!=l.value&&i.createElement("span",{onClick:function(){return U("DELETE_VENDOR")}},i.createElement(t.DeleteIcon,{className:"delete",fill:"#f47738",style:{cursor:"pointer",marginLeft:"20px"}}))))):i.createElement(t.Row,{key:d(l.title),label:d(l.title),text:d(l.value)||"N/A",last:r===(null==e||null===(o=e.values)||void 0===o?void 0:o.length)-1,caption:l.caption,className:"border-none"})})))}))),T&&i.createElement(t.Modal,{headerBarMain:i.createElement(Re,{label:d(function(){switch(g){case"DELETE":case"DELETE_VENDOR":return"ES_FSM_REGISTRY_DELETE_POPUP_HEADER";case"ADD_VENDOR":case"EDIT_VENDOR":return"ES_FSM_REGISTRY_ADD_VENDOR_POPUP_HEADER"}}())}),headerBarEnd:i.createElement(be,{onClick:Y}),actionCancelLabel:d("CS_COMMON_CANCEL"),actionCancelOnSubmit:Y,actionSaveLabel:d("DELETE"===g||"DELETE_VENDOR"===g?"ES_EVENT_DELETE":"CS_COMMON_SUBMIT"),actionSaveOnSubmit:function(){switch(g){case"DELETE":return t={driver:c({},null==F||null===(e=F[0])||void 0===e?void 0:e.driverData,{status:"INACTIVE"})},H(t,{onError:function(e,t){N({key:"error",action:e}),setTimeout(B,5e3)},onSuccess:function(e,t){N({key:"success",action:"DELETE_DRIVER"}),m.invalidateQueries("DSO_SEARCH"),setTimeout(function(){v.push("/digit-ui/employee/fsm/registry")},5e3)}}),void I(!1);case"DELETE_VENDOR":return function(){var e,t,n,i,l=null==F||null===(e=F[0])||void 0===e||null===(t=e.vendorDetails)||void 0===t||null===(n=t.vendor)||void 0===n?void 0:n[0],r=null==l?void 0:l.drivers;i={vendor:c({},l,{drivers:r=r.map(function(e){return e.id===f&&(e.vendorDriverStatus="INACTIVE"),e})})},V(i,{onError:function(e,t){N({key:"error",action:e}),setTimeout(B,5e3)},onSuccess:function(e,t){N({key:"success",action:"DELETE_VENDOR"}),m.invalidateQueries("FSM_VENDOR_SEARCH"),w(),setTimeout(B,5e3)}}),I(!1)}();case"ADD_VENDOR":return function(){var e,t=M,n=null==F||null===(e=F[0])||void 0===e?void 0:e.driverData;n.vendorDriverStatus="ACTIVE";var i={vendor:c({},t,{drivers:t.drivers?[].concat(t.drivers,[n]):[n]})};V(i,{onError:function(e,t){N({key:"error",action:e}),w(),setTimeout(B,5e3)},onSuccess:function(e,t){N({key:"success",action:"ADD_VENDOR"}),m.invalidateQueries("DSO_SEARCH"),w(),setTimeout(B,5e3)}}),I(!1),y(null)}();case"EDIT_VENDOR":return function(){var e,t=M,n=null==F||null===(e=F[0])||void 0===e?void 0:e.driverData;n.vendorDriverStatus="ACTIVE";var i={vendor:c({},t,{drivers:t.drivers?[].concat(t.drivers,[n]):[n]})};V(i,{onError:function(e,t){N({key:"error",action:e}),setTimeout(B,5e3)},onSuccess:function(e,t){N({key:"success",action:"EDIT_VENDOR"}),w(),m.invalidateQueries("DSO_SEARCH"),setTimeout(B,5e3)}}),I(!1),y(null)}()}var e,t},formId:"modal-action"},"DELETE"===g||"DELETE_VENDOR"===g?G():i.createElement(t.Card,{style:{boxShadow:"none"}},G())),C&&i.createElement(t.Toast,{error:"error"===C.key,label:d("success"===C.key?"ES_FSM_REGISTRY_"+C.action+"_SUCCESS":C.action),onClose:B}),i.createElement(t.ActionBar,{style:{zIndex:"19"}},E?i.createElement(t.Menu,{localeKeyPrefix:"ES_FSM_REGISTRY_ACTION",options:["EDIT","DELETE"],t:d,onSelect:U}):null,i.createElement(t.SubmitBar,{label:d("ES_COMMON_TAKE_ACTION"),onSubmit:function(){return _(!E)}}))))},EditDriver:function(e){var a=Digit.ULBService.getCurrentTenantId(),u=(Digit.ULBService.getStateId(),r.useParams().id),s=n.useState(null),d=s[0],v=s[1],m=n.useState(!1),f=m[0],p=m[1],E=n.useState({}),_=E[0],S=E[1],g=n.useState({}),y=g[0],h=g[1],T=o.useQueryClient(),I=Digit.Hooks.useSessionStorage("FSM_MUTATION_HAPPENED",!1)[1],D=Digit.Hooks.useSessionStorage("FSM_ERROR_DATA",!1)[2],C=Digit.Hooks.useSessionStorage("FSM_MUTATION_SUCCESS_DATA",!1)[2],N=Digit.Hooks.fsm.useDriverDetails(a,{ids:u},{staleTime:Infinity}),A=N.data,O=N.isLoading,L=Digit.Hooks.fsm.useDriverUpdate(a).mutate;n.useEffect(function(){I(!1),C(),D()},[]),n.useEffect(function(){if(A&&A[0]){var e,t,n,i,l,r,a,o,u,c,s,d,v,m,f,p,E=A[0];h(null==E?void 0:E.driverData);var _={driverName:null==E||null===(e=E.driverData)||void 0===e?void 0:e.name,license:null==E||null===(t=E.driverData)||void 0===t?void 0:t.licenseNumber,selectGender:null==E||null===(n=E.driverData)||void 0===n||null===(i=n.owner)||void 0===i?void 0:i.gender,dob:(null==E||null===(l=E.driverData)||void 0===l||null===(r=l.owner)||void 0===r?void 0:r.dob)&&Digit.DateUtils.ConvertTimestampToDate(null==E||null===(a=E.driverData)||void 0===a||null===(o=a.owner)||void 0===o?void 0:o.dob,"yyyy-MM-dd"),emailId:"abc@egov.com"===(null==E||null===(u=E.driverData)||void 0===u||null===(c=u.owner)||void 0===c?void 0:c.emailId)?"":null==E||null===(s=E.driverData)||void 0===s||null===(d=s.owner)||void 0===d?void 0:d.emailId,phone:null==E||null===(v=E.driverData)||void 0===v||null===(m=v.owner)||void 0===m?void 0:m.mobileNumber,additionalDetails:null==E||null===(f=E.driverData)||void 0===f||null===(p=f.additionalDetails)||void 0===p?void 0:p.description};S(_)}},[A]);var R=l.useTranslation().t,M=r.useHistory(),b=Fe(R,!0),P=function(){v(null)},F=window.Digit.Utils.browser.isMobile();return O||0==Object.keys(_).length?i.createElement(t.Loader,null):i.createElement(i.Fragment,null,i.createElement("div",null,i.createElement(t.Header,null,R("ES_FSM_REGISTRY_TITLE_EDIT_DRIVER"))),i.createElement("div",{style:F?{}:{marginLeft:"-15px"}},i.createElement(t.FormComposer,{isDisabled:!f,label:R("ES_COMMON_APPLICATION_SUBMIT"),config:b.filter(function(e){return!e.hideInEmployee}).map(function(e){return c({},e,{body:e.body.filter(function(e){return!e.hideInEmployee})})}),fieldStyle:{marginRight:0},onSubmit:function(e){var t,n,i=null==e?void 0:e.license,l=null==e||null===(t=e.selectGender)||void 0===t?void 0:t.code,r=null==e?void 0:e.emailId,a=new Date(""+e.dob).getTime(),o={driver:c({},y,{licenseNumber:i,additionalDetails:null==e?void 0:e.additionalDetails,owner:c({},y.owner,{relationship:(null===(n=y.owner)||void 0===n?void 0:n.relationship)||"OTHER",gender:l||y.owner.gender||"OTHER",dob:a,emailId:r||"abc@egov.com"})})};L(o,{onError:function(e,t){v({key:"error",action:e}),setTimeout(P,5e3)},onSuccess:function(e,t){v({key:"success",action:"UPDATE_DRIVER"}),setTimeout(P,5e3),T.invalidateQueries("FSM_DRIVER_SEARCH"),setTimeout(function(){P(),M.push("/digit-ui/employee/fsm/registry/driver-details/"+u)},5e3)}})},defaultValues:_,onFormValueChange:function(e,t){p(!(null==t||!t.selectGender))},noBreakLine:!0}),d&&i.createElement(t.Toast,{error:"error"===d.key,label:R("success"===d.key?"ES_FSM_REGISTRY_"+d.action+"_SUCCESS":d.action),onClose:P})))},FsmBreadCrumb:function(e){var r,a,o,u,c,s,d,v,m,f,p,E,_,S,g,y,h,T=e.location,I=l.useTranslation().t,D=Digit.UserService.hasAccess(["FSM_DSO"]),C=Digit.UserService.hasAccess(["FSM_EMP_FSTPO"]),N=null==T||null===(r=T.pathname)||void 0===r?void 0:r.includes("application-details"),A=null==T||null===(a=T.pathname)||void 0===a?void 0:a.includes("fstp-operator-details"),O=null==T||null===(o=T.pathname)||void 0===o?void 0:o.includes("inbox"),L=null==T||null===(u=T.pathname)||void 0===u?void 0:u.includes("fsm"),R=null==T||null===(c=T.pathname)||void 0===c?void 0:c.includes("search"),M=null==T||null===(s=T.pathname)||void 0===s?void 0:s.includes("registry"),b=null==T||null===(d=T.pathname)||void 0===d?void 0:d.includes("vendor-details"),P=null==T||null===(v=T.pathname)||void 0===v?void 0:v.includes("modify-vendor"),F=null==T||null===(m=T.pathname)||void 0===m?void 0:m.includes("new-application"),k=null==T||null===(f=T.pathname)||void 0===f?void 0:f.includes("vehicle-details"),w=null==T||null===(p=T.pathname)||void 0===p?void 0:p.includes("modify-vehicle"),x=null==T||null===(E=T.pathname)||void 0===E?void 0:E.includes("driver-details"),H=null==T||null===(_=T.pathname)||void 0===_?void 0:_.includes("modify-driver"),V=null==T||null===(S=T.pathname)||void 0===S?void 0:S.includes("modify-application"),U=null==T||null===(g=T.pathname)||void 0===g?void 0:g.includes("new-vendor"),B=null==T||null===(y=T.pathname)||void 0===y?void 0:y.includes("new-vehicle"),Y=null==T||null===(h=T.pathname)||void 0===h?void 0:h.includes("new-driver"),G=n.useState(!1),z=G[0],W=G[1],j=n.useState(!1),K=j[0],X=j[1];n.useEffect(function(){if(z?(L||O&&z)&&W(!1):W(R),null!=T&&T.pathname){var e=null==T?void 0:T.pathname.split("/");X(e[e.length-1])}},[T]);var q=[{path:D?"/digit-ui/citizen/fsm/dso-dashboard":"/digit-ui/employee",content:I("ES_COMMON_HOME"),show:L},{path:M?"/digit-ui/employee/fsm/registry":C?"/digit-ui/employee/fsm/fstp-inbox":"/digit-ui/employee",content:A?I("ES_TITLE_INBOX"):"FSM",show:L},{path:F?"/digit-ui/employee/fsm/new-application":"",content:I("FSM_NEW_DESLUDGING_APPLICATION"),show:L&&F},{path:"",content:""+I("FSM_SUCCESS"),show:!!T.pathname.includes("/employee/fsm/response")},{path:O||R||N?"/digit-ui/employee/fsm/inbox":"",content:I("ES_TITLE_INBOX"),show:L&&O||R||N},{path:"/digit-ui/employee/fsm/search",content:I("ES_TITILE_SEARCH_APPLICATION"),show:z},{content:I("ES_TITLE_APPLICATION_DETAILS"),show:N},{content:I("ES_TITLE_VEHICLE_LOG"),show:A},{path:"/digit-ui/employee/fsm/registry/vendor-details/"+K,content:I("ES_TITLE_VENDOR_DETAILS"),show:M&&(b||P)},{path:"/digit-ui/employee/fsm/registry/vehicle-details/"+K,content:I("ES_TITLE_VEHICLE_DETAILS"),show:M&&(k||w)},{path:"/digit-ui/employee/fsm/registry/driver-details/"+K,content:I("ES_TITLE_DRIVER_DETAILS"),show:M&&(x||H)},{content:I("ES_TITLE_VENDOR_EDIT"),show:M&&(P||w||H)},{path:"digit-ui/employee/fsm/modify-application/"+K,content:I("ES_FSM_APPLICATION_UPDATE"),show:V},{content:U?I("ES_FSM_ACTION_CREATE_VENDOR"):B?I("ES_FSM_REGISTRY_DETAILS_TYPE_VEHICLE"):Y?I("ES_FSM_REGISTRY_DETAILS_TYPE_DRIVER"):null,show:M&&(U||B||Y)}];return i.createElement(t.BreadCrumb,{crumbs:q})},AdvanceCollection:function(e){var l,a,o,u,s,d,v=e.t,m=e.config,f=e.onSelect,p=e.formData,E=e.FSMTextFieldStyle,_=Digit.ULBService.getCurrentTenantId(),S=Digit.ULBService.getStateId(),g=r.useLocation().pathname,y=r.useParams().id,h=Digit.UserService.getUser(),T=n.useState(),I=T[0],D=T[1],C=n.useState(),N=C[0],A=C[1],O=Digit.Hooks.fsm.useSearch(_,{applicationNos:y,uuid:h.uuid},{staleTime:Infinity}).data,L=n.useState({label:null==p||null===(l=p.tripData)||void 0===l?void 0:l.vehicleCapacity}),R=L[0],M=L[1],b=n.useState(!1)[1],P=Digit.Hooks.fsm.useMDMS(S,"Vehicle","VehicleType",{staleTime:Infinity}).isLoading,F=Digit.Hooks.fsm.useDsoSearch(_,{limit:-1,status:"ACTIVE"}).isLoading,k=[{label:"ES_NEW_APPLICATION_ADVANCE_COLLECTION",type:"text",name:"advanceAmount",validation:{isRequired:!0,min:"0",pattern:"^[0-9]+",title:v("ES_NEW_APPLICATION_AMOUNT_INVALID")},default:null==p?void 0:p.advanceAmount,isMandatory:!0}];return n.useEffect(function(){!function(){try{var e,t,n;(null==p||null===(e=p.tripData)||void 0===e?void 0:e.vehicleType)!==R&&M({label:null==p||null===(t=p.tripData)||void 0===t||null===(n=t.vehicleType)||void 0===n?void 0:n.capacity});var i=function(){var e,t;if(null!=p&&p.propertyType&&null!=p&&p.subtype&&null!=p&&p.address&&null!=p&&null!==(e=p.tripData)&&void 0!==e&&null!==(t=e.vehicleType)&&void 0!==t&&t.capacity){var n,i=null==p||null===(n=p.tripData)||void 0===n?void 0:n.vehicleType.capacity;return Promise.resolve(Digit.FSMService.billingSlabSearch(_,{propertyType:null==p?void 0:p.subtype,capacity:i,slum:p.address.slum?"YES":"NO"})).then(function(e){var t,n=(null==e||null===(t=e.billingSlab)||void 0===t?void 0:t.length)&&(null==e?void 0:e.billingSlab[0]),i=function(){if(null!=n&&n.price||0===(null==n?void 0:n.price)){var e=n.price*p.tripData.noOfTrips;return Promise.resolve(Digit.FSMService.advanceBalanceCalculate(_,{totalTripAmount:e})).then(function(t){var n,i=t.advanceAmount;Digit.SessionStorage.set("total_amount",e),Digit.SessionStorage.set("advance_amount",i),D(e),A(i),(!g.includes("modify")||g.includes("modify")&&i>(null==p||null===(n=p.advancepaymentPreference)||void 0===n?void 0:n.advanceAmount))&&f(m.key,c({},p[m.key],{advanceAmount:i})),b(!1)})}sessionStorage.removeItem("Digit.total_amount"),sessionStorage.removeItem("Digit.advance_amount"),b(!0)}();if(i&&i.then)return i.then(function(){})})}}();i&&i.then&&i.then(function(){})}catch(e){Promise.reject(e)}}()},[null==p?void 0:p.propertyType,null==p?void 0:p.subtype,null==p||null===(a=p.address)||void 0===a?void 0:a.slum,null==p||null===(o=p.tripData)||void 0===o||null===(u=o.vehicleType)||void 0===u?void 0:u.capacity,null==p||null===(s=p.tripData)||void 0===s?void 0:s.noOfTrips]),P&&F?i.createElement(t.Loader,null):i.createElement("div",null,0!==(null==p||null===(d=p.tripData)||void 0===d?void 0:d.amountPerTrip)&&(null==k?void 0:k.map(function(e,n){var l,r=p&&p[m.key]&&p[m.key][e.name];return i.createElement(i.Fragment,{key:n},i.createElement(t.LabelFieldPair,{key:n},i.createElement(t.CardLabel,{className:"card-label-smaller"},v(e.label)+" (₹)",e.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(t.TextInput,c({disabled:!!(g.includes("modify")&&0===(null==p||null===(l=p.advancepaymentPreference)||void 0===l?void 0:l.advanceAmount)||N===I),type:e.type,key:e.name,style:E,onChange:function(e){f(m.key,c({},p[m.key],{advanceAmount:e.target.value}))},value:e.default?e.default:p&&p[m.key]?p[m.key][e.name]:null},e.validation)),r>I&&i.createElement(t.CardLabelError,{style:{width:"100%",marginTop:"-15px",fontSize:"14px",marginBottom:"0px"}},v("FSM_ADVANCE_AMOUNT_MAX")),r<N&&i.createElement(t.CardLabelError,{style:{width:"100%",marginTop:"-15px",fontSize:"14px",marginBottom:"0px"}},v("FSM_ADVANCE_AMOUNT_MIN")),g.includes("modify-application")&&0===Number(N)&&(null==O?void 0:O.advanceAmount)>0&&0===Number(r)&&i.createElement(t.CardLabelError,{style:{width:"100%",marginTop:"-15px",fontSize:"14px",marginBottom:"0px"}},v("FSM_ADVANCE_AMOUNT_NOT_ZERO")))))})))},SelectTrips:function(e){var l,a,o,u,s,d=e.t,v=e.config,m=e.onSelect,f=e.formData,p=void 0===f?{}:f,E=e.styles,_=e.FSMTextFieldStyle,S=Digit.ULBService.getCurrentTenantId(),g=Digit.ULBService.getStateId(),y=r.useLocation().pathname.includes("/modify-application/"),h=r.useParams().id,T=Digit.UserService.getUser(),I=Digit.Hooks.fsm.useSearch(S,{applicationNos:h,uuid:T.uuid},{staleTime:Infinity}).data,D=n.useState({label:null==p||null===(l=p.tripData)||void 0===l?void 0:l.vehicleCapacity}),C=D[0],N=D[1],A=n.useState(!1),O=A[0],L=A[1],R=Digit.Hooks.fsm.useMDMS(g,"Vehicle","VehicleType",{staleTime:Infinity}),M=R.isLoading,b=R.data,P=Digit.Hooks.fsm.useDsoSearch(S,{limit:-1,status:"ACTIVE"}),F=P.data,k=P.isLoading,w=n.useState([]),x=w[0],H=w[1];n.useEffect(function(){if(F&&b){var e=F.reduce(function(e,t){return t.vehicles&&t.vehicles.length?e.concat(t.vehicles):e},[]),t=Array.from(new Set(e.map(function(e){return e.capacity}))).map(function(t){return e.find(function(e){return e.capacity===t})});H(t)}},[F,b]);var V=[{label:"ES_NEW_APPLICATION_PAYMENT_NO_OF_TRIPS",type:"text",name:"noOfTrips",error:d("ES_NEW_APPLICATION_NO_OF_TRIPS_INVALID"),validation:{isRequired:!0,pattern:"^[1-9]+",min:"1",title:d("ES_NEW_APPLICATION_NO_OF_TRIPS_INVALID")},default:null==p||null===(a=p.tripData)||void 0===a?void 0:a.noOfTrips,disable:!1,isMandatory:!0}];function U(e){m(v.key,c({},p[v.key],e))}return n.useEffect(function(){!function(){try{var e,t,n;(null==p||null===(e=p.tripData)||void 0===e?void 0:e.vehicleType)!==C&&N({label:null==p||null===(t=p.tripData)||void 0===t||null===(n=t.vehicleType)||void 0===n?void 0:n.capacity});var i=function(){var e,t;if(null!=p&&p.propertyType&&null!=p&&p.subtype&&null!=p&&p.address&&null!=p&&null!==(e=p.tripData)&&void 0!==e&&null!==(t=e.vehicleType)&&void 0!==t&&t.capacity){var n,i=null==p||null===(n=p.tripData)||void 0===n?void 0:n.vehicleType.capacity;return Promise.resolve(Digit.FSMService.billingSlabSearch(S,{propertyType:null==p?void 0:p.subtype,capacity:i,slum:p.address.slum?"YES":"NO"})).then(function(e){var t,n=(null==e||null===(t=e.billingSlab)||void 0===t?void 0:t.length)&&(null==e?void 0:e.billingSlab[0]);null!=n&&n.price||0===(null==n?void 0:n.price)?(U({amountPerTrip:n.price,amount:n.price*p.tripData.noOfTrips}),L(!1)):(U({amountPerTrip:"",amount:""}),L(!0))})}}();i&&i.then&&i.then(function(){})}catch(e){Promise.reject(e)}}()},[null==p?void 0:p.propertyType,null==p?void 0:p.subtype,null==p?void 0:p.address,null==p||null===(o=p.tripData)||void 0===o||null===(u=o.vehicleType)||void 0===u?void 0:u.capacity,null==p||null===(s=p.tripData)||void 0===s?void 0:s.noOfTrips]),M&&k?i.createElement(t.Loader,null):i.createElement("div",null,i.createElement(t.LabelFieldPair,null,i.createElement(t.CardLabel,{className:"card-label-smaller"},d("ES_NEW_APPLICATION_LOCATION_VEHICLE_REQUESTED")+" * "),i.createElement(t.Dropdown,{className:"form-field",style:E,isMandatory:!0,option:null==x?void 0:x.map(function(e){return c({},e,{label:e.capacity})}).sort(function(e,t){return e.capacity-t.capacity}),optionKey:"label",id:"vehicle",selected:C,select:function(e){N({label:e.capacity}),m(v.key,c({},p[v.key],{vehicleType:e}))},t:d,disable:!(!y||"CREATED"==(null==I?void 0:I.applicationStatus))})),null==V?void 0:V.map(function(e,n){return i.createElement(t.LabelFieldPair,{key:n},i.createElement(t.CardLabel,{className:"card-label-smaller"},d(e.label),e.isMandatory?" * ":null),i.createElement("div",{className:"field"},i.createElement(t.TextInput,c({type:e.type,style:c({},E,_),onChange:function(e){m(v.key,c({},p[v.key],{noOfTrips:e.target.value}))},key:e.name,value:e.default?e.default:p&&p[v.key]?p[v.key][e.name]:null},e.validation,{disable:e.disable}))))}),O?i.createElement(t.CardLabelError,{style:{width:"100%",textAlign:"center"}},d("ES_APPLICATION_BILL_SLAB_ERROR")):null)},PlusMinusInput:ee,ConfirmationBox:ge};exports.initFSMComponents=function(){Object.entries(ke).forEach(function(e){Digit.ComponentRegistryService.setComponent(e[0],e[1])})};
