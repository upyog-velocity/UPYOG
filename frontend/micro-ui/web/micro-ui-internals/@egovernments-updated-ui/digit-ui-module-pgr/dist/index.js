function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var n,l=require("react"),a=e(l),o=require("react-router-dom"),r=require("react-i18next"),i=require("@egovernments/digit-ui-react-components"),s=require("redux"),c=require("react-redux"),u=e(require("lodash.merge")),m=require("react-hook-form"),d=require("react-query");function p(e,t){switch(void 0===e&&(e={}),t.type){case"CREATE_COMPLAINT":return{...e,response:t.payload};case"FETCH_COMPLAINTS":return{...e,list:t.payload.complaints};case"UPDATE_COMPLAINT":return{...e,response:t.payload};case"APPLY_INBOX_FILTER":return{...e,response:t.payload.response.instances};default:return e}}const E={Inbox:"/inbox",ComplaintDetails:"/complaint/details/",CreateComplaint:"/complaint/create",Response:"/response",Home:"/"+(null===(n=window)||void 0===n?void 0:n.contextPath)+"/employee"},C=(e,t)=>""+e.path+t,S=e=>{const t=o.useHistory(),{t:n}=r.useTranslation(),{id:s}=o.useParams(),[c,u]=l.useState(null),[m,d]=l.useState(!0);return a.createElement(i.Card,null,a.createElement(i.CardHeader,null,n("CS_REOPEN_COMPLAINT")),a.createElement(i.CardText,null),m?null:a.createElement(i.CardLabelError,null,n("CS_ADDCOMPLAINT_ERROR_REOPEN_REASON")),a.createElement(i.RadioButtons,{onSelect:e=>{let t=Digit.SessionStorage.get("reopen."+s);Digit.SessionStorage.set("reopen."+s,{...t,reason:e}),u(e)},selectedOption:c,options:[n("CS_REOPEN_OPTION_ONE"),n("CS_REOPEN_OPTION_TWO"),n("CS_REOPEN_OPTION_THREE"),n("CS_REOPEN_OPTION_FOUR")]}),a.createElement(i.SubmitBar,{label:n("CS_COMMON_NEXT"),onSubmit:function(){null===c?d(!1):t.push(e.match.path+"/upload-photo/"+s)}}))},_=e=>{var t,n;const{t:s}=r.useTranslation(),c=o.useHistory();let{id:u}=o.useParams();const[m,d]=l.useState(null),[p,E]=l.useState(!0);return l.useEffect(()=>{let e=Digit.SessionStorage.get("reopen."+u);Digit.SessionStorage.set("reopen."+u,{...e,verificationDocuments:m})},[m,u]),a.createElement(a.Fragment,null,a.createElement(i.Card,null,a.createElement(i.ImageUploadHandler,{header:s("CS_ADDCOMPLAINT_UPLOAD_PHOTO"),tenantId:null==e||null===(t=e.complaintDetails)||void 0===t||null===(n=t.service)||void 0===n?void 0:n.tenantId,cardText:"",onPhotoChange:e=>{(e=>{if(null!=e&&e.length){const t=e.map(e=>({documentType:"PHOTO",fileStoreId:e,documentUid:"",additionalDetails:{}}));d(t)}})(e)},uploadedImages:null}),p?null:a.createElement(i.CardLabelError,null,s("CS_ADDCOMPLAINT_UPLOAD_ERROR_MESSAGE")),a.createElement(i.SubmitBar,{label:s("PT_COMMONS_NEXT"),onSubmit:function(){null===m?E(!1):c.push(e.match.path+"/addional-details/"+u)}}),e.skip?a.createElement(i.LinkButton,{label:s("CORE_COMMON_SKIP_CONTINUE"),onClick:function(){c.push(e.match.path+"/addional-details/"+u)}}):null))},f=e=>{let{cityCode:t,complaintType:n,description:l,landmark:a,city:o,district:r,region:i,state:s,pincode:c,localityCode:u,localityName:m,uploadedImages:d,mobileNumber:p,name:E}=e;return function(e,C){try{return Promise.resolve(Digit.Complaint.create({cityCode:t,complaintType:n,description:l,landmark:a,city:o,district:r,region:i,state:s,pincode:c,localityCode:u,localityName:m,uploadedImages:d,mobileNumber:p,name:E})).then(function(t){e({type:"CREATE_COMPLAINT",payload:t})})}catch(e){return Promise.reject(e)}}},O=e=>function(t){try{return Promise.resolve(Digit.PGRService.update(e)).then(function(e){t({type:"UPDATE_COMPLAINT",payload:e})})}catch(e){return Promise.reject(e)}},v=e=>{const t=o.useHistory();let{id:n}=o.useParams();const s=c.useDispatch(),u=c.useSelector(e=>e).common;let{t:m}=r.useTranslation();const{complaintDetails:d}=e;l.useEffect(()=>{if(u.complaints){const{response:l}=u.complaints;l&&"successful"===l.responseInfo.status&&t.push(e.match.path+"/response/:"+n)}},[u.complaints,e.history]);const p=l.useCallback(function(l){try{return Promise.resolve(s(O(l))).then(function(){t.push(e.match.path+"/response/"+n)})}catch(e){return Promise.reject(e)}},[s]);return a.createElement(a.Fragment,null,a.createElement(i.Card,null,a.createElement(i.CardHeader,null,m("CS_ADDCOMPLAINT_PROVIDE_ADDITIONAL_DETAILS")),a.createElement(i.CardText,null,m("CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_TEXT")),a.createElement(i.TextArea,{name:"AdditionalDetails",onChange:function(e){let t=Digit.SessionStorage.get("reopen."+n);Digit.SessionStorage.set("reopen."+n,{...t,addtionalDetail:e.target.value})}}),a.createElement("div",{onClick:function(){let t=Digit.SessionStorage.get("reopen."+n);return d&&(d.workflow=((e,t)=>({action:"REOPEN",comments:e.addtionalDetail,assignes:[],verificationDocuments:e.verificationDocuments}))(t),d.service.additionalDetail={REOPEN_REASON:t.reason},p({service:d.service,workflow:d.workflow})),a.createElement(o.Redirect,{to:{pathname:e.parentRoute+"/response",state:{complaintDetails:d}}})}},a.createElement(i.SubmitBar,{label:m("CS_HEADER_REOPEN_COMPLAINT")}))))},T=e=>{let{action:t}=e;const{t:n}=r.useTranslation();switch(t){case"REOPEN":return n("CS_COMMON_COMPLAINT_REOPENED");case"RATE":return n("CS_COMMON_THANK_YOU");default:return n("CS_COMMON_COMPLAINT_SUBMITTED")}},g=e=>{let{response:t}=e;const{complaints:n}=t,{t:l}=r.useTranslation();return a.createElement(i.Banner,n&&n.response&&n.response.responseInfo?{message:T(n.response.ServiceWrappers[0].workflow),complaintNumber:n.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:l("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},N=e=>{let{response:t}=e;const{complaints:n}=t,{t:l}=r.useTranslation();if(n&&n.response&&n.response.responseInfo){const{action:e}=n.response.ServiceWrappers[0].workflow;return a.createElement(i.CardText,null,l("RATE"===e?"CS_COMMON_RATING_SUBMIT_TEXT":"CS_COMMON_TRACK_COMPLAINT_TEXT"))}},y=e=>{var t;const{t:n}=r.useTranslation(),l=c.useSelector(e=>e).pgr;return a.createElement(i.Card,null,l.complaints.response&&a.createElement(g,{response:l}),l.complaints.response&&a.createElement(N,{response:l}),a.createElement(o.Link,{to:"/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/citizen"},a.createElement(i.SubmitBar,{label:n("CORE_COMMON_GO_TO_HOME")})))},h=e=>{var t;let{match:n,parentRoute:l}=e;const r=window.location.pathname.split("/"),i=r[r.length-1],s=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId(),c=Digit.Hooks.pgr.useComplaintDetails({tenantId:s,id:i}).complaintDetails;return a.createElement(o.Switch,null,a.createElement(o.Route,{exact:!0,path:C(n,"/:id"),component:()=>a.createElement(S,{match:n,complaintDetails:c})}),a.createElement(o.Route,{path:C(n,"/upload-photo/:id"),component:()=>a.createElement(_,{match:n,skip:!0,complaintDetails:c})}),a.createElement(o.Route,{path:C(n,"/addional-details/:id"),component:()=>a.createElement(v,{match:n,parentRoute:l,complaintDetails:c})}),a.createElement(o.Route,{path:C(n,"/response"),component:()=>a.createElement(y,{match:n})}))},M=e=>{let{action:t}=e;const{t:n}=r.useTranslation();switch(t){case"REOPEN":return n("CS_COMMON_COMPLAINT_REOPENED");case"RATE":return n("CS_COMMON_THANK_YOU");default:return n("CS_COMMON_COMPLAINT_SUBMITTED")}},I=e=>{let{response:n}=e;const{complaints:l}=n;return a.createElement(i.Banner,l&&l.response&&l.response.responseInfo?{message:M(l.response.ServiceWrappers[0].workflow),complaintNumber:l.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:t("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},A=e=>{var t;const{t:n}=r.useTranslation(),l=c.useSelector(e=>e).pgr;return a.createElement(i.Card,null,l.complaints.response&&a.createElement(I,{response:l}),a.createElement(i.CardText,null,n("CS_COMMON_TRACK_COMPLAINT_TEXT")),a.createElement(o.Link,{to:"/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/citizen"},a.createElement(i.SubmitBar,{label:n("CORE_COMMON_GO_TO_HOME")})))};function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e}).apply(this,arguments)}const D={routes:{"complaint-type":{component:e=>{let{t:t,config:n,onSelect:o,value:r}=e;const[s,c]=l.useState(()=>{const{complaintType:e}=r;return e||{}}),u=n.texts,m=Digit.Hooks.pgr.useComplaintTypes({stateCode:Digit.ULBService.getCurrentTenantId()});return a.createElement(i.TypeSelectCard,P({},u,{menu:m,optionsKey:"name",selected:function(e){c(e)},selectedOption:s,onSave:()=>{o({complaintType:s})},t:t,disabled:0===Object.keys(s).length||null===s}))},texts:{headerCaption:"",header:"CS_ADDCOMPLAINT_COMPLAINT_TYPE_PLACEHOLDER",cardText:"CS_COMPLAINT_TYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"sub-type"},"sub-type":{component:e=>{let{t:t,config:n,onSelect:o,value:r}=e;const[s,c]=l.useState(()=>{const{subType:e}=r;return e||{}}),{complaintType:u}=r,m=Digit.Hooks.pgr.useComplaintSubType(u,t),d={...n.texts,headerCaption:t("SERVICEDEFS."+u.key.toUpperCase()),menu:m,optionsKey:"name",selected:function(e){c(e)},selectedOption:s,onSave:()=>{o({subType:s})}};return a.createElement(i.TypeSelectCard,P({},d,{disabled:0===Object.keys(s).length||null===s,t:t}))},texts:{header:"CS_ADDCOMPLAINT_COMPLAINT_SUBTYPE_PLACEHOLDER",cardText:"CS_COMPLAINT_SUBTYPE_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"map"},map:{component:e=>{let{onSelect:t,t:n}=e,l="";return a.createElement(i.LocationSearchCard,{header:n("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_HEADER"),cardText:n("CS_ADDCOMPLAINT_SELECT_GEOLOCATION_TEXT"),nextText:n("CS_COMMON_NEXT"),skipAndContinueText:n("CS_COMMON_SKIP"),skip:()=>t(),onSave:()=>t({pincode:l}),onChange:e=>l=e})},nextStep:"pincode"},pincode:{component:e=>{let{t:t,config:n,onSelect:o,value:r}=e;const s=Digit.Hooks.pgr.useTenants(),[c,u]=l.useState(()=>{const{pincode:e}=r;return e});let m=!c;const[d,p]=l.useState(null);return a.createElement(i.FormStep,{t:t,config:n,onSelect:function(e){try{var t=s.find(t=>{var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(t=>t==(null==e?void 0:e.pincode))});const n=function(){if(t)return Digit.SessionStorage.set("city_complaint",t),Promise.resolve(Digit.LocationService.getLocalities(t.code)).then(function(n){Digit.LocalityService.get(n.TenantBoundary[0]).filter(t=>{var n;return null===(n=t.pincode)||void 0===n?void 0:n.find(t=>t==e.pincode)}),o({...e,city_complaint:t})});Digit.SessionStorage.set("city_complaint",void 0),Digit.SessionStorage.set("selected_localities",void 0),p("CS_COMMON_PINCODE_NOT_SERVICABLE")}();return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},value:c,onChange:function(e){u(e.target.value),m=!e.target.value,p(null)},onSkip:()=>o(),forcedError:t(d),isDisabled:m})},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_FILE_APPLICATION_PINCODE_LABEL",cardText:"CS_ADDCOMPLAINT_CHANGE_PINCODE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},inputs:[{label:"CORE_COMMON_PINCODE",type:"text",name:"pincode",validation:{minLength:6,maxLength:7},error:"CORE_COMMON_PINCODE_INVALID"}],nextStep:"address"},address:{component:e=>{let{t:t,config:n,onSelect:o,value:r}=e;const s=Digit.Hooks.pgr.useTenants(),c=null!=r&&r.pincode?s.filter(e=>{var t;return null==e||null===(t=e.pincode)||void 0===t?void 0:t.some(e=>e==r.pincode)}):s,[u,m]=l.useState(()=>{const{city_complaint:e}=r;return e||null}),{data:d}=Digit.Hooks.useBoundaryLocalities(null==u?void 0:u.code,"admin",{enabled:!!u},t),[p,E]=l.useState(null),[C,S]=l.useState(()=>{const{locality_complaint:e}=r;return e||null});function _(e){S(null),E(null),m(e)}function f(e){S(e)}return l.useEffect(()=>{if(u&&d){const{pincode:e}=r;let t=e?d.filter(t=>t.pincode==e):d;E(t)}},[u,d]),a.createElement(i.FormStep,{config:n,onSelect:function(){o({city_complaint:u,locality_complaint:C})},t:t,isDisabled:!C},a.createElement("div",null,a.createElement(i.CardLabel,null,t("MYCITY_CODE_LABEL")),(null==c?void 0:c.length)<5?a.createElement(i.RadioButtons,{selectedOption:u,options:c,optionsKey:"i18nKey",onSelect:_}):a.createElement(i.Dropdown,{isMandatory:!0,selected:u,option:c,select:_,optionKey:"i18nKey",t:t}),u&&p&&a.createElement(i.CardLabel,null,t("CS_CREATECOMPLAINT_MOHALLA")),u&&p&&a.createElement(a.Fragment,null,(null==p?void 0:p.length)<5?a.createElement(i.RadioButtons,{selectedOption:C,options:p,optionsKey:"i18nkey",onSelect:f}):a.createElement(i.Dropdown,{isMandatory:!0,selected:C,optionKey:"i18nkey",option:p,select:f,t:t}))))},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_ADDCOMPLAINT_PROVIDE_COMPLAINT_ADDRESS",cardText:"CS_ADDCOMPLAINT_CITY_MOHALLA_TEXT",submitBarLabel:"CS_COMMON_NEXT"},nextStep:"landmark"},landmark:{component:e=>{let{t:t,config:n,onSelect:o,value:r}=e;const[s,c]=l.useState(()=>{const{landmark:e}=r;return e||""});return a.createElement(i.FormStep,{config:n,value:s,onChange:function(e){c(e.target.value)},onSelect:e=>o(e),onSkip:()=>o(),t:t})},texts:{headerCaption:"CS_ADDCOMPLAINT_COMPLAINT_LOCATION",header:"CS_FILE_APPLICATION_PROPERTY_LOCATION_PROVIDE_LANDMARK_TITLE",cardText:"CS_FILE_APPLICATION_PROPERTY_LOCATION_PROVIDE_LANDMARK_TITLE_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},inputs:[{label:"CS_ADDCOMPLAINT_LANDMARK",type:"textarea",name:"landmark"}],nextStep:"upload-photos"},"upload-photos":{component:e=>{var t;let{t:n,config:o,onSelect:r,onSkip:s,value:c}=e;const[u,m]=l.useState(()=>{const{uploadedImages:e}=c;return e||null});return a.createElement(i.FormStep,{config:o,onSelect:()=>{if(!u||0===u.length)return s();r({uploadedImages:u})},onSkip:s,t:n},a.createElement(i.ImageUploadHandler,{tenantId:null===(t=c.city_complaint)||void 0===t?void 0:t.code,uploadedImages:u,onPhotoChange:e=>{m(e)}}))},texts:{header:"CS_ADDCOMPLAINT_UPLOAD_PHOTO",cardText:"CS_ADDCOMPLAINT_UPLOAD_PHOTO_TEXT",submitBarLabel:"CS_COMMON_NEXT",skipText:"CORE_COMMON_SKIP_CONTINUE"},nextStep:"additional-details"},"additional-details":{component:e=>{let{t:t,config:n,onSelect:o,value:r}=e;const[s,c]=l.useState(()=>{const{details:e}=r;return e||""});return a.createElement(i.FormStep,{config:n,onChange:e=>{const{value:t}=e.target;c(t)},onSelect:()=>o({details:s}),value:s,t:t})},texts:{header:"CS_ADDCOMPLAINT_PROVIDE_ADDITIONAL_DETAILS",cardText:"CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_TEXT",submitBarLabel:"CS_COMMON_NEXT"},inputs:[{label:"CS_ADDCOMPLAINT_ADDITIONAL_DETAILS",type:"textarea",name:"details"}],nextStep:null}},indexRoute:"complaint-type"},L=e=>{let{data:t,path:n}=e,{serviceCode:l,serviceRequestId:s,applicationStatus:c}=t;const u=o.useHistory(),{t:m}=r.useTranslation(),d=["RESOLVED","REJECTED","CLOSEDAFTERREJECTION","CLOSEDAFTERRESOLUTION"];return a.createElement(a.Fragment,null,a.createElement(i.Card,{onClick:()=>{u.push(n+"/"+s)}},a.createElement(i.CardSubHeader,null,m("SERVICEDEFS."+l.toUpperCase())),a.createElement(i.DateWrap,{date:Digit.DateUtils.ConvertTimestampToDate(t.auditDetails.createdTime)}),a.createElement(i.KeyNote,{keyValue:m("CS_COMMON_COMPLAINT_NO"),note:s}),a.createElement("div",{className:"status-highlight "+(d.includes(c)?"success":"")},a.createElement("p",null,(d.includes(c)?m("CS_COMMON_CLOSED"):m("CS_COMMON_OPEN")).toUpperCase())),m("CS_COMMON_"+c)))};"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));const b=e=>{let{name:t,isCompleted:n,mobile:l,text:o,customChild:s}=e,{t:c}=r.useTranslation();return a.createElement(i.CheckPoint,{label:c("CS_COMMON_PENDINGATLME"),isCompleted:n,customChild:a.createElement("div",null,t&&l?a.createElement(i.TelePhone,{mobile:l,text:o+" "+t}):null,s)})},R=e=>{let{isCompleted:t,text:n,customChild:l}=e;return a.createElement(i.CheckPoint,{isCompleted:t,label:n,customChild:l})},k=e=>{let{text:t,rating:n}=e;return a.createElement(i.Rating,{text:t,withText:!0,currentRating:n,maxRating:5,onFeedback:()=>{}})},x=e=>{let{action:t,nextActions:n,complaintDetails:l,ComplainMaxIdleTime:s=36e5,serviceRequestId:c,reopenDate:u,isCompleted:m,customChild:d}=e;const{t:p}=r.useTranslation();if("RESOLVE"===t){let e=n&&n.map((e,t)=>{if(e&&"COMMENT"!==e)return a.createElement(o.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+c},a.createElement(i.ActionLinks,null,p("CS_COMMON_"+e)))});return a.createElement(i.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_RESOLVED"),customChild:a.createElement("div",null,e,d)})}if("RATE"===t)return a.createElement(i.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_RESOLVED"),customChild:a.createElement("div",null,d)});if("REOPEN"===t)return a.createElement(i.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_REOPENED"),info:u,customChild:d});{let e=n&&n.map((e,t)=>{var n,r;if(e&&"COMMENT"!==e&&("REOPEN"!==e||"REOPEN"===e&&(null===Date||void 0===Date?void 0:Date.now())-(null==l||null===(n=l.service)||void 0===n||null===(r=n.auditDetails)||void 0===r?void 0:r.lastModifiedTime)<s))return a.createElement(o.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+c},a.createElement(i.ActionLinks,null,p("CS_COMMON_"+e)))});return a.createElement(i.CheckPoint,{isCompleted:m,label:p("CS_COMMON_COMPLAINT_RESOLVED"),customChild:a.createElement("div",null,e,d)})}},w=e=>{let{action:t,nextActions:n,complaintDetails:l,ComplainMaxIdleTime:s=36e5,rating:c,serviceRequestId:u,reopenDate:m,isCompleted:d}=e;const{t:p}=r.useTranslation();if("REJECTED"===t){let e=n&&n.map((e,t)=>{if(e&&"COMMENT"!==e)return a.createElement(o.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+u},a.createElement(i.ActionLinks,null,p("CS_COMMON_"+e)))});return a.createElement(i.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REJECTED"),customChild:a.createElement("div",null,e)})}if("RATE"===t&&c)return a.createElement(i.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REJECTED"),customChild:a.createElement("div",null,c?a.createElement(k,{text:p("CS_ADDCOMPLAINT_YOU_RATED"),rating:c}):null,customChild)});if("REOPEN"===t)return a.createElement(i.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REOPENED"),info:m});{let e=n&&n.map((e,t)=>{var n,r;if(e&&"COMMENT"!==e&&("REOPEN"!==e||"REOPEN"===e&&(null===Date||void 0===Date?void 0:Date.now())-(null==l||null===(n=l.service)||void 0===n||null===(r=n.auditDetails)||void 0===r?void 0:r.lastModifiedTime)<s))return a.createElement(o.Link,{key:t,to:"/digit-ui/citizen/pgr/"+e.toLowerCase()+"/"+u},a.createElement(i.ActionLinks,null,p("CS_COMMON_"+e)))});return a.createElement(i.CheckPoint,{isCompleted:d,label:p("CS_COMMON_COMPLAINT_REJECTED"),customChild:a.createElement("div",null,e)})}},F=e=>{let{data:t}=e;const{t:n}=r.useTranslation();return a.createElement("div",null,(null==t?void 0:t.date)&&a.createElement("p",null,null==t?void 0:t.date),a.createElement("p",null,null==t?void 0:t.name),a.createElement("p",null,null==t?void 0:t.mobileNumber),(null==t?void 0:t.source)&&a.createElement("p",null,n("ES_COMMON_FILED_VIA_"+(null==t?void 0:t.source.toUpperCase()))))},H=e=>{let{data:t,serviceRequestId:n,complaintWorkflow:o,rating:s,zoomImage:c,complaintDetails:u,ComplainMaxIdleTime:m}=e;const{t:d}=r.useTranslation();let{timeline:p}=t;const E=l.useMemo(()=>null==p?void 0:p.length,[p]);l.useEffect(()=>{null==p||p.filter((e,t,n)=>t===n.length-1&&"PENDINGFORASSIGNMENT"===e.status);const e=(null==p?void 0:p.filter(e=>"PENDINGFORASSIGNMENT"===(null==e?void 0:e.status))).at(-1);null==p||p.push({...e,performedAction:"FILED",status:"COMPLAINT_FILED"})},[p]);const C=e=>{var t;let{comment:n,thumbnailsToShow:o,auditDetails:r,assigner:s,status:m}=e;const p={date:null==r?void 0:r.lastModified,name:null==s?void 0:s.name,mobileNumber:null==s?void 0:s.mobileNumber,source:"COMPLAINT_FILED"==m?null==u?void 0:u.audit.source:""};return a.createElement(l.Fragment,null,n?a.createElement("div",null,null==n?void 0:n.map(e=>a.createElement("div",{className:"TLComments"},a.createElement("h3",null,d("WF_COMMON_COMMENTS")),a.createElement("p",null,e)))):null,(null==o||null===(t=o.thumbs)||void 0===t?void 0:t.length)>0?a.createElement("div",{className:"TLComments"},a.createElement("h3",null,d("CS_COMMON_ATTACHMENTS")),a.createElement(i.DisplayPhotos,{srcs:o.thumbs,onClick:(e,t)=>{!function(e,t,n){var l,a;let o=null===(l=n.thumbs)||void 0===l?void 0:l.findIndex(t=>t===e);c(o>-1&&(null==n||null===(a=n.fullImage)||void 0===a?void 0:a[o])||e)}(e,0,o)}})):null,null!=p&&p.date?a.createElement(F,{data:p,comments:n}):null)};return a.createElement(a.Fragment,null,a.createElement(i.CardSubHeader,null,d("CS_COMPLAINT_DETAILS_COMPLAINT_TIMELINE")),p&&E>0?a.createElement(i.ConnectingCheckPoints,null,p.map((e,t,l)=>{let{status:r,caption:c,auditDetails:p,timeLineActions:S,performedAction:_,wfComment:f,thumbnailsToShow:O,assigner:v}=e;return(e=>{let{status:t,caption:l,auditDetails:r,timeLineActions:c,index:p,comment:E,thumbnailsToShow:S,assigner:_,totalTimelineLength:f}=e;const O=0===p;switch(t){case"PENDINGFORREASSIGNMENT":return a.createElement(i.CheckPoint,{isCompleted:O,key:p,label:d("CS_COMMON_"+t),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_})});case"PENDINGFORASSIGNMENT":const e=f-(p+1)==0;return a.createElement(R,{key:p,isCompleted:O,text:d("CS_COMMON_"+t),customChild:C({comment:E,...e?{auditDetails:r}:{thumbnailsToShow:S,auditDetails:r}})});case"PENDINGFORASSIGNMENT_AFTERREOPEN":return a.createElement(R,{isCompleted:O,key:p,text:d("CS_COMMON_"+t),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_})});case"PENDINGATLME":let{name:v,mobileNumber:T}=l&&l.length>0?l[0]:{name:"",mobileNumber:""};const g=""+d("CS_COMMON_"+t);return a.createElement(b,{isCompleted:O,key:p,name:v,mobile:T,text:g,customChild:C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_})});case"RESOLVED":return a.createElement(x,{key:p,isCompleted:O,action:o.action,nextActions:p<=1&&c,complaintDetails:u,ComplainMaxIdleTime:m,serviceRequestId:n,reopenDate:Digit.DateUtils.ConvertTimestampToDate(r.lastModifiedTime),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_})});case"REJECTED":return a.createElement(w,{key:p,isCompleted:O,action:o.action,nextActions:p<=1&&c,complaintDetails:u,ComplainMaxIdleTime:m,serviceRequestId:n,reopenDate:Digit.DateUtils.ConvertTimestampToDate(r.lastModifiedTime),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_})});case"CLOSEDAFTERRESOLUTION":return a.createElement(i.CheckPoint,{isCompleted:O,key:p,label:d("CS_COMMON_CS_COMMON_"+t),customChild:a.createElement("div",null,C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_}),s?a.createElement(k,{text:d("CS_ADDCOMPLAINT_YOU_RATED"),rating:s}):null)});case"COMPLAINT_FILED":return a.createElement(i.CheckPoint,{isCompleted:O,key:p,label:d("CS_COMMON_COMPLAINT_FILED"),customChild:C({comment:E,auditDetails:r,assigner:_,status:t})});default:return a.createElement(i.CheckPoint,{isCompleted:O,key:p,label:d("CS_COMMON_"+t),customChild:C({comment:E,thumbnailsToShow:S,auditDetails:r,assigner:_,status:t})})}})({status:r,caption:c,auditDetails:p,timeLineActions:S,index:t,array:l,performedAction:_,comment:f,thumbnailsToShow:O,assigner:v,totalTimelineLength:E})})):a.createElement(i.Loader,null))},U=e=>{var t;let{complaintDetails:n,id:o,getWorkFlow:r,zoomImage:i}=e;const s=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||n.service.tenantId;let c=Digit.Hooks.useWorkflowDetails({tenantId:s,id:o,moduleCode:"PGR"});const{data:u}=Digit.Hooks.pgr.useMDMS.ComplainClosingTime(null==s?void 0:s.split(".")[0]);return l.useEffect(()=>{r(c.data)},[c.data]),l.useEffect(()=>{c.revalidate()},[]),!c.isLoading&&a.createElement(H,{data:c.data,serviceRequestId:o,complaintWorkflow:n.workflow,rating:n.audit.rating,zoomImage:i,complaintDetails:n,ComplainMaxIdleTime:u})},B=()=>{var e,t,n,l,s,c,u,m,d,p;const{t:E}=r.useTranslation(),{path:C,url:S,..._}=o.useRouteMatch(),f=o.useLocation(),O=null===(e=Digit)||void 0===e||null===(t=e.ComponentRegistryService)||void 0===t?void 0:t.getComponent("PGRCreateComplaintCitizen"),v=null===(n=Digit)||void 0===n||null===(l=n.ComponentRegistryService)||void 0===l?void 0:l.getComponent("PGRComplaintsList"),T=null===(s=Digit)||void 0===s||null===(c=s.ComponentRegistryService)||void 0===c?void 0:c.getComponent("PGRComplaintDetailsPage"),g=null===(u=Digit)||void 0===u||null===(m=u.ComponentRegistryService)||void 0===m?void 0:m.getComponent("PGRSelectRating"),N=null===(d=Digit)||void 0===d||null===(p=d.ComponentRegistryService)||void 0===p?void 0:p.getComponent("PGRResponseCitzen");return a.createElement(a.Fragment,null,a.createElement("div",{className:"pgr-citizen-wrapper"},!f.pathname.includes("/response")&&a.createElement(i.BackButton,null,E("CS_COMMON_BACK")),a.createElement(o.Switch,null,a.createElement(i.PrivateRoute,{path:C+"/create-complaint",component:O}),a.createElement(i.PrivateRoute,{path:C+"/complaints",exact:!0,component:v}),a.createElement(i.PrivateRoute,{path:C+"/complaints/:id*",component:T}),a.createElement(i.PrivateRoute,{path:C+"/reopen",component:()=>a.createElement(h,{match:{..._,url:S,path:C+"/reopen"},parentRoute:C})}),a.createElement(i.PrivateRoute,{path:C+"/rate/:id*",component:()=>a.createElement(g,{parentRoute:C})}),a.createElement(i.PrivateRoute,{path:C+"/response",component:()=>a.createElement(N,{match:{..._,url:S,path:C}})}))))},G=()=>{var e,t,n,s,c,u,m,d;const[p,C]=l.useState(!1),[S,_]=l.useState(!1),f=o.useRouteMatch(),{t:O}=r.useTranslation(),v={home:{content:O("CS_COMMON_HOME"),path:E.Home},inbox:{content:O("CS_COMMON_INBOX"),path:f.url+E.Inbox},createComplaint:{content:O("CS_PGR_CREATE_COMPLAINT"),path:f.url+E.CreateComplaint},complaintDetails:{content:O("CS_PGR_COMPLAINT_DETAILS"),path:f.url+E.ComplaintDetails+":id"},response:{content:O("CS_PGR_RESPONSE"),path:f.url+E.Response}};let T=o.useLocation().pathname;const g=null===(e=Digit)||void 0===e||null===(t=e.ComponentRegistryService)||void 0===t?void 0:t.getComponent("PGRCreateComplaintEmp"),N=null===(n=Digit)||void 0===n||null===(s=n.ComponentRegistryService)||void 0===s?void 0:s.getComponent("PGRComplaintDetails"),y=null===(c=Digit)||void 0===c||null===(u=c.ComponentRegistryService)||void 0===u?void 0:u.getComponent("PGRInbox"),h=null===(m=Digit)||void 0===m||null===(d=m.ComponentRegistryService)||void 0===d?void 0:d.getComponent("PGRResponseEmp");return a.createElement(a.Fragment,null,a.createElement("div",{className:"ground-container"},!T.includes(E.Response)&&a.createElement(o.Switch,null,a.createElement(o.Route,{path:f.url+E.CreateComplaint,component:()=>a.createElement(i.BreadCrumb,{crumbs:[v.home,v.createComplaint]})}),a.createElement(o.Route,{path:f.url+E.ComplaintDetails+":id",component:()=>a.createElement(i.BreadCrumb,{crumbs:[v.home,v.inbox,v.complaintDetails]})}),a.createElement(o.Route,{path:f.url+E.Inbox,component:()=>a.createElement(i.BreadCrumb,{crumbs:[v.home,v.inbox]})}),a.createElement(o.Route,{path:f.url+E.Response,component:a.createElement(i.BreadCrumb,{crumbs:[v.home,v.response]})})),a.createElement(o.Switch,null,a.createElement(o.Route,{path:f.url+E.CreateComplaint,component:()=>a.createElement(g,{parentUrl:f.url})}),a.createElement(o.Route,{path:f.url+E.ComplaintDetails+":id*",component:()=>a.createElement(N,null)}),a.createElement(o.Route,{path:f.url+E.Inbox,component:y}),a.createElement(o.Route,{path:f.url+E.Response,component:h}))))},j=()=>a.createElement(i.EmployeeAppContainer,null,a.createElement(G,null)),$=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"#FFFFFF"},a.createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),a.createElement("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"})),V=e=>a.createElement("h1",{className:"heading-m"},e.label),W=e=>a.createElement("div",{className:"icon-bg-secondary",onClick:e.onClick},a.createElement($,null)),z=e=>{let{data:t,comments:n}=e;const{t:l}=r.useTranslation();return a.createElement("div",null,(null==t?void 0:t.date)&&a.createElement("p",null,null==t?void 0:t.date),a.createElement("p",null,null==t?void 0:t.name),a.createElement("p",null,null==t?void 0:t.mobileNumber),(null==t?void 0:t.source)&&a.createElement("p",null,l("ES_COMMON_FILED_VIA_"+(null==t?void 0:t.source.toUpperCase()))),null==n?void 0:n.map(e=>a.createElement("div",{className:"TLComments"},a.createElement("h3",null,l("WF_COMMON_COMMENTS")),a.createElement("p",null,e))))},Y=e=>{var t,n,o,r,s,c,u;let{workflowDetails:m,complaintDetails:d,close:p,popup:E,selectedAction:C,onAssign:S,tenantId:_,t:f}=e;const O=null==m||null===(t=m.data)||void 0===t||null===(n=t.initialActionState)||void 0===n||null===(o=n.nextActions)||void 0===o?void 0:o.filter(e=>(null==e?void 0:e.action)==C),v=Digit.Hooks.pgr.useEmployeeFilter(_,(null==O||null===(r=O[0])||void 0===r||null===(s=r.assigneeRoles)||void 0===s?void 0:s.length)>0?null==O||null===(c=O[0])||void 0===c||null===(u=c.assigneeRoles)||void 0===u?void 0:u.join(","):"",d),T=v?v.map(e=>({heading:e.department,options:e.employees})):null,[g,N]=l.useState(null),[y,h]=l.useState(""),[M,I]=l.useState(null),[A,P]=l.useState(null),[D,L]=l.useState(null),b=Digit.ULBService.getCurrentUlb(),[R,k]=l.useState(null);l.useEffect(()=>{!function(){try{L(null);const e=function(){if(M){const e=function(){if(M.size>=5242880)L(f("CS_MAXIMUM_UPLOAD_SIZE_EXCEEDED"));else{const e=function(e,t){try{var n=Promise.resolve(Digit.UploadServices.Filestorage("property-upload",M,b.code)).then(function(e){var t,n,l,a;(null==e||null===(t=e.data)||void 0===t||null===(n=t.files)||void 0===n?void 0:n.length)>0?P(null==e||null===(l=e.data)||void 0===l||null===(a=l.files[0])||void 0===a?void 0:a.fileStoreId):L(f("CS_FILE_UPLOAD_ERROR"))})}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(0,function(){L(f("CS_FILE_UPLOAD_ERROR"))});if(e&&e.then)return e.then(function(){})}}();if(e&&e.then)return e.then(function(){})}}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[M]);const x=[f("CS_REOPEN_OPTION_ONE"),f("CS_REOPEN_OPTION_TWO"),f("CS_REOPEN_OPTION_THREE"),f("CS_REOPEN_OPTION_FOUR")];return a.createElement(i.Modal,{headerBarMain:a.createElement(V,{label:f("ASSIGN"===C||"REASSIGN"===C?"CS_ACTION_ASSIGN":"REJECT"===C?"CS_ACTION_REJECT":"REOPEN"===C?"CS_COMMON_REOPEN":"CS_COMMON_RESOLVE")}),headerBarEnd:a.createElement(W,{onClick:()=>p(E)}),actionCancelLabel:f("CS_COMMON_CANCEL"),actionCancelOnSubmit:()=>p(E),actionSaveLabel:f("ASSIGN"===C||"REASSIGN"===C?"CS_COMMON_ASSIGN":"REJECT"===C?"CS_COMMON_REJECT":"REOPEN"===C?"CS_COMMON_REOPEN":"CS_COMMON_RESOLVE"),actionSaveOnSubmit:()=>{"REJECT"!==C||y?S(g,y,A):L(f("CS_MANDATORY_COMMENTS"))},error:D,setError:L},a.createElement(i.Card,null,"REJECT"===C||"RESOLVE"===C||"REOPEN"===C?null:a.createElement(a.Fragment,null,a.createElement(i.CardLabel,null,f("CS_COMMON_EMPLOYEE_NAME")),T&&a.createElement(i.SectionalDropdown,{selected:g,menuData:T,displayKey:"name",select:function(e){N(e)}})),"REOPEN"===C?a.createElement(a.Fragment,null,a.createElement(i.CardLabel,null,f("CS_REOPEN_COMPLAINT")),a.createElement(i.Dropdown,{selected:R,option:x,select:function(e){k(e)}})):null,a.createElement(i.CardLabel,null,f("CS_COMMON_EMPLOYEE_COMMENTS")),a.createElement(i.TextArea,{name:"comment",onChange:function(e){L(null),h(e.target.value)},value:y}),a.createElement(i.CardLabel,null,f("CS_ACTION_SUPPORTING_DOCUMENTS")),a.createElement(i.CardLabelDesc,null,f("CS_UPLOAD_RESTRICTIONS")),a.createElement(i.UploadFile,{id:"pgr-doc",accept:".jpg",onUpload:function(e){I(e.target.files[0])},onDelete:()=>{P(null)},message:A?"1 "+f("CS_ACTION_FILEUPLOADED"):f("CS_ACTION_NO_FILEUPLOADED")})))},K=e=>{const{register:t,handleSubmit:n,errors:o}=m.useForm(),{t:s}=r.useTranslation(),c=l.useMemo(()=>{var n;return null===(n=e.config)||void 0===n?void 0:n.map((e,n,l)=>a.createElement(a.Fragment,{key:n},a.createElement(i.CardSectionHeader,null,e.head),e.body.map((e,n)=>{var l;return a.createElement(a.Fragment,{key:n},o[e.populators.name]&&(null===(l=e.populators)||void 0===l||!l.validate||o[e.populators.validate])&&a.createElement(i.CardLabelError,null,e.populators.error),a.createElement(i.LabelFieldPair,null,a.createElement(i.CardLabel,null,e.label,e.isMandatory?" * ":null),a.createElement("div",{className:"field"},((e,n)=>{switch(e){case"text":return a.createElement("div",{className:"field-container"},n.componentInFront?n.componentInFront:null,a.createElement(i.TextInput,P({className:"field desktop-w-full"},n,{inputRef:t(n.validation)})));case"textarea":return a.createElement(i.TextArea,P({className:"field desktop-w-full",name:n.name||""},n,{inputRef:t(n.validation)}));default:return!1!==n.dependency?n:null}})(e.type,e.populators))))}),l.length-1===n?null:a.createElement(i.BreakLine,null)))},[e.config,o]),u=e.isDisabled||!1;return a.createElement("form",{onSubmit:n(function(t){e.onSubmit(t)})},a.createElement(i.Card,null,a.createElement(i.CardSubHeader,null,e.heading),c,e.children,a.createElement(i.ActionBar,null,a.createElement(i.SubmitBar,{disabled:u,label:s(e.label),submit:"submit"}))))},q=e=>{var t;const{t:n}=r.useTranslation(),s=[{text:"ES_PGR_NEW_COMPLAINT",link:"/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/employee/pgr/complaint/create",accessTo:["CSR"]}],[c,u]=l.useState([]);return l.useEffect(()=>{let e=[];s.forEach(t=>{t.accessTo?Digit.UserService.hasAccess(t.accessTo)&&e.push(t):e.push(t)}),u(e)},[]),a.createElement(i.Card,{className:"employeeCard filter inboxLinks"},a.createElement("div",{className:"complaint-links-container"},a.createElement("div",{className:"header"},a.createElement("span",{className:"logo"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},a.createElement("path",{d:"M0 0h24v24H0z",fill:"white",style:{fill:"white"}}),a.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"#c84c0e"})))," ",a.createElement("span",{className:"text"},n("ES_PGR_HEADER_COMPLAINT"))),a.createElement("div",{className:"body"},c.map((e,t)=>{let{link:l,text:r}=e;return a.createElement("span",{className:"link",key:t},a.createElement(o.Link,{to:l},n(r)))}))))},X=e=>{let{t:t,columns:n,data:l,getCellProps:o,onNextPage:r,onPrevPage:s,currentPage:c,totalRecords:u,pageSizeLimit:m,onPageSizeChange:d}=e;return a.createElement(i.Table,{t:t,data:l,columns:n,getCellProps:o,onNextPage:r,onPrevPage:s,currentPage:c,totalRecords:u,onPageSizeChange:d,pageSizeLimit:m})},J=e=>{var t;let{complaints:n,onAssignmentChange:l,pgrfilters:o}=e;const{t:s}=r.useTranslation(),c=Digit.Hooks.pgr.useComplaintStatusCount(n);let u=null==o||null===(t=o.applicationStatus)||void 0===t?void 0:t.length;return a.createElement("div",{className:"status-container"},a.createElement("div",{className:"filter-label"},s("ES_PGR_FILTER_STATUS")),0===c.length&&a.createElement(i.Loader,null),c.map((e,t)=>a.createElement(i.CheckBox,{key:t,onChange:t=>l(t,e),checked:!!u&&0!==o.applicationStatus.filter(t=>t.code===e.code).length,label:e.name+" ("+(e.count||0)+")"})))};let Z={},Q={};const ee=e=>{var t,n,o,s,c,u,m;let{uuid:d}=Digit.UserService.getUser().info;const{searchParams:p}=e,{t:E}=r.useTranslation(),C=!(null==p||null===(t=p.filters)||void 0===t||null===(n=t.wfFilters)||void 0===n||!n.assignee||null==p||null===(o=p.filters)||void 0===o||null===(s=o.wfFilters)||void 0===s||null===(c=s.assignee[0])||void 0===c||!c.code),S=l.useMemo(()=>[{code:"ASSIGNED_TO_ME",name:E("ASSIGNED_TO_ME")},{code:"ASSIGNED_TO_ALL",name:E("ASSIGNED_TO_ALL")}],[E]),[_,f]=l.useState(C?S[0]:S[1]);l.useEffect(()=>f(C?S[0]:S[1]),[E]);const[O,v]=l.useState(null),[T,g]=l.useState(null),[N,y]=l.useState((null==p||null===(u=p.filters)||void 0===u?void 0:u.pgrfilters)||{serviceCode:[],locality:[],applicationStatus:[]}),[h,M]=l.useState((null==p||null===(m=p.filters)||void 0===m?void 0:m.wfFilters)||{assignee:[{code:d}]}),I=Digit.ULBService.getCurrentTenantId(),{data:A}=Digit.Hooks.useBoundaryLocalities(I,"admin",{},E);let P=Digit.Hooks.pgr.useServiceDefs(I,"PGR");l.useEffect(()=>{var t;let n=0;for(const e in N)if(Array.isArray(N[e])){n+=N[e].length;let t=N[e].map(e=>e.code).join();var l;t?Z[e]=t:null===(l=Z)||void 0===l||delete l[e]}for(const e in h)if(Array.isArray(h[e])){let t=h[e].map(e=>e.code).join();t?Q[e]=t:Q={}}n+=(null==h||null===(t=h.assignee)||void 0===t?void 0:t.length)||0,"mobile"!==e.type&&R(),Digit.inboxFilterCount=n},[N,h]);const D=(e,t)=>e.filter(e=>e.code===t.code).length;l.useEffect(()=>{v(N.serviceCode.length>1?{i18nKey:N.serviceCode.length+" selected"}:N.serviceCode[0])},[N.serviceCode]),l.useEffect(()=>{g(N.locality.length>1?{name:N.locality.length+" selected"}:N.locality[0])},[N.locality]);const L=(e,t)=>{let n=N[t].filter((t,n)=>n!==e);y({...N,[t]:n})};function b(){y({serviceCode:[],locality:[],applicationStatus:[]}),M({assigned:[{code:[]}]}),Z={},Q={},f(""),v(null),g(null)}const R=()=>{e.onFilterChange({pgrQuery:Z,wfQuery:Q,wfFilters:h,pgrfilters:N})},k=function(e,t,n,l,o,r,s){return void 0===n&&(n=null),n=n||{[o]:" ",code:""},a.createElement("div",null,a.createElement("div",{className:"filter-label"},e),a.createElement(i.Dropdown,{option:t,selected:n,select:e=>l(e,s),optionKey:o}),a.createElement("div",{className:"tag-container"},N[s].length>0&&N[s].map((e,t)=>a.createElement(i.RemoveableTag,{key:t,text:e[o].slice(0,22)+" ...",onClick:()=>r(t,s)}))))};return a.createElement(a.Fragment,null,a.createElement("div",{className:"filter"},a.createElement("div",{className:"filter-card"},a.createElement("div",{className:"heading"},a.createElement("div",{className:"filter-label"},E("ES_COMMON_FILTER_BY"),":"),a.createElement("div",{className:"clearAll",onClick:b},E("ES_COMMON_CLEAR_ALL")),"desktop"===e.type&&a.createElement("span",{className:"clear-search",onClick:b},E("ES_COMMON_CLEAR_ALL")),"mobile"===e.type&&a.createElement("span",{onClick:e.onClose},a.createElement(i.CloseSvg,null))),a.createElement("div",null,a.createElement(i.RadioButtons,{onSelect:e=>{f(e),d="ASSIGNED_TO_ME"===e.code?d:"",M({...h,assignee:[{code:d}]})},selectedOption:_,optionsKey:"name",options:S}),a.createElement("div",null,k(E("CS_COMPLAINT_DETAILS_COMPLAINT_SUBTYPE"),P,O,function(e){const t={i18nKey:E("SERVICEDEFS."+e.serviceCode.toUpperCase()),code:e.serviceCode};D(N.serviceCode,t)||y({...N,serviceCode:[...N.serviceCode,t]})},"i18nKey",L,"serviceCode")),a.createElement("div",null,k(E("CS_PGR_LOCALITY"),A,T,function(e,t){D(N.locality,e)||y({...N,locality:[...N.locality,e]})},"i18nkey",L,"locality")),a.createElement(J,{complaints:e.complaints,onAssignmentChange:(e,t)=>{if(e.target.checked)y({...N,applicationStatus:[...N.applicationStatus,{code:t.code}]});else{const e=N.applicationStatus.filter(e=>e.code!==t.code);y({...N,applicationStatus:e})}},pgrfilters:N})))),a.createElement(i.ActionBar,null,"mobile"===e.type&&a.createElement(i.ApplyFilterBar,{labelLink:E("ES_COMMON_CLEAR_ALL"),buttonLink:E("ES_COMMON_FILTER"),onClear:b,onSubmit:function(){R(),e.onClose()}})))},te=e=>{var t,n;let{onSearch:o,type:s,onClose:c,searchParams:u}=e;const[d,p]=l.useState((null==u||null===(t=u.search)||void 0===t?void 0:t.serviceRequestId)||""),[E,C]=l.useState((null==u||null===(n=u.search)||void 0===n?void 0:n.mobileNumber)||""),{register:S,errors:_,handleSubmit:f,reset:O}=m.useForm(),{t:v}=r.useTranslation();return a.createElement("form",{onSubmit:f(e=>{Object.keys(_).filter(e=>_[e]).length||(o(""!==e.serviceRequestId?{serviceRequestId:e.serviceRequestId}:""!==e.mobileNumber?{mobileNumber:e.mobileNumber}:{}),"mobile"===s&&c())}),style:{marginLeft:"24px"}},a.createElement(a.Fragment,null,a.createElement("div",{className:"search-container",style:{width:"auto"}},a.createElement("div",{className:"search-complaint-container"},"mobile"===s&&a.createElement("div",{className:"complaint-header"},a.createElement("h2",null," ",v("CS_COMMON_SEARCH_BY"),":"),a.createElement("span",{onClick:c},a.createElement(i.CloseSvg,null))),a.createElement("div",{className:"complaint-input-container"},a.createElement("span",{className:"complaint-input"},a.createElement(i.Label,null,v("CS_COMMON_COMPLAINT_NO"),"."),a.createElement(i.TextInput,{name:"serviceRequestId",value:d,onChange:function(e){p(e.target.value)},inputRef:S({pattern:/(?!^$)([^\s])/}),style:{marginBottom:"8px"}})),a.createElement("span",{className:"mobile-input"},a.createElement(i.Label,null,v("CS_COMMON_MOBILE_NO"),"."),a.createElement(i.TextInput,{name:"mobileNumber",value:E,onChange:function(e){C(e.target.value)},inputRef:S({pattern:/^[6-9]\d{9}$/})})),"desktop"===s&&a.createElement(i.SubmitBar,{style:{marginTop:32,marginLeft:"16px",width:"calc( 100% - 16px )"},label:v("ES_COMMON_SEARCH"),submit:!0,disabled:Object.keys(_).filter(e=>_[e]).length})),"desktop"===s&&a.createElement("span",{className:"clear-search"},a.createElement(i.LinkLabel,{className:"clear-search-label",onClick:function(){O(),o({}),p(""),C("")}},v("ES_COMMON_CLEAR_SEARCH"))))),"mobile"===s&&a.createElement(i.ActionBar,null,a.createElement(i.SubmitBar,{label:"Search",submit:!0}))))},ne=e=>{let{data:t,onFilterChange:n,onSearch:l,isLoading:s,searchParams:c,onNextPage:u,onPrevPage:m,currentPage:d,pageSizeLimit:p,onPageSizeChange:E,totalRecords:C}=e;const{t:S}=r.useTranslation(),_=e=>a.createElement("span",{className:"cell-text"},e),f=a.useMemo(()=>[{Header:S("CS_COMMON_COMPLAINT_NO"),Cell:e=>{var t;let{row:n}=e;return a.createElement("div",null,a.createElement("span",{className:"link"},a.createElement(o.Link,{to:"/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/employee/pgr/complaint/details/"+n.original.serviceRequestId},n.original.serviceRequestId)),a.createElement("br",null),a.createElement("span",{className:"complain-no-cell-text"},S("SERVICEDEFS."+n.original.complaintSubType.toUpperCase())))}},{Header:S("WF_INBOX_HEADER_LOCALITY"),Cell:e=>{let{row:t}=e;return _(S(Digit.Utils.locale.getLocalityCode(t.original.locality,t.original.tenantId)))}},{Header:S("CS_COMPLAINT_DETAILS_CURRENT_STATUS"),Cell:e=>{let{row:t}=e;return _(S("CS_COMMON_"+t.original.status))}},{Header:S("WF_INBOX_HEADER_CURRENT_OWNER"),Cell:e=>{let{row:t}=e;return _(t.original.taskOwner)}},{Header:S("WF_INBOX_HEADER_SLA_DAYS_REMAINING"),Cell:e=>{let{row:t}=e;return a.createElement("span",(n=t.original.sla)<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},n||"");var n}}],[S]);let O;return O=s?a.createElement(i.Loader,null):t&&0===(null==t?void 0:t.length)?a.createElement(i.Card,{style:{marginTop:20}},S("CS_MYCOMPLAINTS_NO_COMPLAINTS_EMPLOYEE").split("\\n").map((e,t)=>a.createElement("p",{key:t,style:{textAlign:"center"}},e))):(null==t?void 0:t.length)>0?a.createElement(X,{t:S,data:t,columns:f,getCellProps:e=>({style:{minWidth:e.column.Header===S("CS_COMMON_COMPLAINT_NO")?"240px":"",padding:"20px 18px",fontSize:"16px"}}),onNextPage:u,onPrevPage:m,totalRecords:C,onPageSizeChagne:E,currentPage:d,pageSizeLimit:p}):a.createElement(i.Card,{style:{marginTop:20}},S("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map((e,t)=>a.createElement("p",{key:t,style:{textAlign:"center"}},e))),a.createElement("div",{className:"inbox-container"},a.createElement("div",{className:"filters-container"},a.createElement(q,null),a.createElement("div",null,a.createElement(ee,{complaints:t,onFilterChange:n,type:"desktop",searchParams:c}))),a.createElement("div",{style:{flex:1}},a.createElement(te,{onSearch:l,type:"desktop"}),a.createElement("div",{style:{marginTop:"24px",marginLeft:"24px",flex:1}},O)))},le=e=>{let{data:t,onFilterChange:n,onSearch:o,serviceRequestIdKey:s,searchParams:c}=e;const{t:u}=r.useTranslation(),[m,d]=l.useState(!1),[p,E]=l.useState(null),[C,S]=l.useState(Digit.inboxFilterCount||1),_=e=>{"SEARCH"===e?E(a.createElement(te,{type:"mobile",onClose:f,onSearch:o,searchParams:c})):"FILTER"===e&&E(a.createElement(ee,{complaints:t,onFilterChange:n,onClose:f,type:"mobile",searchParams:c})),d(!0)},f=()=>{d(!1),E(null)};let O;if(t&&0===(null==t?void 0:t.length))O=a.createElement(i.Card,{style:{marginTop:20}},u("CS_MYCOMPLAINTS_NO_COMPLAINTS_EMPLOYEE").split("\\n").map((e,t)=>a.createElement("p",{key:t,style:{textAlign:"center"}},e)));else if(t&&(null==t?void 0:t.length)>0){var v;O=a.createElement(i.DetailsCard,{data:t,serviceRequestIdKey:s,linkPrefix:"/"+(null===(v=window)||void 0===v?void 0:v.contextPath)+"/employee/pgr/complaint/details/"})}else O=a.createElement(i.Card,{style:{marginTop:20}},u("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map((e,t)=>a.createElement("p",{key:t,style:{textAlign:"center"}},e)));return a.createElement(a.Fragment,null,a.createElement("div",{className:"searchBox"},a.createElement(i.SearchAction,{text:"SEARCH",handleActionClick:()=>_("SEARCH")}),a.createElement(i.FilterAction,{filterCount:C,text:"FILTER",handleActionClick:()=>_("FILTER")})),O,m&&a.createElement(i.PopUp,null,a.createElement("div",{className:"popup-module"},p)))};function ae(e,t){return e(t={exports:{}},t.exports),t.exports}var oe="function"==typeof Symbol&&Symbol.for,re=oe?Symbol.for("react.element"):60103,ie=oe?Symbol.for("react.portal"):60106,se=oe?Symbol.for("react.fragment"):60107,ce=oe?Symbol.for("react.strict_mode"):60108,ue=oe?Symbol.for("react.profiler"):60114,me=oe?Symbol.for("react.provider"):60109,de=oe?Symbol.for("react.context"):60110,pe=oe?Symbol.for("react.async_mode"):60111,Ee=oe?Symbol.for("react.concurrent_mode"):60111,Ce=oe?Symbol.for("react.forward_ref"):60112,Se=oe?Symbol.for("react.suspense"):60113,_e=oe?Symbol.for("react.suspense_list"):60120,fe=oe?Symbol.for("react.memo"):60115,Oe=oe?Symbol.for("react.lazy"):60116,ve=oe?Symbol.for("react.block"):60121,Te=oe?Symbol.for("react.fundamental"):60117,ge=oe?Symbol.for("react.responder"):60118,Ne=oe?Symbol.for("react.scope"):60119;function ye(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case re:switch(e=e.type){case pe:case Ee:case se:case ue:case ce:case Se:return e;default:switch(e=e&&e.$$typeof){case de:case Ce:case Oe:case fe:case me:return e;default:return t}}case ie:return t}}}function he(e){return ye(e)===Ee}var Me={AsyncMode:pe,ConcurrentMode:Ee,ContextConsumer:de,ContextProvider:me,Element:re,ForwardRef:Ce,Fragment:se,Lazy:Oe,Memo:fe,Portal:ie,Profiler:ue,StrictMode:ce,Suspense:Se,isAsyncMode:function(e){return he(e)||ye(e)===pe},isConcurrentMode:he,isContextConsumer:function(e){return ye(e)===de},isContextProvider:function(e){return ye(e)===me},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===re},isForwardRef:function(e){return ye(e)===Ce},isFragment:function(e){return ye(e)===se},isLazy:function(e){return ye(e)===Oe},isMemo:function(e){return ye(e)===fe},isPortal:function(e){return ye(e)===ie},isProfiler:function(e){return ye(e)===ue},isStrictMode:function(e){return ye(e)===ce},isSuspense:function(e){return ye(e)===Se},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===se||e===Ee||e===ue||e===ce||e===Se||e===_e||"object"==typeof e&&null!==e&&(e.$$typeof===Oe||e.$$typeof===fe||e.$$typeof===me||e.$$typeof===de||e.$$typeof===Ce||e.$$typeof===Te||e.$$typeof===ge||e.$$typeof===Ne||e.$$typeof===ve)},typeOf:ye},Ie=ae(function(e,t){"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,n=e?Symbol.for("react.element"):60103,l=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,r=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,m=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,p=e?Symbol.for("react.suspense_list"):60120,E=e?Symbol.for("react.memo"):60115,C=e?Symbol.for("react.lazy"):60116,S=e?Symbol.for("react.block"):60121,_=e?Symbol.for("react.fundamental"):60117,f=e?Symbol.for("react.responder"):60118,O=e?Symbol.for("react.scope"):60119;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:var p=e.type;switch(p){case c:case u:case a:case r:case o:case d:return p;default:var S=p&&p.$$typeof;switch(S){case s:case m:case C:case E:case i:return S;default:return t}}case l:return t}}}var T=u,g=s,N=i,y=n,h=m,M=a,I=C,A=E,P=l,D=r,L=o,b=d,R=!1;function k(e){return v(e)===u}t.AsyncMode=c,t.ConcurrentMode=T,t.ContextConsumer=g,t.ContextProvider=N,t.Element=y,t.ForwardRef=h,t.Fragment=M,t.Lazy=I,t.Memo=A,t.Portal=P,t.Profiler=D,t.StrictMode=L,t.Suspense=b,t.isAsyncMode=function(e){return R||(R=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),k(e)||v(e)===c},t.isConcurrentMode=k,t.isContextConsumer=function(e){return v(e)===s},t.isContextProvider=function(e){return v(e)===i},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return v(e)===m},t.isFragment=function(e){return v(e)===a},t.isLazy=function(e){return v(e)===C},t.isMemo=function(e){return v(e)===E},t.isPortal=function(e){return v(e)===l},t.isProfiler=function(e){return v(e)===r},t.isStrictMode=function(e){return v(e)===o},t.isSuspense=function(e){return v(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===u||e===r||e===o||e===d||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===C||e.$$typeof===E||e.$$typeof===i||e.$$typeof===s||e.$$typeof===m||e.$$typeof===_||e.$$typeof===f||e.$$typeof===O||e.$$typeof===S)},t.typeOf=v}()}),Ae=ae(function(e){e.exports="production"===process.env.NODE_ENV?Me:Ie}),Pe=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;function be(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var Re=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(e){l[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},l)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,l,a=be(e),o=1;o<arguments.length;o++){for(var r in n=Object(arguments[o]))De.call(n,r)&&(a[r]=n[r]);if(Pe){l=Pe(n);for(var i=0;i<l.length;i++)Le.call(n,l[i])&&(a[l[i]]=n[l[i]])}}return a},ke="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",xe=Function.call.bind(Object.prototype.hasOwnProperty),we=function(){};if("production"!==process.env.NODE_ENV){var Fe=ke,He={},Ue=xe;we=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function Be(e,t,n,l,a){if("production"!==process.env.NODE_ENV)for(var o in e)if(Ue(e,o)){var r;try{if("function"!=typeof e[o]){var i=Error((l||"React class")+": "+n+" type `"+o+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[o]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw i.name="Invariant Violation",i}r=e[o](t,o,l,n,null,Fe)}catch(e){r=e}if(!r||r instanceof Error||we((l||"React class")+": type specification of "+n+" `"+o+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof r+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),r instanceof Error&&!(r.message in He)){He[r.message]=!0;var s=a?a():"";we("Failed "+n+" type: "+r.message+(null!=s?s:""))}}}Be.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(He={})};var Ge=Be,je=function(){};function $e(){return null}function Ve(){}function We(){}"production"!==process.env.NODE_ENV&&(je=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),We.resetWarningCache=Ve;var ze=ae(function(e){e.exports="production"!==process.env.NODE_ENV?function(e,t){var n="function"==typeof Symbol&&Symbol.iterator,l={array:i("array"),bigint:i("bigint"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),symbol:i("symbol"),any:r($e),arrayOf:function(e){return r(function(t,n,l,a,r){if("function"!=typeof e)return new o("Property `"+r+"` of component `"+l+"` has invalid PropType notation inside arrayOf.");var i=t[n];if(!Array.isArray(i))return new o("Invalid "+a+" `"+r+"` of type `"+u(i)+"` supplied to `"+l+"`, expected an array.");for(var s=0;s<i.length;s++){var c=e(i,s,l,a,r+"["+s+"]",ke);if(c instanceof Error)return c}return null})},element:r(function(t,n,l,a,r){var i=t[n];return e(i)?null:new o("Invalid "+a+" `"+r+"` of type `"+u(i)+"` supplied to `"+l+"`, expected a single ReactElement.")}),elementType:r(function(e,t,n,l,a){var r=e[t];return Ae.isValidElementType(r)?null:new o("Invalid "+l+" `"+a+"` of type `"+u(r)+"` supplied to `"+n+"`, expected a single ReactElement type.")}),instanceOf:function(e){return r(function(t,n,l,a,r){var i;return t[n]instanceof e?null:new o("Invalid "+a+" `"+r+"` of type `"+((i=t[n]).constructor&&i.constructor.name?i.constructor.name:"<<anonymous>>")+"` supplied to `"+l+"`, expected instance of `"+(e.name||"<<anonymous>>")+"`.")})},node:r(function(e,t,n,l,a){return c(e[t])?null:new o("Invalid "+l+" `"+a+"` supplied to `"+n+"`, expected a ReactNode.")}),objectOf:function(e){return r(function(t,n,l,a,r){if("function"!=typeof e)return new o("Property `"+r+"` of component `"+l+"` has invalid PropType notation inside objectOf.");var i=t[n],s=u(i);if("object"!==s)return new o("Invalid "+a+" `"+r+"` of type `"+s+"` supplied to `"+l+"`, expected an object.");for(var c in i)if(xe(i,c)){var m=e(i,c,l,a,r+"."+c,ke);if(m instanceof Error)return m}return null})},oneOf:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&je(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),$e;function t(t,n,l,r,i){for(var s=t[n],c=0;c<e.length;c++)if(a(s,e[c]))return null;var u=JSON.stringify(e,function(e,t){return"symbol"===m(t)?String(t):t});return new o("Invalid "+r+" `"+i+"` of value `"+String(s)+"` supplied to `"+l+"`, expected one of "+u+".")}return r(t)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&je("Invalid argument supplied to oneOfType, expected an instance of array."),$e;for(var t=0;t<e.length;t++){var n=e[t];if("function"!=typeof n)return je("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+d(n)+" at index "+t+"."),$e}return r(function(t,n,l,a,r){for(var i=[],s=0;s<e.length;s++){var c=(0,e[s])(t,n,l,a,r,ke);if(null==c)return null;c.data&&xe(c.data,"expectedType")&&i.push(c.data.expectedType)}return new o("Invalid "+a+" `"+r+"` supplied to `"+l+"`"+(i.length>0?", expected one of type ["+i.join(", ")+"]":"")+".")})},shape:function(e){return r(function(t,n,l,a,r){var i=t[n],c=u(i);if("object"!==c)return new o("Invalid "+a+" `"+r+"` of type `"+c+"` supplied to `"+l+"`, expected `object`.");for(var d in e){var p=e[d];if("function"!=typeof p)return s(l,a,r,d,m(p));var E=p(i,d,l,a,r+"."+d,ke);if(E)return E}return null})},exact:function(e){return r(function(t,n,l,a,r){var i=t[n],c=u(i);if("object"!==c)return new o("Invalid "+a+" `"+r+"` of type `"+c+"` supplied to `"+l+"`, expected `object`.");var d=Re({},t[n],e);for(var p in d){var E=e[p];if(xe(e,p)&&"function"!=typeof E)return s(l,a,r,p,m(E));if(!E)return new o("Invalid "+a+" `"+r+"` key `"+p+"` supplied to `"+l+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var C=E(i,p,l,a,r+"."+p,ke);if(C)return C}return null})}};function a(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function o(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function r(e){function t(t,n,l,a,r,i,s){if(a=a||"<<anonymous>>",i=i||l,s!==ke){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}return null==n[l]?t?new o(null===n[l]?"The "+r+" `"+i+"` is marked as required in `"+a+"`, but its value is `null`.":"The "+r+" `"+i+"` is marked as required in `"+a+"`, but its value is `undefined`."):null:e(n,l,a,r,i)}process;var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function i(e){return r(function(t,n,l,a,r,i){var s=t[n];return u(s)!==e?new o("Invalid "+a+" `"+r+"` of type `"+m(s)+"` supplied to `"+l+"`, expected `"+e+"`.",{expectedType:e}):null})}function s(e,t,n,l,a){return new o((e||"React class")+": "+t+" type `"+n+"."+l+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+a+"`.")}function c(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(c);if(null===t||e(t))return!0;var l=function(e){var t=e&&(n&&e[n]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!l)return!1;var a,o=l.call(t);if(l!==t.entries){for(;!(a=o.next()).done;)if(!c(a.value))return!1}else for(;!(a=o.next()).done;){var r=a.value;if(r&&!c(r[1]))return!1}return!0;default:return!1}}function u(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function m(e){if(null==e)return""+e;var t=u(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function d(e){var t=m(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return o.prototype=Error.prototype,l.checkPropTypes=Ge,l.resetWarningCache=Ge.resetWarningCache,l.PropTypes=l,l}(Ae.isElement):function(){function e(e,t,n,l,a,o){if(o!==ke){var r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw r.name="Invariant Violation",r}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:We,resetWarningCache:Ve};return n.PropTypes=n,n}()});const Ye=e=>{let{data:t,onFilterChange:n,onSearch:l,isLoading:o,searchParams:s}=e;const{t:c}=r.useTranslation(),u=null==t?void 0:t.map(e=>{let{locality:t,tenantId:n,serviceRequestId:l,complaintSubType:o,sla:r,status:i,taskOwner:s}=e;return{[c("CS_COMMON_COMPLAINT_NO")]:l,[c("CS_ADDCOMPLAINT_COMPLAINT_SUB_TYPE")]:c("SERVICEDEFS."+o.toUpperCase()),[c("WF_INBOX_HEADER_LOCALITY")]:c(Digit.Utils.locale.getLocalityCode(t,n)),[c("CS_COMPLAINT_DETAILS_CURRENT_STATUS")]:c("CS_COMMON_"+i),[c("WF_INBOX_HEADER_CURRENT_OWNER")]:s,[c("WF_INBOX_HEADER_SLA_DAYS_REMAINING")]:(u=r,a.createElement("span",u<0?{className:"sla-cell-error"}:{className:"sla-cell-success"},u))};var u});let m;return m=o?a.createElement(i.Loader,null):a.createElement(le,{data:u,onFilterChange:n,serviceRequestIdKey:c("CS_COMMON_COMPLAINT_NO"),onSearch:l,searchParams:s}),a.createElement("div",{style:{padding:0}},a.createElement("div",{className:"inbox-container"},a.createElement("div",{className:"filters-container"},a.createElement(q,{isMobile:!0}),m)))};Ye.propTypes={data:ze.any,onFilterChange:ze.func,onSearch:ze.func,isLoading:ze.bool,searchParams:ze.any},Ye.defaultProps={onFilterChange:()=>{},searchParams:{}};const Ke=e=>{let{action:t}=e;const{t:n}=r.useTranslation();return n("REOPEN"===t?"CS_COMMON_COMPLAINT_REOPENED":"CS_COMMON_COMPLAINT_SUBMITTED")},qe=e=>{let{response:n}=e;const{complaints:l}=n;return a.createElement(i.Banner,l&&l.response&&l.response.responseInfo?{message:Ke(l.response.ServiceWrappers[0].workflow),complaintNumber:l.response.ServiceWrappers[0].service.serviceRequestId,successful:!0}:{message:t("CS_COMMON_COMPLAINT_NOT_SUBMITTED"),successful:!1})},Xe={PGRModule:e=>{let{stateCode:t,userType:n,tenants:l}=e;const o=Digit.StoreData.getCurrentLanguage(),{isLoading:r}=Digit.Services.useStore({stateCode:t,moduleCode:"PGR",language:o});return r?a.createElement(i.Loader,null):(Digit.SessionStorage.set("PGR_TENANTS",l),a.createElement("citizen"===n?B:j,null))},PGRLinks:e=>{let{matchPath:t}=e;const{t:n}=r.useTranslation(),[o,s,c]=Digit.Hooks.useSessionStorage("PGR_CITIZEN_CREATE_COMPLAINT",{});l.useEffect(()=>{c()},[]);const u=[{link:t+"/create-complaint/complaint-type",i18nKey:n("CS_COMMON_FILE_A_COMPLAINT")},{link:t+"/complaints",i18nKey:n("CS_HOME_MY_COMPLAINTS")}];return a.createElement(i.CitizenHomeCard,{header:n("CS_COMMON_HOME_COMPLAINTS"),links:u,Icon:i.ComplaintIcon})},PGRCard:()=>{var e,t,n,l;const{t:o}=r.useTranslation();if(o("ES_PGR_INBOX"),window,o("ES_PGR_NEW_COMPLAINT"),window,!Digit.Utils.pgrAccess())return null;const s=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24",viewBox:"0 0 24 24",width:"24"},a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),a.createElement("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 9h-2V5h2v6zm0 4h-2v-2h2v2z",fill:"white"}));let c=[{label:o("ES_PGR_NEW_COMPLAINT"),link:"/"+(null===(e=window)||void 0===e?void 0:e.contextPath)+"/employee/pgr/complaint/create",role:"CSR"}];c=c.filter(e=>e.role&&Digit.Utils.didEmployeeHasRole(e.role));const u={Icon:a.createElement(s,null),moduleName:o("ES_PGR_HEADER_COMPLAINT"),kpis:[{label:o("TOTAL_PGR"),link:"/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/employee/pgr/inbox"},{label:o("TOTAL_NEARING_SLA"),link:"/"+(null===(n=window)||void 0===n?void 0:n.contextPath)+"/employee/pgr/inbox"}],links:[{label:o("ES_PGR_INBOX"),link:"/"+(null===(l=window)||void 0===l?void 0:l.contextPath)+"/employee/pgr/inbox"},...c]};return a.createElement(i.EmployeeModuleCard,u)},PGRComplaintDetails:e=>{var t,n,s,c,u,m,p,E,C,S,_;let{id:f}=o.useParams();const{t:O}=r.useTranslation(),[v,T]=l.useState(!1),[g,N]=l.useState(null),[y,h]=l.useState(!1),M=Digit.ULBService.getCurrentTenantId(),{isLoading:I,complaintDetails:A,revalidate:P}=Digit.Hooks.pgr.useComplaintDetails({tenantId:M,id:f}),D=Digit.Hooks.useWorkflowDetails({tenantId:M,id:f,moduleCode:"PGR",role:"EMPLOYEE"}),[L,b]=l.useState([]);var R,x;D&&null!=D&&D.data&&(D.data.initialActionState=(null==D||null===(R=D.data)||void 0===R?void 0:R.initialActionState)||{...null==D||null===(x=D.data)||void 0===x?void 0:x.actionState}||{},D.data.actionState={...D.data}),l.useEffect(()=>{if(D){const{data:{timeline:e}={}}=D;if(e){const t=null==e?void 0:e.find(e=>"APPLY"===(null==e?void 0:e.performedAction)),{thumbnailsToShow:n}=t;n&&b(n)}}},[D]);const[w,F]=l.useState(!1),[H,U]=l.useState(!1),[B,G]=l.useState(null),[j,$]=l.useState(null),[K,q]=l.useState(!1),[X,J]=l.useState(1),Z=d.useQueryClient();l.useEffect(()=>{try{return Promise.resolve(null===(_Digit=Digit)||void 0===_Digit||null===(_Digit$WorkflowServic=_Digit.WorkflowService)||void 0===_Digit$WorkflowServic?void 0:_Digit$WorkflowServic.getByBusinessId(M,f)).then(function(){})}catch(e){Promise.reject(e)}},[A]);const Q=function(){try{return Promise.resolve(Z.refetchQueries(["fetchInboxData"])).then(function(){return Promise.resolve(D.revalidate()).then(function(){return Promise.resolve(P()).then(function(){})})})}catch(e){return Promise.reject(e)}};function ee(e){switch(e){case v:T(!v);break;case H:U(!H)}}function te(e,t){N(e)}if(l.useEffect(()=>{!function(){try{const e=function(){if(A)return q(!0),Promise.resolve(Q()).then(function(){q(!1)})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[]),I||D.isLoading||K)return a.createElement(i.Loader,null);if(D.isError)return a.createElement(a.Fragment,null,D.error);const ne=(e,t,n)=>{var o,r,s,c;const{wfComment:u,thumbnailsToShow:m}=e;function d(e,t,n){var l,a;let o=null===(l=n.thumbs)||void 0===l?void 0:l.findIndex(t=>t===e);te(o>-1&&(null==n||null===(a=n.fullImage)||void 0===a?void 0:a[o])||e)}const p={date:null==e||null===(o=e.auditDetails)||void 0===o?void 0:o.lastModified,name:null==e||null===(r=e.assigner)||void 0===r?void 0:r.name,mobileNumber:null==e||null===(s=e.assigner)||void 0===s?void 0:s.mobileNumber,..."COMPLAINT_FILED"===e.status&&null!=A&&A.audit?{source:A.audit.source}:{}};if("PENDINGFORASSIGNMENT"===e.status&&null!=A&&A.audit){if(n.length-(t+1)==1){const t={date:Digit.DateUtils.ConvertTimestampToDate(A.audit.details.createdTime)};return a.createElement(z,{data:t,comments:null==e?void 0:e.wfComment})}{var E,C;const t={date:Digit.DateUtils.ConvertTimestampToDate(A.audit.details.createdTime)};return a.createElement(l.Fragment,null,null!=e&&e.wfComment?a.createElement("div",null,null==e||null===(E=e.wfComment)||void 0===E?void 0:E.map(e=>a.createElement("div",{className:"TLComments"},a.createElement("h3",null,O("WF_COMMON_COMMENTS")),a.createElement("p",null,e)))):null,"COMPLAINT_FILED"!==e.status&&(null==m||null===(C=m.thumbs)||void 0===C?void 0:C.length)>0?a.createElement("div",{className:"TLComments"},a.createElement("h3",null,O("CS_COMMON_ATTACHMENTS")),a.createElement(i.DisplayPhotos,{srcs:m.thumbs,onClick:(e,t)=>d(e,0,m)})):null,null!=t&&t.date?a.createElement(z,{data:t}):null)}}return a.createElement(l.Fragment,null,u?a.createElement("div",null,null==u?void 0:u.map(e=>a.createElement("div",{className:"TLComments"},a.createElement("h3",null,O("WF_COMMON_COMMENTS")),a.createElement("p",null,e)))):null,"COMPLAINT_FILED"!==e.status&&(null==m||null===(c=m.thumbs)||void 0===c?void 0:c.length)>0?a.createElement("div",{className:"TLComments"},a.createElement("h3",null,O("CS_COMMON_ATTACHMENTS")),a.createElement(i.DisplayPhotos,{srcs:m.thumbs,onClick:(e,t)=>d(e,0,m)})):null,null!=p&&p.date?a.createElement(z,{data:p}):null,"CLOSEDAFTERRESOLUTION"==e.status&&"RATE"==A.workflow.action&&t<=1&&A.audit.rating?a.createElement(k,{text:O("CS_ADDCOMPLAINT_YOU_RATED"),rating:A.audit.rating}):null)};return a.createElement(a.Fragment,null,a.createElement(i.Card,null,a.createElement(i.CardSubHeader,null,O("CS_HEADER_COMPLAINT_SUMMARY")),a.createElement(i.CardLabel,{style:{fontWeight:"700"}},O("CS_COMPLAINT_DETAILS_COMPLAINT_DETAILS")),I?a.createElement(i.Loader,null):a.createElement(i.StatusTable,null,A&&Object.keys(null==A?void 0:A.details).map((e,t,n)=>a.createElement(i.Row,{key:e,label:O(e),text:Array.isArray(null==A?void 0:A.details[e])?null==A?void 0:A.details[e].map(e=>O("object"==typeof e?null==e?void 0:e.code:e)):O(null==A?void 0:A.details[e])||"N/A",last:n.length-1===t})),null),null!=L&&L.thumbs?a.createElement(i.DisplayPhotos,{srcs:null==L?void 0:L.thumbs,onClick:(e,t)=>function(e,t){te(null==L?void 0:L.fullImage[t])}(0,t)}):null,a.createElement(i.BreakLine,null),(null==D?void 0:D.isLoading)&&a.createElement(i.Loader,null),!(null!=D&&D.isLoading)&&a.createElement(a.Fragment,null,a.createElement(i.CardSubHeader,null,O("CS_COMPLAINT_DETAILS_COMPLAINT_TIMELINE")),null!=D&&null!==(t=D.data)&&void 0!==t&&t.timeline&&1===(null==D||null===(n=D.data)||void 0===n||null===(s=n.timeline)||void 0===s?void 0:s.length)?a.createElement(i.CheckPoint,{isCompleted:!0,label:O("CS_COMMON_"+(null==D||null===(c=D.data)||void 0===c||null===(u=c.timeline[0])||void 0===u?void 0:u.status))}):a.createElement(i.ConnectingCheckPoints,null,(null==D||null===(m=D.data)||void 0===m?void 0:m.timeline)&&(null==D||null===(p=D.data)||void 0===p?void 0:p.timeline.map((e,t,n)=>a.createElement(a.Fragment,{key:t},a.createElement(i.CheckPoint,{keyValue:t,isCompleted:0===t,label:O("CS_COMMON_"+e.status),customChild:ne(e,t,n)}))))))),v?a.createElement(i.PopUp,null,a.createElement("div",{className:"popup-module"},a.createElement(i.HeaderBar,{main:a.createElement(V,{label:"Complaint Geolocation"}),end:a.createElement(W,{onClick:()=>ee(v)})}),a.createElement("div",{className:"popup-module-main"},a.createElement("img",{src:"https://via.placeholder.com/912x568"})))):null,g?a.createElement(i.ImageViewer,{imageSrc:g,onClose:function(){N(null)}}):null,H?a.createElement(Y,{workflowDetails:D,complaintDetails:A,close:ee,popup:H,selectedAction:B,onAssign:function(e,t,n){try{return U(!1),Promise.resolve(Digit.Complaint.assign(A,B,e,t,n,M)).then(function(e){return $(e),h(!0),q(!0),Promise.resolve(Q()).then(function(){q(!1),J(X+1),setTimeout(()=>h(!1),1e4)})})}catch(e){return Promise.reject(e)}},tenantId:M,t:O}):null,y&&a.createElement(i.Toast,{label:O(j?"CS_ACTION_"+B+"_TEXT":"CS_ACTION_ASSIGN_FAILED"),onClose:function(){h(!1)}}),!(null!=D&&D.isLoading)&&(null==D||null===(E=D.data)||void 0===E||null===(C=E.nextActions)||void 0===C?void 0:C.length)>0&&a.createElement(i.ActionBar,null,w&&null!=D&&null!==(S=D.data)&&void 0!==S&&S.nextActions?a.createElement(i.Menu,{options:null==D||null===(_=D.data)||void 0===_?void 0:_.nextActions.map(e=>e.action),t:O,onSelect:function(e){switch(G(e),e){case"ASSIGN":case"REASSIGN":case"RESOLVE":case"REJECT":case"REOPEN":U(!0),F(!1);break;default:F(!1)}}}):null,a.createElement(i.SubmitBar,{label:O("WF_TAKE_ACTION"),onSubmit:()=>F(!w)})))},PGRCreateComplaintEmp:e=>{var t;let{parentUrl:n}=e;const s=Digit.Hooks.pgr.useTenants(),{t:u}=r.useTranslation(),m=()=>(null==s?void 0:s.filter(e=>e.code===Digit.ULBService.getCurrentTenantId()))||[],[p,E]=l.useState({}),[C,S]=l.useState([]),[_,O]=l.useState({}),[v,T]=l.useState(""),[g,N]=l.useState(m()[0]?m()[0]:null),{data:y}=Digit.Hooks.useBoundaryLocalities(null===(t=m()[0])||void 0===t?void 0:t.code,"admin",{enabled:!!m()[0]},u),[h,M]=l.useState(y),[I,A]=l.useState(null),[P,D]=l.useState(!1),[L,b]=l.useState(!1),[R,k]=l.useState(!1),[x,w]=l.useState({}),F=window.Digit.SessionStorage.get("Employee.tenantId"),H=Digit.Hooks.pgr.useComplaintTypes({stateCode:F}),U=c.useDispatch(),B=(o.useRouteMatch(),o.useHistory()),G=Digit.GetServiceDefinitions,j=d.useQueryClient();l.useEffect(()=>{D(!!(null!=p&&p.key&&null!=_&&_.key&&null!=g&&g.code&&null!=I&&I.code))},[p,_,g,I]),l.useEffect(()=>{M(y)},[y]),l.useEffect(()=>{var e;const t=s.find(e=>{var t;return null===(t=e.pincode)||void 0===t?void 0:t.find(e=>e==v)});if(null!=t&&t.code&&(null==t?void 0:t.code)===(null===(e=m()[0])||void 0===e?void 0:e.code)){k(!1),N(t),A(null);const e=y,n=null==e?void 0:e.filter(e=>e.pincode==v);M(n)}else""===v||null===v?(k(!1),M(y)):k(!0)},[v]);const $=[{head:u("ES_CREATECOMPLAINT_PROVIDE_COMPLAINANT_DETAILS"),body:[{label:u("ES_CREATECOMPLAINT_MOBILE_NUMBER"),isMandatory:!0,type:"text",populators:{name:"mobileNumber",validation:{required:!0,pattern:/^[6-9]\d{9}$/},componentInFront:a.createElement("div",{className:"employee-card-input employee-card-input--front"},"+91"),error:u("CORE_COMMON_MOBILE_ERROR")}},{label:u("ES_CREATECOMPLAINT_COMPLAINT_NAME"),isMandatory:!0,type:"text",populators:{name:"name",validation:{required:!0,pattern:/^[A-Za-z]/},error:u("CS_ADDCOMPLAINT_NAME_ERROR")}}]},{head:u("CS_COMPLAINT_DETAILS_COMPLAINT_DETAILS"),body:[{label:u("CS_COMPLAINT_DETAILS_COMPLAINT_TYPE"),isMandatory:!0,type:"dropdown",populators:a.createElement(i.Dropdown,{option:H,optionKey:"name",id:"complaintType",selected:p,select:function(e){try{const t=function(){if(e.key!==p.key){const t=function(){if("Others"!==e.key)return O({name:""}),E(e),Promise.resolve(G.getSubMenu(F,e,u)).then(function(e){S(e)});O({name:""}),E(e),S([{key:"Others",name:u("SERVICEDEFS.OTHERS")}])}();if(t&&t.then)return t.then(function(){})}}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}})},{label:u("CS_COMPLAINT_DETAILS_COMPLAINT_SUBTYPE"),isMandatory:!0,type:"dropdown",menu:{...C},populators:a.createElement(i.Dropdown,{option:C,optionKey:"name",id:"complaintSubType",selected:_,select:function(e){O(e)}})}]},{head:u("CS_ADDCOMPLAINT_LOCATION"),body:[{label:u("CORE_COMMON_PINCODE"),type:"text",populators:{name:"pincode",validation:{pattern:/^[1-9][0-9]{5}$/,validate:()=>!R},error:u("CORE_COMMON_PINCODE_INVALID"),onChange:e=>{const{value:t}=e.target;T(t),t||k(!1)}}},{label:u("CS_COMPLAINT_DETAILS_CITY"),isMandatory:!0,type:"dropdown",populators:a.createElement(i.Dropdown,{isMandatory:!0,selected:g,freeze:!0,option:m(),id:"city",select:function(e){return Promise.resolve()},optionKey:"i18nKey",t:u})},{label:u("CS_CREATECOMPLAINT_MOHALLA"),type:"dropdown",isMandatory:!0,dependency:!(!g||!h),populators:a.createElement(i.Dropdown,{isMandatory:!0,selected:I,optionKey:"i18nkey",id:"locality",option:h,select:function(e){A(e)},t:u})},{label:u("CS_COMPLAINT_DETAILS_LANDMARK"),type:"textarea",populators:{name:"landmark"}}]},{head:u("CS_COMPLAINT_DETAILS_ADDITIONAL_DETAILS"),body:[{label:u("CS_COMPLAINT_DETAILS_ADDITIONAL_DETAILS"),type:"textarea",populators:{name:"description"}}]}];return a.createElement(K,{heading:u("ES_CREATECOMPLAINT_NEW_COMPLAINT"),config:$,onSubmit:e=>{P&&(b(!0),!L&&function(e){try{if(!P)return Promise.resolve();const t=g.code,l=g.city.name,a=g.city.name,o=g.city.name,r=I.code,i=I.name,s=e.landmark,{key:c}=_,u=c,m=e.mobileNumber,d=e.name,p={...e,cityCode:t,city:l,district:a,region:o,localityCode:r,localityName:i,landmark:s,complaintType:u,mobileNumber:m,name:d};Promise.resolve(U(f(p))).then(function(){return Promise.resolve(j.refetchQueries(["fetchInboxData"])).then(function(){B.push(n+"/response")})})}catch(e){return Promise.reject(e)}}(e))},isDisabled:!P&&!L,label:u("CS_ADDCOMPLAINT_ADDITIONAL_DETAILS_SUBMIT_COMPLAINT")})},PGRInbox:()=>{const{t:e}=r.useTranslation(),t=Digit.ULBService.getCurrentTenantId(),{uuid:n}=Digit.UserService.getUser().info,[o,s]=l.useState(0),[c,u]=l.useState(10),[m,d]=l.useState(0),[p,E]=l.useState({filters:{wfFilters:{assignee:[{code:n}]}},search:"",sort:{}});l.useEffect(()=>{try{const e=null==p||null===(_searchParams$filters=p.filters)||void 0===_searchParams$filters||null===(_searchParams$filters2=_searchParams$filters.pgrfilters)||void 0===_searchParams$filters2||null===(_searchParams$filters3=_searchParams$filters2.applicationStatus)||void 0===_searchParams$filters3?void 0:_searchParams$filters3.map(e=>e.code).join(",");return Promise.resolve(Digit.PGRService.count(t,(null==e?void 0:e.length)>0?{applicationStatus:e}:{})).then(function(e){null!=e&&e.count&&d(e.count)})}catch(e){Promise.reject(e)}},[p]);const C=e=>{E({...p,filters:e})},S=function(e){void 0===e&&(e=""),E({...p,search:e})};let{data:_,isLoading:f}=Digit.Hooks.pgr.useInboxData({...p,offset:o,limit:c}),O=Digit.Utils.browser.isMobile();return null!==(null==_?void 0:_.length)?O?a.createElement(Ye,{data:_,isLoading:f,onFilterChange:C,onSearch:S,searchParams:p}):a.createElement("div",null,a.createElement(i.Header,null,e("ES_COMMON_INBOX")),a.createElement(ne,{data:_,isLoading:f,onFilterChange:C,onSearch:S,searchParams:p,onNextPage:()=>{s(e=>e+10)},onPrevPage:()=>{s(e=>e-10)},onPageSizeChange:e=>{u(Number(e.target.value))},currentPage:Math.floor(o/c),totalRecords:m,pageSizeLimit:c})):a.createElement(i.Loader,null)},PGRResponseEmp:e=>{var t;const{t:n}=r.useTranslation(),l=(o.useRouteMatch(),c.useSelector(e=>e).pgr);return a.createElement(i.Card,null,l.complaints.response&&a.createElement(qe,{response:l}),a.createElement(i.CardText,null,n("ES_COMMON_TRACK_COMPLAINT_TEXT")),a.createElement(o.Link,{to:"/"+(null===(t=window)||void 0===t?void 0:t.contextPath)+"/employee"},a.createElement(i.SubmitBar,{label:n("CORE_COMMON_GO_TO_HOME")})))},PGRCreateComplaintCitizen:()=>{const e=Digit.Contexts.ComponentProvider,{t:t}=r.useTranslation(),{pathname:n}=o.useLocation(),i=o.useRouteMatch(),s=o.useHistory(),m=(l.useContext(e),c.useDispatch()),{data:p,isLoading:E}=Digit.Hooks.useStore.getInitData(),{stateInfo:C}=p||{},[S,_,O]=Digit.Hooks.useSessionStorage("PGR_CITIZEN_CREATE_COMPLAINT",{}),v=l.useMemo(()=>u(D,Digit.Customizations.PGR.complaintConfig),[Digit.Customizations.PGR.complaintConfig]),[T,g]=l.useState(S),[N,y]=l.useState(""),[h,M]=l.useState(!1),[I,P]=l.useState(0),L=d.useQueryClient();l.useEffect(()=>{M(!1)},[]),l.useEffect(()=>{g(S),null===N?R():s.push(i.path+"/"+N)},[S,N]);const b=()=>{const e=n.split("/").pop();let{nextStep:l}=v.routes[e],a=Digit.SessionStorage.get("PGR_CITIZEN_CREATE_COMPLAINT");"sub-type"===l&&"Others"===a.complaintType.key&&(_({...S,complaintType:{key:"Others",name:t("SERVICEDEFS.OTHERS")},subType:{key:"Others",name:t("SERVICEDEFS.OTHERS")}}),l=v.routes[l].nextStep),y(l)},R=()=>{h||(M(!0),k())},k=function(){try{const e=function(){if(null!=T&&T.complaintType){const{city_complaint:e,locality_complaint:t,uploadedImages:n,subType:l,details:a,...o}=T,{code:r,name:c}=e,{code:u,name:d}=t,p=null==n?void 0:n.map(e=>({documentType:"PHOTO",fileStoreId:e,documentUid:"",additionalDetails:{}})),E={...o,complaintType:l.key,cityCode:r,city:c,description:a,district:c,region:c,localityCode:u,localityName:d,state:C.name,uploadedImages:p};return Promise.resolve(m(f(E))).then(function(){return Promise.resolve(L.refetchQueries(["complaintsList"])).then(function(){s.push(i.path+"/response")})})}}();return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return Promise.reject(e)}},x=e=>{_({...S,...e}),b()},w=()=>{b()};return E?null:a.createElement(o.Switch,null,Object.keys(v.routes).map((e,n)=>{const{component:l,texts:r,inputs:s}=v.routes[e],c="string"==typeof l?Digit.ComponentRegistryService.getComponent(l):l;return a.createElement(o.Route,{path:i.path+"/"+e,key:n},a.createElement(c,{config:{texts:r,inputs:s},onSelect:x,onSkip:w,value:S,t:t}))}),a.createElement(o.Route,{path:i.path+"/response"},a.createElement(A,{match:i})),a.createElement(o.Route,null,a.createElement(o.Redirect,{to:i.path+"/"+v.indexRoute})))},PGRComplaintsList:e=>{var t,n,s,c;const u=Digit.UserService.getUser(),m=u.mobileNumber||(null==u||null===(t=u.info)||void 0===t?void 0:t.mobileNumber)||(null==u||null===(n=u.info)||void 0===n||null===(s=n.userInfo)||void 0===s?void 0:s.mobileNumber),d=(null===(c=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===c?void 0:c.code)||Digit.ULBService.getCurrentTenantId(),{t:p}=r.useTranslation(),{path:E}=o.useRouteMatch();let{isLoading:C,error:S,data:_,revalidate:f}=Digit.Hooks.pgr.useComplaintsListByMobile(d,m);if(l.useEffect(()=>{f()},[]),C)return a.createElement(a.Fragment,null,a.createElement(i.Header,null,p("CS_HOME_MY_COMPLAINTS")),a.createElement(i.Loader,null));let O,v=null==_?void 0:_.ServiceWrappers;return O=S?a.createElement(i.Card,null,p("CS_COMMON_ERROR_LOADING_RESULTS").split("\\n").map((e,t)=>a.createElement("p",{key:t,style:{textAlign:"center"}},e))):0===v.length?a.createElement(i.Card,null,p("CS_MYCOMPLAINTS_NO_COMPLAINTS").split("\\n").map((e,t)=>a.createElement("p",{key:t,style:{textAlign:"center"}},e))):v.map((e,t)=>{let{service:n}=e;return a.createElement(L,{key:t,data:n,path:E})}),a.createElement(a.Fragment,null,a.createElement("div",{className:"applications-list-container"},a.createElement(i.Header,null,p("CS_HOME_MY_COMPLAINTS")),O))},PGRComplaintDetailsPage:e=>{var t;let{t:n}=r.useTranslation(),{id:s}=o.useParams(),c=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId();const{isLoading:u,isError:m,complaintDetails:d,revalidate:p}=Digit.Hooks.pgr.useComplaintDetails({tenantId:c,id:s}),[E,C]=l.useState({}),[S,_]=l.useState(null),[f,O]=l.useState(""),[v,T]=l.useState(!1),[g,N]=l.useState(null),[y,h]=l.useState(!0),[M,I]=l.useState(!1);function A(e,t){_(e)}return l.useEffect(()=>{!function(){try{const e=function(){if(d)return I(!0),Promise.resolve(p()).then(function(){I(!1)})}();e&&e.then&&e.then(function(){})}catch(e){Promise.reject(e)}}()},[]),u||M?a.createElement(i.Loader,null):m?a.createElement("h2",null,"Error"):a.createElement(a.Fragment,null,a.createElement("div",{className:"complaint-summary"},a.createElement(i.Header,null,n("CS_HEADER_COMPLAINT_SUMMARY")),Object.keys(d).length>0?a.createElement(a.Fragment,null,a.createElement(i.Card,null,a.createElement(i.CardSubHeader,null,n("SERVICEDEFS."+d.audit.serviceCode.toUpperCase())),a.createElement(i.StatusTable,null,Object.keys(d.details).map((e,t,l)=>a.createElement(i.Row,{key:t,label:n(e),text:Array.isArray(d.details[e])?d.details[e].map(e=>n("object"==typeof e?null==e?void 0:e.code:e)):n(d.details[e])||"N/A",last:t===l.length-1}))),null!=E&&E.thumbs?a.createElement(i.DisplayPhotos,{srcs:null==E?void 0:E.thumbs,onClick:(e,t)=>function(e,t){A(null==E?void 0:E.fullImage[t])}(0,t)}):null,S?a.createElement(i.ImageViewer,{imageSrc:S,onClose:function(){_(null)}}):null),a.createElement(i.Card,null,(null==d?void 0:d.service)&&a.createElement(U,{getWorkFlow:e=>{var t;let n=null==e?void 0:e.timeline;if(n&&null!==(t=n[0].timeLineActions)&&void 0!==t&&t.filter(e=>"COMMENT"===e).length?h(!1):h(!0),n){const e=n.find(e=>"APPLY"===(null==e?void 0:e.performedAction)),{thumbnailsToShow:t}=e;C(t)}},complaintDetails:d,id:s,zoomImage:A})),v&&a.createElement(i.Toast,{error:g,label:n(g?"CS_COMPLAINT_COMMENT_ERROR":"CS_COMPLAINT_COMMENT_SUCCESS"),onClose:()=>T(!1)})," "):a.createElement(i.Loader,null)))},PGRSelectRating:e=>{var t;let{parentRoute:n}=e;const{t:s}=r.useTranslation(),{id:u}=o.useParams(),m=c.useDispatch(),d=o.useHistory();let p=(null===(t=Digit.SessionStorage.get("CITIZEN.COMMON.HOME.CITY"))||void 0===t?void 0:t.code)||Digit.ULBService.getCurrentTenantId();const E=Digit.Hooks.pgr.useComplaintDetails({tenantId:p,id:u}).complaintDetails,C=l.useCallback(e=>m(O(e)),[m]),[S,_]=l.useState(!1),f={texts:{header:"CS_COMPLAINT_RATE_HELP_TEXT",submitBarLabel:"CS_COMMONS_NEXT"},inputs:[{type:"rate",maxRating:5,label:s("CS_COMPLAINT_RATE_TEXT"),error:S?a.createElement(i.CardLabelError,null,s("CS_FEEDBACK_ENTER_RATING_ERROR")):null},{type:"checkbox",label:"CS_FEEDBACK_WHAT_WAS_GOOD",checkLabels:[s("CS_FEEDBACK_SERVICES"),s("CS_FEEDBACK_RESOLUTION_TIME"),s("CS_FEEDBACK_QUALITY_OF_WORK"),s("CS_FEEDBACK_OTHERS")]},{type:"textarea",label:s("CS_COMMON_COMMENTS"),name:"comments"}]};return a.createElement(i.RatingCard,{config:f,t:s,onSelect:function(e){E&&e.rating>0?(E.service.rating=e.rating,E.service.additionalDetail=e.CS_FEEDBACK_WHAT_WAS_GOOD.join(","),E.workflow={action:"RATE",comments:e.comments,verificationDocuments:[]},C({service:E.service,workflow:E.workflow}),d.push(n+"/response")):_(!0)}})},PGRResponseCitzen:y};exports.PGRReducers=()=>s.combineReducers({complaints:p}),exports.initPGRComponents=()=>{Object.entries(Xe).forEach(e=>{let[t,n]=e;Digit.ComponentRegistryService.setComponent(t,n)})};
